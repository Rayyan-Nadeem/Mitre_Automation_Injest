ID,name,description,url,created,last modified,version,tactics,detection,platforms,data sources,is sub-technique,sub-technique of,defenses bypassed,contributors,permissions required,supports remote,system requirements,impact type,effective permissions,relationship citations,entities,mitigations
T1001,Data Obfuscation,"Adversaries may obfuscate command and control traffic to make it more difficult to detect. Command and control (C2) communications are hidden (but not necessarily encrypted) in an attempt to make the content more difficult to discover or decipher and to make the communication less conspicuous and hide commands from being seen. This encompasses many methods, such as adding junk data to protocol traffic, using steganography, or impersonating legitimate protocols. ",https://attack.mitre.org/techniques/T1001,31 May 2017,15 March 2020,1.1,['Command and Control'],"Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2)","['Linux', 'Windows', 'macOS']",Network Traffic: Network Traffic Content,False,,[],,,,,,,"(Citation: Proofpoint TA505 Mar 2018),(Citation: CrowdStrike StellarParticle January 2022),(Citation: FoxIT Wocao December 2019),(Citation: Unit42 RDAT July 2020),(Citation: CISA MAR SLOTHFULMEDIA October 2020),(Citation: Bitdefender FunnyDream Campaign November 2020),(Citation: Check Point APT34 April 2021),","['actor', 'process', 'data flow']","[{'mitigation id': None, 'mitigation name': None, 'mitigation description': None, 'mitigation url': None}]"
T1001.001,Data Obfuscation: Junk Data,"Adversaries may add junk data to protocols used for command and control to make detection more difficult. By adding random or meaningless data to the protocols used for command and control, adversaries can prevent trivial methods for decoding, deciphering, or otherwise analyzing the traffic. Examples may include appending/prepending data with junk characters or writing junk characters between significant characters. ",https://attack.mitre.org/techniques/T1001/001,15 March 2020,15 March 2020,1.0,['Command and Control'],"Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)","['Linux', 'Windows', 'macOS']",Network Traffic: Network Traffic Content,True,T1001,,,,,,,,"(Citation: CISA WellMess July 2020),(Citation: Unit42 BendyBear Feb 2021),(Citation: FireEye APT28),(Citation: CrowdStrike StellarParticle January 2022),(Citation: ESET Sednit Part 3),(Citation: Kaspersky Lyceum October 2021),(Citation: Group IB GrimAgent July 2021),(Citation: Securelist APT10 March 2021),(Citation: FireEye SUNBURST Backdoor December 2020),(Citation: MSTIC NOBELIUM Mar 2021),(Citation: TrendMicro BlackTech June 2017),(Citation: DHS CISA AA22-055A MuddyWater February 2022),(Citation: Dell P2P ZeuS),(Citation: ESET BackdoorDiplomacy Jun 2021),(Citation: ESET PLEAD Malware July 2018),","['actor', 'process', 'data flow']","[{'mitigation id': None, 'mitigation name': None, 'mitigation description': None, 'mitigation url': None}]"
T1001.002,Data Obfuscation: Steganography,"Adversaries may use steganographic techniques to hide command and control traffic to make detection efforts more difficult. Steganographic techniques can be used to hide data in digital messages that are transferred between systems. This hidden information can be used for command and control of compromised systems. In some cases, the passing of files embedded using steganography, such as image or document files, can be used for command and control. ",https://attack.mitre.org/techniques/T1001/002,15 March 2020,15 March 2020,1.0,['Command and Control'],"Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)","['Linux', 'Windows', 'macOS']",Network Traffic: Network Traffic Content,True,T1001,,,,,,,,"(Citation: GitHub Sliver HTTP),(Citation: FireEye APT29),(Citation: Trend Micro Daserf Nov 2017),(Citation: Symantec W32.Duqu),(Citation: Unit42 RDAT July 2020),(Citation: FireEye SUNBURST Backdoor December 2020),(Citation: Symantec Sunburst Sending Data January 2021),(Citation: FireEye SUNBURST Additional Details Dec 2020),(Citation: Proofpoint ZeroT Feb 2017),(Citation: ESET LightNeuron May 2019),(Citation: ESET Dukes October 2019),(Citation: Proofpoint TA459 April 2017),(Citation: Novetta-Axiom),","['actor', 'process', 'data flow']","[{'mitigation id': None, 'mitigation name': None, 'mitigation description': None, 'mitigation url': None}]"
T1001.003,Data Obfuscation: Protocol Impersonation,"Adversaries may impersonate legitimate protocols or web service traffic to disguise command and control activity and thwart analysis efforts. By impersonating legitimate protocols or web services, adversaries can make their command and control traffic blend in with legitimate network traffic.  

Adversaries may impersonate a fake SSL/TLS handshake to make it look like subsequent traffic is SSL/TLS encrypted, potentially interfering with some security tooling, or to make the traffic look like it is related with a trusted entity. ",https://attack.mitre.org/techniques/T1001/003,15 March 2020,15 March 2020,1.0,['Command and Control'],"Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)","['Linux', 'Windows', 'macOS']",Network Traffic: Network Traffic Content,True,T1001,,,,,,,,"(Citation: Mandiant APT41),(Citation: US-CERT Bankshot Dec 2017),(Citation: US-CERT HARDRAIN March 2018),(Citation: McAfee Lazarus Resurfaces Feb 2018),(Citation: ESET InvisiMole June 2018),(Citation: McAfee GhostSecret),(Citation: US-CERT BADCALL),(Citation: PWC KeyBoys Feb 2017),(Citation: FireEye SUNBURST Backdoor December 2020),(Citation: Cobalt Strike Manual 4.3 November 2020),(Citation: Scarlet Mimic Jan 2016),(Citation: Zscaler Higaisa 2020),(Citation: Novetta Blockbuster Destructive Malware),(Citation: US-CERT FALLCHILL Nov 2017),(Citation: ESET InvisiMole June 2020),(Citation: ESET Okrum July 2019),(Citation: Novetta Blockbuster),(Citation: CISA MAR-10288834-2.v1  TAINTEDSCRIBE MAY 2020),","['actor', 'process', 'data flow']","[{'mitigation id': None, 'mitigation name': None, 'mitigation description': None, 'mitigation url': None}]"
T1003,OS Credential Dumping,"Adversaries may attempt to dump credentials to obtain account login and credential material, normally in the form of a hash or a clear text password, from the operating system and software. Credentials can then be used to perform [Lateral Movement](https://attack.mitre.org/tactics/TA0008) and access restricted information.

Several of the tools mentioned in associated sub-techniques may be used by both adversaries and professional security testers. Additional custom tools likely exist as well.
",https://attack.mitre.org/techniques/T1003,31 May 2017,08 March 2022,2.1,['Credential Access'],"### Windows
Monitor for unexpected processes interacting with lsass.exe.(Citation: Medium Detecting Attempts to Steal Passwords from Memory) Common credential dumpers such as [Mimikatz](https://attack.mitre.org/software/S0002) access the LSA Subsystem Service (LSASS) process by opening the process, locating the LSA secrets key, and decrypting the sections in memory where credential details are stored. Credential dumpers may also use methods for reflective [Process Injection](https://attack.mitre.org/techniques/T1055) to reduce potential indicators of malicious activity.

Hash dumpers open the Security Accounts Manager (SAM) on the local file system (%SystemRoot%/system32/config/SAM) or create a dump of the Registry SAM key to access stored account password hashes. Some hash dumpers will open the local file system as a device and parse to the SAM table to avoid file access defenses. Others will make an in-memory copy of the SAM table before reading hashes. Detection of compromised [Valid Accounts](https://attack.mitre.org/techniques/T1078) in-use by adversaries may help as well. 

On Windows 8.1 and Windows Server 2012 R2, monitor Windows Logs for LSASS.exe creation to verify that LSASS started as a protected process.

Monitor processes and command-line arguments for program execution that may be indicative of credential dumping. Remote access tools may contain built-in features or incorporate existing tools like [Mimikatz](https://attack.mitre.org/software/S0002). [PowerShell](https://attack.mitre.org/techniques/T1059/001) scripts also exist that contain credential dumping functionality, such as PowerSploit's Invoke-Mimikatz module, (Citation: Powersploit) which may require additional logging features to be configured in the operating system to collect necessary information for analysis.

Monitor domain controller logs for replication requests and other unscheduled activity possibly associated with DCSync. (Citation: Microsoft DRSR Dec 2017) (Citation: Microsoft GetNCCChanges) (Citation: Samba DRSUAPI) Note: Domain controllers may not log replication requests originating from the default domain controller account. (Citation: Harmj0y DCSync Sept 2015). Also monitor for network protocols  (Citation: Microsoft DRSR Dec 2017) (Citation: Microsoft NRPC Dec 2017) and other replication requests (Citation: Microsoft SAMR) from IPs not associated with known domain controllers. (Citation: AdSecurity DCSync Sept 2015)

### Linux
To obtain the passwords and hashes stored in memory, processes must open a maps file in the /proc filesystem for the process being analyzed. This file is stored under the path <code>/proc/<pid>/maps</code>, where the <code><pid></code> directory is the unique pid of the program being interrogated for such authentication data. The AuditD monitoring tool, which ships stock in many Linux distributions, can be used to watch for hostile processes opening this file in the proc file system, alerting on the pid, process name, and arguments of such programs.","['Linux', 'Windows', 'macOS']","Active Directory: Active Directory Object Access, Command: Command Execution, File: File Access, Network Traffic: Network Traffic Content, Network Traffic: Network Traffic Flow, Process: OS API Execution, Process: Process Access, Process: Process Creation, Windows Registry: Windows Registry Key Access",False,,[],"Ed Williams, Trustwave, SpiderLabs; Vincent Le Toux","['Administrator', 'root', 'SYSTEM']",,,,,"(Citation: ESET Sednit Part 2),(Citation: TrendMicro Tonto Team October 2020),(Citation: BitDefender Chafer May 2020),(Citation: DOJ GRU Indictment Jul 2018),(Citation: Symantec Dragonfly),(Citation: FireEye APT40 March 2019),(Citation: Symantec Suckfly May 2016),(Citation: Cylance Shaheen Nov 2018),(Citation: Cybereason Cobalt Kitty 2017),(Citation: Cybereason Oceanlotus May 2017),(Citation: Kaspersky Poseidon Group),(Citation: Symantec Sowbug Nov 2017),(Citation: FireEye CARBANAK June 2017),(Citation: US District Court Indictment GRU Oct 2018),(Citation: FireEye Periscope March 2018),(Citation: Novetta-Axiom),(Citation: F-Secure The Dukes),(Citation: TechNet Credential Guard),(Citation: Microsoft Disable NTLM Nov 2012),(Citation: Microsoft Protected Users Security Group),(Citation: AdSecurity DCSync Sept 2015),(Citation: Microsoft Securing Privileged Access),(Citation: Microsoft Replication ACL),(Citation: Microsoft LSA),(Citation: GitHub SHB Credential Guard),(Citation: Microsoft WDigest Mit),(Citation: win10_asr)","['actor', 'process', 'data store', 'data flow']","[{'mitigation id': None, 'mitigation name': None, 'mitigation description': None, 'mitigation url': None}, {'mitigation id': None, 'mitigation name': None, 'mitigation description': None, 'mitigation url': None}, {'mitigation id': None, 'mitigation name': None, 'mitigation description': None, 'mitigation url': None}, {'mitigation id': None, 'mitigation name': None, 'mitigation description': None, 'mitigation url': None}, {'mitigation id': None, 'mitigation name': None, 'mitigation description': None, 'mitigation url': None}, {'mitigation id': None, 'mitigation name': None, 'mitigation description': None, 'mitigation url': None}, {'mitigation id': None, 'mitigation name': None, 'mitigation description': None, 'mitigation url': None}, {'mitigation id': None, 'mitigation name': None, 'mitigation description': None, 'mitigation url': None}, {'mitigation id': None, 'mitigation name': None, 'mitigation description': None, 'mitigation url': None}]"
T1003.007,OS Credential Dumping: Proc Filesystem,"Adversaries may gather credentials from the proc filesystem or `/proc`. The proc filesystem is a pseudo-filesystem used as an interface to kernel data structures for Linux based systems managing virtual memory. For each process, the `/proc/<PID>/maps` file shows how memory is mapped within the process’s virtual address space. And `/proc/<PID>/mem`, exposed for debugging purposes, provides access to the process’s virtual address space.(Citation: Picus Labs Proc cump 2022)(Citation: baeldung Linux proc map 2022)

When executing with root privileges, adversaries can search these memory locations for all processes on a system that contain patterns that are indicative of credentials, such as looking for fixed strings in memory structures or cached hashes. When running without privileged access, processes can still view their own virtual memory locations. Some services or programs may save credentials in clear text inside the process’s memory.(Citation: MimiPenguin GitHub May 2017)(Citation: Polop Linux PrivEsc Gitbook)

If running as or with the permissions of a web browser, a process can search the `/maps` & `/mem` locations for common website credential patterns (that can also be used to find adjacent memory within the same structure) in which hashes or cleartext credentials may be located.",https://attack.mitre.org/techniques/T1003/007,11 February 2020,15 April 2023,1.1,['Credential Access'],"To obtain the passwords and hashes stored in memory, processes must open a maps file in the /proc filesystem for the process being analyzed. This file is stored under the path <code>/proc/\*/maps</code>, where the <code>\*</code> directory is the unique pid of the program being interrogated for such authentication data. The AuditD monitoring tool, which ships stock in many Linux distributions, can be used to watch for hostile processes opening this file in the proc file system, alerting on the pid, process name, and arguments of such programs.",['Linux'],"Command: Command Execution, File: File Access",True,T1003,,Tim (Wadhwa-)Brown,,,,,,"(Citation: Picus Labs Proc cump 2022),(Citation: GitHub LaZagne Dec 2018),(Citation: MimiPenguin GitHub May 2017),","['actor', 'process', 'data store', 'data flow']","[{'mitigation id': None, 'mitigation name': None, 'mitigation description': None, 'mitigation url': None}, {'mitigation id': None, 'mitigation name': None, 'mitigation description': None, 'mitigation url': None}]"
T1003.008,OS Credential Dumping: /etc/passwd and /etc/shadow,"Adversaries may attempt to dump the contents of <code>/etc/passwd</code> and <code>/etc/shadow</code> to enable offline password cracking. Most modern Linux operating systems use a combination of <code>/etc/passwd</code> and <code>/etc/shadow</code> to store user account information including password hashes in <code>/etc/shadow</code>. By default, <code>/etc/shadow</code> is only readable by the root user.(Citation: Linux Password and Shadow File Formats)

The Linux utility, unshadow, can be used to combine the two files in a format suited for password cracking utilities such as John the Ripper:(Citation: nixCraft - John the Ripper) <code># /usr/bin/unshadow /etc/passwd /etc/shadow > /tmp/crack.password.db</code>
",https://attack.mitre.org/techniques/T1003/008,11 February 2020,20 March 2020,1.0,['Credential Access'],"The AuditD monitoring tool, which ships stock in many Linux distributions, can be used to watch for hostile processes attempting to access <code>/etc/passwd</code> and <code>/etc/shadow</code>, alerting on the pid, process name, and arguments of such programs.",['Linux'],"Command: Command Execution, File: File Access",True,T1003,,,['root'],,,,,"(Citation: GitHub LaZagne Dec 2018),","['actor', 'process', 'data store', 'data flow']","[{'mitigation id': None, 'mitigation name': None, 'mitigation description': None, 'mitigation url': None}, {'mitigation id': None, 'mitigation name': None, 'mitigation description': None, 'mitigation url': None}]"
T1008,Fallback Channels,Adversaries may use fallback or alternate communication channels if the primary channel is compromised or inaccessible in order to maintain reliable command and control and to avoid data transfer thresholds.,https://attack.mitre.org/techniques/T1008,31 May 2017,14 July 2020,1.0,['Command and Control'],"Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2)","['Linux', 'Windows', 'macOS']","Network Traffic: Network Connection Creation, Network Traffic: Network Traffic Flow",False,,[],,,,,,,"(Citation: Bitdefender Naikon April 2021),(Citation: ESET Crutch December 2020),(Citation: Crowdstrike GTR2020 Mar 2020),(Citation: Unit 42 Kazuar May 2017),(Citation: Malwarebytes Kimsuky June 2021),(Citation: Symantec Linfo May 2012),(Citation: Unit 42 QUADAGENT July 2018),(Citation: NCC Group Team9 June 2020),(Citation: ESET InvisiMole June 2020),(Citation: Cyberreason Anchor December 2019),(Citation: Check Point APT35 CharmPower January 2022),(Citation: FireEye APT30),(Citation: ESET PipeMon May 2020),(Citation: ESET Dukes October 2019),(Citation: Unit 42 Valak July 2020),(Citation: US-CERT HOPLIGHT Apr 2019),(Citation: Check Point APT34 April 2021),(Citation: ESET Sednit Part 2),(Citation: ANSSI Sandworm January 2021),(Citation: ESET Gelsemium June 2021),(Citation: Proofpoint Bumblebee April 2022),(Citation: Fidelis Turbo),(Citation: Symantec Orangeworm April 2018),(Citation: Novetta Blockbuster),(Citation: ESET InvisiMole June 2018),(Citation: ESET Machete July 2019),(Citation: Kaspersky Lyceum October 2021),(Citation: Unit42 RDAT July 2020),(Citation: Mandiant APT1 Appendix),(Citation: ESET Ebury Oct 2017),(Citation: Mandiant APT1),(Citation: PaloAlto CardinalRat Apr 2017),(Citation: ESET Sednit Part 1),(Citation: Cylance Dust Storm),(Citation: Novetta Blockbuster RATs),(Citation: McAfee Night Dragon),(Citation: Securelist MiniDuke Feb 2013),(Citation: FireEye APT41 Aug 2019),(Citation: CISA MAR-10288834-2.v1  TAINTEDSCRIBE MAY 2020),(Citation: ClearSky Siamesekitten August 2021),(Citation: Mythc Documentation),(Citation: Baumgartner Naikon 2015),(Citation: Nicolas Falliere, Liam O Murchu, Eric Chien February 2011),(Citation: Talos TinyTurla September 2021),(Citation: DustySky),(Citation: FOX-IT May 2016 Mofang),(Citation: Securelist BlackEnergy Nov 2014),(Citation: OilRig ISMAgent July 2017),(Citation: University of Birmingham C2)","['actor', 'process', 'data flow']","[{'mitigation id': 'M1031', 'mitigation name': 'Network Intrusion Prevention', 'mitigation description': 'Use intrusion detection signatures to block traffic at network boundaries.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1031'}]"
T1011,Exfiltration Over Other Network Medium,"Adversaries may attempt to exfiltrate data over a different network medium than the command and control channel. If the command and control network is a wired Internet connection, the exfiltration may occur, for example, over a WiFi connection, modem, cellular data connection, Bluetooth, or another radio frequency (RF) channel.

Adversaries may choose to do this if they have sufficient access or proximity, and the connection might not be secured or defended as well as the primary Internet-connected channel because it is not routed through the same enterprise network.",https://attack.mitre.org/techniques/T1011,31 May 2017,08 March 2022,1.1,['Exfiltration'],"Monitor for processes utilizing the network that do not normally have network communication or have never been seen before. Processes that normally require user-driven events to access the network (for example, a web browser opening with a mouse click or key press) but access the network without such may be malicious.

Monitor for and investigate changes to host adapter settings, such as addition and/or replication of communication interfaces.","['Linux', 'Windows', 'macOS']","Command: Command Execution, File: File Access, Network Traffic: Network Connection Creation, Network Traffic: Network Traffic Content, Network Traffic: Network Traffic Flow",False,,[],"Itzik Kotler, SafeBreach",,,,,,",(Citation: TechRepublic Wireless GPO FEB 2009),(Citation: Microsoft GPO Bluetooth FEB 2009)","['process', 'data store', 'data flow']","[{'mitigation id': 'M1028', 'mitigation name': 'Operating System Configuration', 'mitigation description': 'Make configuration changes related to the operating system or a common feature of the operating system that result in system hardening against techniques.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1028'}]"
T1011.001,Exfiltration Over Other Network Medium: Exfiltration Over Bluetooth,"Adversaries may attempt to exfiltrate data over Bluetooth rather than the command and control channel. If the command and control network is a wired Internet connection, an adversary may opt to exfiltrate data using a Bluetooth communication channel.

Adversaries may choose to do this if they have sufficient access and proximity. Bluetooth connections might not be secured or defended as well as the primary Internet-connected channel because it is not routed through the same enterprise network.",https://attack.mitre.org/techniques/T1011/001,09 March 2020,08 March 2022,1.1,['Exfiltration'],"Monitor for processes utilizing the network that do not normally have network communication or have never been seen before. Processes that normally require user-driven events to access the network (for example, a web browser opening with a mouse click or key press) but access the network without such may be malicious.

Monitor for and investigate changes to host adapter settings, such as addition and/or replication of communication interfaces.","['Linux', 'Windows', 'macOS']","Command: Command Execution, File: File Access, Network Traffic: Network Connection Creation, Network Traffic: Network Traffic Content, Network Traffic: Network Traffic Flow",True,T1011,,,,,,,,"(Citation: Symantec Beetlejuice),","['process', 'data store', 'data flow']","[{'mitigation id': 'M1028', 'mitigation name': 'Operating System Configuration', 'mitigation description': 'Make configuration changes related to the operating system or a common feature of the operating system that result in system hardening against techniques.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1028'}, {'mitigation id': 'M1042', 'mitigation name': 'Disable or Remove Feature or Program', 'mitigation description': 'Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1042'}]"
T1020,Automated Exfiltration,"Adversaries may exfiltrate data, such as sensitive documents, through the use of automated processing after being gathered during Collection. 

When automated exfiltration is used, other exfiltration techniques likely apply as well to transfer the information out of the network, such as [Exfiltration Over C2 Channel](https://attack.mitre.org/techniques/T1041) and [Exfiltration Over Alternative Protocol](https://attack.mitre.org/techniques/T1048).",https://attack.mitre.org/techniques/T1020,31 May 2017,19 April 2022,1.2,['Exfiltration'],Monitor process file access patterns and network behavior. Unrecognized processes or scripts that appear to be traversing file systems and sending network traffic may be suspicious.,"['Linux', 'Network', 'Windows', 'macOS']","Command: Command Execution, File: File Access, Network Traffic: Network Connection Creation, Network Traffic: Network Traffic Content, Network Traffic: Network Traffic Flow, Script: Script Execution",False,,[],ExtraHop,,,,,,"(Citation: ESET Crutch December 2020),(Citation: ESET Windigo Mar 2014),(Citation: Bitdefender StrongPity June 2020),(Citation: Talos Promethium June 2020),(Citation: Palo Alto Rover),(Citation: Forcepoint Monsoon),(Citation: Proofpoint Operation Transparent Tribe March 2016),(Citation: Microsoft NICKEL December 2021),(Citation: ESET Sednit USBStealer 2014),(Citation: TrendMicro Tropic Trooper May 2020),(Citation: F-Secure Cosmicduke),(Citation: ESET LightNeuron May 2019),(Citation: ESET Machete July 2019),(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ),(Citation: ESET Attor Oct 2019),(Citation: Kaspersky TajMahal April 2019),(Citation: ESET Gamaredon June 2020),(Citation: Intezer Doki July 20),(Citation: ATT Sidewinder January 2021),(Citation: FOX-IT May 2016 Mofang),(Citation: Talos Frankenstein June 2019),","['process', 'data store', 'data flow']",
T1029,Scheduled Transfer,"Adversaries may schedule data exfiltration to be performed only at certain times of day or at certain intervals. This could be done to blend traffic patterns with normal activity or availability.

When scheduled exfiltration is used, other exfiltration techniques likely apply as well to transfer the information out of the network, such as [Exfiltration Over C2 Channel](https://attack.mitre.org/techniques/T1041) or [Exfiltration Over Alternative Protocol](https://attack.mitre.org/techniques/T1048).",https://attack.mitre.org/techniques/T1029,31 May 2017,28 March 2020,1.1,['Exfiltration'],Monitor process file access patterns and network behavior. Unrecognized processes or scripts that appear to be traversing file systems and sending network traffic may be suspicious. Network connections to the same destination that occur at the same time of day for multiple days are suspicious.,"['Linux', 'Windows', 'macOS']","Network Traffic: Network Connection Creation, Network Traffic: Network Traffic Flow",False,,[],,,,,,,"(Citation: ESET Sednit Part 2),(Citation: Talos TinyTurla September 2021),(Citation: NTT Security Flagpro new December 2021),(Citation: ESET Machete July 2019),(Citation: ESET Gelsemium June 2021),(Citation: Unit 42 Kazuar May 2017),(Citation: Symantec Linfo May 2012),(Citation: Kaspersky Adwind Feb 2016),(Citation: FireEye MuddyWater Mar 2018),(Citation: FOX-IT May 2016 Mofang),(Citation: ESET LightNeuron May 2019),(Citation: Securelist ShadowPad Aug 2017),(Citation: PTSecurity Higaisa 2020),(Citation: Microsoft PLATINUM April 2016),(Citation: ESET ComRAT May 2020),(Citation: cobaltstrike manual),(Citation: ClearSky Siamesekitten August 2021),(Citation: University of Birmingham C2)","['process', 'data store', 'data flow']","[{'mitigation id': 'M1031', 'mitigation name': 'Network Intrusion Prevention', 'mitigation description': 'Use intrusion detection signatures to block traffic at network boundaries.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1031'}]"
T1030,Data Transfer Size Limits,An adversary may exfiltrate data in fixed size chunks instead of whole files or limit packet sizes below certain thresholds. This approach may be used to avoid triggering network data transfer threshold alerts.,https://attack.mitre.org/techniques/T1030,31 May 2017,14 July 2020,1.0,['Exfiltration'],"Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). If a process maintains a long connection during which it consistently sends fixed size data packets or a process opens connections and sends fixed sized data packets at regular intervals, it may be performing an aggregate data transfer. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2)","['Linux', 'Windows', 'macOS']","Network Traffic: Network Connection Creation, Network Traffic: Network Traffic Flow",False,,[],,,,,,,"(Citation: Mythc Documentation),(Citation: Talos Oblique RAT March 2021),(Citation: Dell TG-3390),(Citation: DFIR Conti Bazar Nov 2021),(Citation: KISA Operation Muzabi),(Citation: Unit 42 OopsIE! Feb 2018),(Citation: Kaspersky Lyceum October 2021),(Citation: Unit42 RDAT July 2020),(Citation: Palo Alto OilRig May 2016),(Citation: Cybersecurity Advisory GRU Brute Force Campaign July 2021),(Citation: ESET ForSSHe December 2018),(Citation: Rclone),(Citation: FireEye CARBANAK June 2017),(Citation: FireEye POSHSPY April 2017),(Citation: Bitdefender LuminousMoth July 2021),(Citation: cobaltstrike manual),","['process', 'data store', 'data flow']","[{'mitigation id': 'M1031', 'mitigation name': 'Network Intrusion Prevention', 'mitigation description': 'Use intrusion detection signatures to block traffic at network boundaries.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1031'}]"
T1040,Network Sniffing,"Adversaries may sniff network traffic to capture information about an environment, including authentication material passed over the network. Network sniffing refers to using the network interface on a system to monitor or capture information sent over a wired or wireless connection. An adversary may place a network interface into promiscuous mode to passively access data in transit over the network, or use span ports to capture a larger amount of data.

Data captured via this technique may include user credentials, especially those sent over an insecure, unencrypted protocol. Techniques for name service resolution poisoning, such as [LLMNR/NBT-NS Poisoning and SMB Relay](https://attack.mitre.org/techniques/T1557/001), can also be used to capture credentials to websites, proxies, and internal systems by redirecting traffic to an adversary.

Network sniffing may also reveal configuration details, such as running services, version numbers, and other network characteristics (e.g. IP addresses, hostnames, VLAN IDs) necessary for subsequent Lateral Movement and/or Defense Evasion activities.

In cloud-based environments, adversaries may still be able to use traffic mirroring services to sniff network traffic from virtual machines. For example, AWS Traffic Mirroring, GCP Packet Mirroring, and Azure vTap allow users to define specified instances to collect traffic from and specified targets to send collected traffic to.(Citation: AWS Traffic Mirroring)(Citation: GCP Packet Mirroring)(Citation: Azure Virtual Network TAP) Often, much of this traffic will be in cleartext due to the use of TLS termination at the load balancer level to reduce the strain of encrypting and decrypting traffic.(Citation: Rhino Security Labs AWS VPC Traffic Mirroring)(Citation: SpecterOps AWS Traffic Mirroring) The adversary can then use exfiltration techniques such as Transfer Data to Cloud Account in order to access the sniffed traffic.(Citation: Rhino Security Labs AWS VPC Traffic Mirroring)

On network devices, adversaries may perform network captures using [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) commands such as `monitor capture`.(Citation: US-CERT-TA18-106A)(Citation: capture_embedded_packet_on_software)",https://attack.mitre.org/techniques/T1040,31 May 2017,12 April 2023,1.4,"['Credential Access', 'Discovery']","Detecting the events leading up to sniffing network traffic may be the best method of detection. From the host level, an adversary would likely need to perform a [Adversary-in-the-Middle](https://attack.mitre.org/techniques/T1557) attack against other devices on a wired network in order to capture traffic that was not to or from the current compromised system. This change in the flow of information is detectable at the enclave network level. Monitor for ARP spoofing and gratuitous ARP broadcasts. Detecting compromised network devices is a bit more challenging. Auditing administrator logins, configuration changes, and device images is required to detect malicious changes.

In cloud-based environments, monitor for the creation of new traffic mirrors or modification of existing traffic mirrors. For network infrastructure devices, collect AAA logging to monitor for the capture of network traffic.","['IaaS', 'Linux', 'Network', 'Windows', 'macOS']","Command: Command Execution, Process: Process Creation",False,,[],"Austin Clark, @c2defense; Oleg Kolesnikov, Securonix; Tiago Faria, 3CORESec",,,Network interface access and packet capture driver,,,"(Citation: MSTIC FoggyWeb September 2021),(Citation: Impacket Tools),(Citation: Symantec Elfin Mar 2019),(Citation: CISA AA20-301A Kimsuky),(Citation: US District Court Indictment GRU Oct 2018),(Citation: ESET Telebots Dec 2016),(Citation: SecTools nbtscan June 2003),(Citation: FireEye APT28),(Citation: Kaspersky Turla Penquin December 2014),(Citation: Trend Micro Banking Malware Jan 2019),(Citation: FireEye APT28 Hospitality Aug 2017),(Citation: Debian nbtscan Nov 2019),(Citation: Securelist DarkVishnya Dec 2018),(Citation: Kaspersky Regin),(Citation: Netscout Stolen Pencil Dec 2018),(Citation: GitHub Responder),(Citation: Github PowerShell Empire),(Citation: FireEye MESSAGETAP October 2019),(Citation: GitHub PoshC2),(Citation: Leonardo Turla Penquin May 2020),","['actor', 'process', 'data store', 'data flow']","[{'mitigation id': 'M1018', 'mitigation name': 'User Account Management', 'mitigation description': 'Manage the creation, modification, use, and permissions associated to user accounts.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1018'}, {'mitigation id': 'M1032', 'mitigation name': 'Multi-factor Authentication', 'mitigation description': 'Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1032'}, {'mitigation id': 'M1041', 'mitigation name': 'Encrypt Sensitive Information', 'mitigation description': 'Protect sensitive information with strong encryption.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1041'}]"
T1041,Exfiltration Over C2 Channel,Adversaries may steal data by exfiltrating it over an existing command and control channel. Stolen data is encoded into the normal communications channel using the same protocol as command and control communications.,https://attack.mitre.org/techniques/T1041,31 May 2017,07 April 2023,2.2,['Exfiltration'],"Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2)","['Linux', 'Windows', 'macOS']","Command: Command Execution, File: File Access, Network Traffic: Network Connection Creation, Network Traffic: Network Traffic Content, Network Traffic: Network Traffic Flow",False,,[],William Cain,,,,,,"(Citation: Cybereason Kimsuky November 2020),(Citation: MSTIC FoggyWeb September 2021),(Citation: Talos Kimsuky Nov 2021),(Citation: McAfee Lazarus Nov 2020),(Citation: Kaspersky WIRTE November 2021),(Citation: Cybereason Cobalt Kitty 2017),(Citation: Accenture SNAKEMACKEREL Nov 2018),(Citation: Scarlet Mimic Jan 2016),(Citation: Zscaler Higaisa 2020),(Citation: Cisco Talos Transparent Tribe Education Campaign July 2022),(Citation: MalwareBytes SideCopy Dec 2021),(Citation: Malwarebytes Konni Aug 2021),(Citation: ESET LightNeuron May 2019),(Citation: ESET DazzleSpy Jan 2022),(Citation: NCC Group Chimera January 2021),(Citation: Talos ROKRAT),(Citation: Trend Micro Emotet Jan 2019),(Citation: McAfee GhostSecret),(Citation: BlackBerry CostaRicto November 2020),(Citation: McAfee Bankshot),(Citation: ESET Casbaneiro Oct 2019),(Citation: BlackBerry Amadey 2020),(Citation: Cybereason Astaroth Feb 2019),(Citation: Lunghi Iron Tiger Linux),(Citation: Unit 42 PingPull Jun 2022),(Citation: ProofPoint Ursnif Aug 2016),(Citation: Nicolas Falliere, Liam O Murchu, Eric Chien February 2011),(Citation: FBI FLASH APT39 September 2020),(Citation: US-CERT BLINDINGCAN Aug 2020),(Citation: Unit42 Molerat Mar 2020),(Citation: NHS UK BLINDINGCAN Aug 2020),(Citation: FOX-IT May 2016 Mofang),(Citation: Bitdefender Trickbot VNC module Whitepaper 2021),(Citation: FSecure Lokibot November 2019),(Citation: Prevailion EvilNum May 2020),(Citation: Securelist Kimsuky Sept 2013),(Citation: Kaspersky MoleRATs April 2019),(Citation: ESET Crutch December 2020),(Citation: Talos Konni May 2017),(Citation: GitHub SILENTTRINITY Modules July 2019),(Citation: Volexity InkySquid BLUELIGHT August 2021),(Citation: SentinelLabs Metador Technical Appendix Sept 2022),(Citation: trendmicro xcsset xcode project 2020),(Citation: MalwareBytes WoodyRAT Aug 2022),(Citation: Unit 42 MechaFlounder March 2019),(Citation: FireEye APT30),(Citation: ESET Okrum July 2019),(Citation: Unit 42 Valak July 2020),(Citation: DHS CISA AA22-055A MuddyWater February 2022),(Citation: HP SVCReady Jun 2022),(Citation: Kaspersky Cloud Atlas August 2019),(Citation: Korean FSI TA505 2020),(Citation: CrowdStrike IceApple May 2022),(Citation: Unit42 Cannon Nov 2018),(Citation: Prevx Carberp March 2011),(Citation: FoxIT Wocao December 2019),(Citation: ESET Gelsemium June 2021),(Citation: Trustwave GoldenSpy June 2020),(Citation: FireEye SMOKEDHAM June 2021),(Citation: NSA/FBI Drovorub August 2020),(Citation: Novetta Blockbuster),(Citation: Zscaler APT31 Covid-19 October 2020),(Citation: McAfee Honeybee),(Citation: Reaqta MuddyWater November 2017),(Citation: ESET Attor Oct 2019),(Citation: Cybereason Valak May 2020),(Citation: Cybereason Soft Cell June 2019),(Citation: Intezer Doki July 20),(Citation: Check Point Warzone Feb 2020),(Citation: FireEye Clandestine Fox),(Citation: McAfee Sharpshooter December 2018),(Citation: ClearSky Siamesekitten August 2021),(Citation: ClearSky Lebanese Cedar Jan 2021),(Citation: Novetta Blockbuster Loaders),(Citation: Securelist Remexi Jan 2019),(Citation: ESET Grandoreiro April 2020),(Citation: GitHub Sliver Download),(Citation: Kaspersky Tomiris Sep 2021),(Citation: Talos PoetRAT October 2020),(Citation: Bitdefender FunnyDream Campaign November 2020),(Citation: GitHub Pupy),(Citation: Citizen Lab Stealth Falcon May 2016),(Citation: Kaspersky QakBot September 2021),(Citation: reed thiefquest ransomware analysis),(Citation: CrowdStrike Grim Spider May 2019),(Citation: Zscaler Lyceum DnsSystem June 2022),(Citation: Microsoft POLONIUM June 2022),(Citation: Malwarebytes Kimsuky June 2021),(Citation: Cybereason StrifeWater Feb 2022),(Citation: Bitdefender StrongPity June 2020),(Citation: Trusteer Carberp October 2010),(Citation: MSTIC NOBELIUM Mar 2021),(Citation: Check Point APT35 CharmPower January 2022),(Citation: Cyberreason Anchor December 2019),(Citation: ESET Telebots Dec 2016),(Citation: ESET Sednit Part 2),(Citation: Mandiant Operation Ke3chang November 2014),(Citation: ClearSky Lazarus Aug 2020),(Citation: Malwarebytes KONNI Evolves Jan 2022),(Citation: ESET ForSSHe December 2018),(Citation: Kaspersky LuminousMoth July 2021),(Citation: NTT Security Flagpro new December 2021),(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ),(Citation: FireEye HAWKBALL Jun 2019),(Citation: Trend Micro njRAT 2018),(Citation: CISA MAR SLOTHFULMEDIA October 2020),(Citation: SentinelOne Valak June 2020),(Citation: ESET OceanLotus Mar 2019),(Citation: Kaspersky Ferocious Kitten Jun 2021),(Citation: Talos Bisonal Mar 2020),(Citation: Leonardo Turla Penquin May 2020),(Citation: Talos Frankenstein June 2019),(Citation: NCSC Cyclops Blink February 2022),(Citation: FireEye Ursnif Nov 2017),(Citation: FireEye SUNSHUTTLE Mar 2021),(Citation: ESET Windigo Mar 2014),(Citation: CISA AppleJeus Feb 2021),(Citation: Google EXOTIC LILY March 2022),(Citation: Unit 42 OopsIE! Feb 2018),(Citation: Group IB GrimAgent July 2021),(Citation: Talos Promethium June 2020),(Citation: US-CERT HOPLIGHT Apr 2019),(Citation: wardle evilquest partii),(Citation: Check Point APT34 April 2021),(Citation: QiAnXin APT-C-36 Feb2019),(Citation: ZScaler Squirrelwaffle Sep 2021),(Citation: SentinelOne Aoqin Dragon June 2022),(Citation: CISA Zebrocy Oct 2020),(Citation: Securelist Octopus Oct 2018),(Citation: TrendMicro Ursnif Mar 2015),(Citation: ESET Industroyer),(Citation: CheckPoint Bandook Nov 2020),(Citation: ESET Machete July 2019),(Citation: Kaspersky Lyceum October 2021),(Citation: Unit42 RDAT July 2020),(Citation: Mandiant UNC3890 Aug 2022),(Citation: Kaspersky TajMahal April 2019),(Citation: Secureworks REvil September 2019),(Citation: SentinelLabs Metador Sept 2022),(Citation: Cylance Dust Storm),(Citation: Carbon Black HotCroissant April 2020),(Citation: Checkpoint IndigoZebra July 2021),(Citation: Mandiant APT41),(Citation: McAfee Lazarus Resurfaces Feb 2018),(Citation: TrendMicro Confucius APT Aug 2021),(Citation: Github PowerShell Empire),(Citation: CISA AA21-200A APT40 July 2021),(Citation: Palo Alto Gamaredon Feb 2017),(Citation: Malwarebytes Dyreza November 2015),(Citation: University of Birmingham C2)","['process', 'data store', 'data flow']","[{'mitigation id': 'M1031', 'mitigation name': 'Network Intrusion Prevention', 'mitigation description': 'Use intrusion detection signatures to block traffic at network boundaries.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1031'}, {'mitigation id': 'M1057', 'mitigation name': 'Data Loss Prevention', 'mitigation description': 'Use a data loss prevention (DLP) strategy to categorize sensitive data, identify data formats indicative of personal identifiable information (PII), and restrict exfiltration of sensitive data.(Citation: PurpleSec Data Loss Prevention)', 'mitigation url': 'https://attack.mitre.org/mitigations/M1057'}]"
T1048,Exfiltration Over Alternative Protocol,"Adversaries may steal data by exfiltrating it over a different protocol than that of the existing command and control channel. The data may also be sent to an alternate network location from the main command and control server.  

Alternate protocols include FTP, SMTP, HTTP/S, DNS, SMB, or any other network protocol not being used as the main command and control channel. Adversaries may also opt to encrypt and/or obfuscate these alternate channels. 

[Exfiltration Over Alternative Protocol](https://attack.mitre.org/techniques/T1048) can be done using various common operating system utilities such as [Net](https://attack.mitre.org/software/S0039)/SMB or FTP.(Citation: Palo Alto OilRig Oct 2016) On macOS and Linux <code>curl</code> may be used to invoke protocols such as HTTP/S or FTP/S to exfiltrate data from a system.(Citation: 20 macOS Common Tools and Techniques)

Many IaaS and SaaS platforms (such as Microsoft Exchange, Microsoft SharePoint, GitHub, and AWS S3) support the direct download of files, emails, source code, and other sensitive information via the web console or [Cloud API](https://attack.mitre.org/techniques/T1059/009).",https://attack.mitre.org/techniques/T1048,31 May 2017,15 April 2023,1.4,['Exfiltration'],"Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2)","['Google Workspace', 'IaaS', 'Linux', 'Network', 'Office 365', 'SaaS', 'Windows', 'macOS']","Application Log: Application Log Content, Cloud Storage: Cloud Storage Access, Command: Command Execution, File: File Access, Network Traffic: Network Connection Creation, Network Traffic: Network Traffic Content, Network Traffic: Network Traffic Flow",False,,[],Alfredo Abarca; William Cain,,,,,,"(Citation: SentinelOne FrameworkPOS September 2019),(Citation: Symantec Hydraq Jan 2010),(Citation: ESET Kobalos Feb 2021),(Citation: AADInternals Documentation),(Citation: Cybereason Chaes Nov 2020),(Citation: Talos PoetRAT April 2020),(Citation: 20 macOS Common Tools and Techniques),(Citation: Cisco Talos Intelligence Group),(Citation: TechNet Firewall Design),(Citation: Amazon S3 Security, 2019),(Citation: Microsoft Azure Storage Security, 2019),(Citation: Amazon  AWS Temporary Security Credentials)","['process', 'data store', 'data flow']","[{'mitigation id': 'M1018', 'mitigation name': 'User Account Management', 'mitigation description': 'Manage the creation, modification, use, and permissions associated to user accounts.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1018'}, {'mitigation id': 'M1022', 'mitigation name': 'Restrict File and Directory Permissions', 'mitigation description': 'Restrict access by setting directory and file permissions that are not specific to users or privileged accounts.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1022'}, {'mitigation id': 'M1030', 'mitigation name': 'Network Segmentation', 'mitigation description': 'Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network. Configure separate virtual private cloud (VPC) instances to isolate critical cloud systems.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1030'}, {'mitigation id': 'M1031', 'mitigation name': 'Network Intrusion Prevention', 'mitigation description': 'Use intrusion detection signatures to block traffic at network boundaries.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1031'}, {'mitigation id': 'M1037', 'mitigation name': 'Filter Network Traffic', 'mitigation description': 'Use network appliances to filter ingress or egress traffic and perform protocol-based filtering. Configure software on endpoints to filter network traffic.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1037'}, {'mitigation id': 'M1057', 'mitigation name': 'Data Loss Prevention', 'mitigation description': 'Use a data loss prevention (DLP) strategy to categorize sensitive data, identify data formats indicative of personal identifiable information (PII), and restrict exfiltration of sensitive data.(Citation: PurpleSec Data Loss Prevention)', 'mitigation url': 'https://attack.mitre.org/mitigations/M1057'}]"
T1048.001,Exfiltration Over Alternative Protocol: Exfiltration Over Symmetric Encrypted Non-C2 Protocol,"Adversaries may steal data by exfiltrating it over a symmetrically encrypted network protocol other than that of the existing command and control channel. The data may also be sent to an alternate network location from the main command and control server. 

Symmetric encryption algorithms are those that use shared or the same keys/secrets on each end of the channel. This requires an exchange or pre-arranged agreement/possession of the value used to encrypt and decrypt data. 

Network protocols that use asymmetric encryption often utilize symmetric encryption once keys are exchanged, but adversaries may opt to manually share keys and implement symmetric cryptographic algorithms (ex: RC4, AES) vice using mechanisms that are baked into a protocol. This may result in multiple layers of encryption (in protocols that are natively encrypted such as HTTPS) or encryption in protocols that not typically encrypted (such as HTTP or FTP). ",https://attack.mitre.org/techniques/T1048/001,15 March 2020,28 March 2020,1.0,['Exfiltration'],"Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.(Citation: University of Birmingham C2) 

Artifacts and evidence of symmetric key exchange may be recoverable by analyzing network traffic or looking for hard-coded values within malware. If recovered, these keys can be used to decrypt network data from command and control channels. ","['Linux', 'Windows', 'macOS']","Command: Command Execution, File: File Access, Network Traffic: Network Connection Creation, Network Traffic: Network Traffic Content, Network Traffic: Network Traffic Flow",True,T1048,,,,,,,,",(Citation: TechNet Firewall Design)","['process', 'data store', 'data flow']","[{'mitigation id': 'M1030', 'mitigation name': 'Network Segmentation', 'mitigation description': 'Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network. Configure separate virtual private cloud (VPC) instances to isolate critical cloud systems.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1030'}, {'mitigation id': 'M1031', 'mitigation name': 'Network Intrusion Prevention', 'mitigation description': 'Use intrusion detection signatures to block traffic at network boundaries.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1031'}, {'mitigation id': 'M1037', 'mitigation name': 'Filter Network Traffic', 'mitigation description': 'Use network appliances to filter ingress or egress traffic and perform protocol-based filtering. Configure software on endpoints to filter network traffic.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1037'}]"
T1048.002,Exfiltration Over Alternative Protocol: Exfiltration Over Asymmetric Encrypted Non-C2 Protocol,"Adversaries may steal data by exfiltrating it over an asymmetrically encrypted network protocol other than that of the existing command and control channel. The data may also be sent to an alternate network location from the main command and control server. 

Asymmetric encryption algorithms are those that use different keys on each end of the channel. Also known as public-key cryptography, this requires pairs of cryptographic keys that can encrypt/decrypt data from the corresponding key. Each end of the communication channels requires a private key (only in the procession of that entity) and the public key of the other entity. The public keys of each entity are exchanged before encrypted communications begin. 

Network protocols that use asymmetric encryption (such as HTTPS/TLS/SSL) often utilize symmetric encryption once keys are exchanged. Adversaries may opt to use these encrypted mechanisms that are baked into a protocol. ",https://attack.mitre.org/techniques/T1048/002,15 March 2020,15 October 2021,1.1,['Exfiltration'],"Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.(Citation: University of Birmingham C2) ","['Linux', 'Windows', 'macOS']","Command: Command Execution, File: File Access, Network Traffic: Network Connection Creation, Network Traffic: Network Traffic Content, Network Traffic: Network Traffic Flow",True,T1048,,William Cain,,,,,,"(Citation: Cybersecurity Advisory GRU Brute Force Campaign July 2021),(Citation: Rclone),(Citation: Volexity SolarWinds),(Citation: TechNet Firewall Design)","['process', 'data store', 'data flow']","[{'mitigation id': 'M1030', 'mitigation name': 'Network Segmentation', 'mitigation description': 'Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network. Configure separate virtual private cloud (VPC) instances to isolate critical cloud systems.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1030'}, {'mitigation id': 'M1031', 'mitigation name': 'Network Intrusion Prevention', 'mitigation description': 'Use intrusion detection signatures to block traffic at network boundaries.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1031'}, {'mitigation id': 'M1037', 'mitigation name': 'Filter Network Traffic', 'mitigation description': 'Use network appliances to filter ingress or egress traffic and perform protocol-based filtering. Configure software on endpoints to filter network traffic.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1037'}, {'mitigation id': 'M1057', 'mitigation name': 'Data Loss Prevention', 'mitigation description': 'Use a data loss prevention (DLP) strategy to categorize sensitive data, identify data formats indicative of personal identifiable information (PII), and restrict exfiltration of sensitive data.(Citation: PurpleSec Data Loss Prevention)', 'mitigation url': 'https://attack.mitre.org/mitigations/M1057'}]"
T1048.003,Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol,"Adversaries may steal data by exfiltrating it over an un-encrypted network protocol other than that of the existing command and control channel. The data may also be sent to an alternate network location from the main command and control server.(Citation: copy_cmd_cisco)

Adversaries may opt to obfuscate this data, without the use of encryption, within network protocols that are natively unencrypted (such as HTTP, FTP, or DNS). This may include custom or publicly available encoding/compression algorithms (such as base64) as well as embedding data within protocol headers and fields. ",https://attack.mitre.org/techniques/T1048/003,15 March 2020,12 April 2023,2.1,['Exfiltration'],"Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2) 

For network infrastructure devices, collect AAA logging to monitor for `copy` commands being run to exfiltrate configuration files to non-standard destinations over unencrypted protocols such as TFTP.","['Linux', 'Network', 'Windows', 'macOS']","Command: Command Execution, File: File Access, Network Traffic: Network Connection Creation, Network Traffic: Network Traffic Content, Network Traffic: Network Traffic Flow",True,T1048,,"Austin Clark, @c2defense; William Cain",,,,,,"(Citation: Microsoft FTP),(Citation: DFIR Ryuk 2 Hour Speed Run November 2020),(Citation: Trustwave Cherry Picker),(Citation: FireEye Know Your Enemy FIN8 Aug 2016),(Citation: Symantec Elfin Mar 2019),(Citation: Rclone),(Citation: Check Point APT35 CharmPower January 2022),(Citation: Talos PoetRAT April 2020),(Citation: Talos Agent Tesla Oct 2018),(Citation: objective-see windtail2 jan 2019),(Citation: Symantec Thrip June 2018),(Citation: FireEye APT37 Feb 2018),(Citation: ESET Carbon Mar 2017),(Citation: Medium KONNI Jan 2020),(Citation: ESET ForSSHe December 2018),(Citation: F-Secure Cosmicduke),(Citation: Unit42 CookieMiner Jan 2019),(Citation: hexed osx.dok analysis 2019),(Citation: Novetta Blockbuster),(Citation: SentinelLabs Agent Tesla Aug 2020),(Citation: Linux FTP),(Citation: McAfee Gold Dragon),(Citation: Microsoft BITSAdmin),(Citation: Novetta Blockbuster RATs),(Citation: DFIR Ryuk's Return October 2020),(Citation: Kaspersky ProjectSauron Full Report),(Citation: ESET OceanLotus Mar 2019),(Citation: Mandiant APT41),(Citation: Palo Alto OilRig Oct 2016),(Citation: Bitdefender Agent Tesla April 2020),(Citation: Bitdefender FunnyDream Campaign November 2020),(Citation: Trend Micro FIN6 October 2019),(Citation: TechNet Firewall Design)","['process', 'data store', 'data flow']","[{'mitigation id': 'M1030', 'mitigation name': 'Network Segmentation', 'mitigation description': 'Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network. Configure separate virtual private cloud (VPC) instances to isolate critical cloud systems.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1030'}, {'mitigation id': 'M1031', 'mitigation name': 'Network Intrusion Prevention', 'mitigation description': 'Use intrusion detection signatures to block traffic at network boundaries.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1031'}, {'mitigation id': 'M1037', 'mitigation name': 'Filter Network Traffic', 'mitigation description': 'Use network appliances to filter ingress or egress traffic and perform protocol-based filtering. Configure software on endpoints to filter network traffic.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1037'}, {'mitigation id': 'M1057', 'mitigation name': 'Data Loss Prevention', 'mitigation description': 'Use a data loss prevention (DLP) strategy to categorize sensitive data, identify data formats indicative of personal identifiable information (PII), and restrict exfiltration of sensitive data.(Citation: PurpleSec Data Loss Prevention)', 'mitigation url': 'https://attack.mitre.org/mitigations/M1057'}]"
T1052,Exfiltration Over Physical Medium,"Adversaries may attempt to exfiltrate data via a physical medium, such as a removable drive. In certain circumstances, such as an air-gapped network compromise, exfiltration could occur via a physical medium or device introduced by a user. Such media could be an external hard drive, USB drive, cellular phone, MP3 player, or other removable storage and processing device. The physical medium or device could be used as the final exfiltration point or to hop between otherwise disconnected systems.",https://attack.mitre.org/techniques/T1052,31 May 2017,15 October 2021,1.2,['Exfiltration'],Monitor file access on removable media. Detect processes that execute when removable media are mounted.,"['Linux', 'Windows', 'macOS']","Command: Command Execution, Drive: Drive Creation, File: File Access, Process: Process Creation",False,,[],William Cain,,,Presence of physical medium or device,,,",(Citation: TechNet Removable Media Control),(Citation: Microsoft Disable Autorun)","['process', 'data store', 'data flow']","[{'mitigation id': 'M1034', 'mitigation name': 'Limit Hardware Installation', 'mitigation description': 'Block users or groups from installing or using unapproved hardware on systems, including USB devices.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1034'}, {'mitigation id': 'M1042', 'mitigation name': 'Disable or Remove Feature or Program', 'mitigation description': 'Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1042'}, {'mitigation id': 'M1057', 'mitigation name': 'Data Loss Prevention', 'mitigation description': 'Use a data loss prevention (DLP) strategy to categorize sensitive data, identify data formats indicative of personal identifiable information (PII), and restrict exfiltration of sensitive data.(Citation: PurpleSec Data Loss Prevention)', 'mitigation url': 'https://attack.mitre.org/mitigations/M1057'}]"
T1052.001,Exfiltration Over Physical Medium: Exfiltration over USB,"Adversaries may attempt to exfiltrate data over a USB connected physical device. In certain circumstances, such as an air-gapped network compromise, exfiltration could occur via a USB device introduced by a user. The USB device could be used as the final exfiltration point or to hop between otherwise disconnected systems.",https://attack.mitre.org/techniques/T1052/001,11 March 2020,15 October 2021,1.1,['Exfiltration'],Monitor file access on removable media. Detect processes that execute when removable media are mounted.,"['Linux', 'Windows', 'macOS']","Command: Command Execution, Drive: Drive Creation, File: File Access, Process: Process Creation",True,T1052,,William Cain,,,Presence of physical medium or device,,,"(Citation: Avira Mustang Panda January 2020),(Citation: ESET Machete July 2019),(Citation: ESET Sednit USBStealer 2014),(Citation: TrendMicro Tropic Trooper May 2020),(Citation: Securelist Agent.btz),(Citation: FireEye APT30),(Citation: Securelist Machete Aug 2014),(Citation: Kaspersky ProjectSauron Full Report),(Citation: TechNet Removable Media Control),(Citation: Microsoft Disable Autorun)","['process', 'data store', 'data flow']","[{'mitigation id': 'M1034', 'mitigation name': 'Limit Hardware Installation', 'mitigation description': 'Block users or groups from installing or using unapproved hardware on systems, including USB devices.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1034'}, {'mitigation id': 'M1042', 'mitigation name': 'Disable or Remove Feature or Program', 'mitigation description': 'Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1042'}, {'mitigation id': 'M1057', 'mitigation name': 'Data Loss Prevention', 'mitigation description': 'Use a data loss prevention (DLP) strategy to categorize sensitive data, identify data formats indicative of personal identifiable information (PII), and restrict exfiltration of sensitive data.(Citation: PurpleSec Data Loss Prevention)', 'mitigation url': 'https://attack.mitre.org/mitigations/M1057'}]"
T1056,Input Capture,"Adversaries may use methods of capturing user input to obtain credentials or collect information. During normal system usage, users often provide credentials to various different locations, such as login pages/portals or system dialog boxes. Input capture mechanisms may be transparent to the user (e.g. [Credential API Hooking](https://attack.mitre.org/techniques/T1056/004)) or rely on deceiving the user into providing input into what they believe to be a genuine service (e.g. [Web Portal Capture](https://attack.mitre.org/techniques/T1056/003)).",https://attack.mitre.org/techniques/T1056,31 May 2017,30 March 2023,1.2,"['Collection', 'Credential Access']","Detection may vary depending on how input is captured but may include monitoring for certain Windows API calls (e.g. `SetWindowsHook`, `GetKeyState`, and `GetAsyncKeyState`)(Citation: Adventures of a Keystroke), monitoring for malicious instances of [Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059), and ensuring no unauthorized drivers or kernel modules that could indicate keylogging or API hooking are present.","['Linux', 'Network', 'Windows', 'macOS']","Driver: Driver Load, File: File Modification, Process: OS API Execution, Process: Process Creation, Process: Process Metadata, Windows Registry: Windows Registry Key Modification",False,,[],"John Lambert, Microsoft Threat Intelligence Center","['Administrator', 'root', 'SYSTEM', 'User']",,,,,"(Citation: Korean FSI TA505 2020),(Citation: FBI FLASH APT39 September 2020),(Citation: SentinelLabs Metador Technical Appendix Sept 2022),(Citation: ESET Kobalos Feb 2021),(Citation: ESET Kobalos Jan 2021),(Citation: Cybereason Chaes Nov 2020),","['actor', 'process', 'data store', 'data flow']",
T1056.001,Input Capture: Keylogging,"Adversaries may log user keystrokes to intercept credentials as the user types them. Keylogging is likely to be used to acquire credentials for new access opportunities when [OS Credential Dumping](https://attack.mitre.org/techniques/T1003) efforts are not effective, and may require an adversary to intercept keystrokes on a system for a substantial period of time before credentials can be successfully captured.

Keylogging is the most prevalent type of input capture, with many different ways of intercepting keystrokes.(Citation: Adventures of a Keystroke) Some methods include:

* Hooking API callbacks used for processing keystrokes. Unlike [Credential API Hooking](https://attack.mitre.org/techniques/T1056/004), this focuses solely on API functions intended for processing keystroke data.
* Reading raw keystroke data from the hardware buffer.
* Windows Registry modifications.
* Custom drivers.
* [Modify System Image](https://attack.mitre.org/techniques/T1601) may provide adversaries with hooks into the operating system of network devices to read raw keystrokes for login sessions.(Citation: Cisco Blog Legacy Device Attacks) ",https://attack.mitre.org/techniques/T1056/001,11 February 2020,30 March 2023,1.1,"['Collection', 'Credential Access']","Keyloggers may take many forms, possibly involving modification to the Registry and installation of a driver, setting a hook, or polling to intercept keystrokes. Commonly used API calls include `SetWindowsHook`, `GetKeyState`, and `GetAsyncKeyState`.(Citation: Adventures of a Keystroke) Monitor the Registry and file system for such changes, monitor driver installs, and look for common keylogging API calls. API calls alone are not an indicator of keylogging, but may provide behavioral data that is useful when combined with other information such as new files written to disk and unusual processes.","['Linux', 'Network', 'Windows', 'macOS']","Driver: Driver Load, Process: OS API Execution, Windows Registry: Windows Registry Key Modification",True,T1056,,,"['Administrator', 'root', 'SYSTEM', 'User']",,,,,"(Citation: Kaspersky NetTraveler),(Citation: FireEye Shining A Light on DARKSIDE May 2021),(Citation: Amnesty Intl. Ocean Lotus February 2021),(Citation: Cybereason Kimsuky November 2020),(Citation: GitHub QuasarRAT),(Citation: Fortinet Agent Tesla June 2017),(Citation: Talos Kimsuky Nov 2021),(Citation: Cylance Shaheen Nov 2018),(Citation: Microsoft SIR Vol 19),(Citation: Trend Micro DRBControl February 2020),(Citation: Palo Alto MoonWind March 2017),(Citation: Kaspersky Adwind Feb 2016),(Citation: Symantec Sowbug Nov 2017),(Citation: Symantec Remsec IOCs),(Citation: Talos Agent Tesla Oct 2018),(Citation: SentinelOne MacMa Nov 2021),(Citation: FireEye Hacking FIN4 Dec 2014),(Citation: cobaltstrike manual),(Citation: McAfee Cuba April 2021),(Citation: Imminent Unit42 Dec2019),(Citation: Unit 42 Magic Hound Feb 2017),(Citation: Proofpoint NETWIRE December 2020),(Citation: Alienvault Sykipot DOD Smart Cards),(Citation: DOJ GRU Indictment Jul 2018),(Citation: Citizen Lab Group5),(Citation: Zscaler Kasidet),(Citation: KISA Operation Muzabi),(Citation: Cybereason Cobalt Kitty 2017),(Citation: Scarlet Mimic Jan 2016),(Citation: Symantec Catchamas April 2018),(Citation: Cisco Talos Transparent Tribe Education Campaign July 2022),(Citation: Alintanahin 2014),(Citation: TrendMicro Tonto Team October 2020),(Citation: Talos ROKRAT),(Citation: 360 Machete Sep 2020),(Citation: FireEye APT38 Oct 2018),(Citation: Check Point Rocket Kitten),(Citation: ESET Casbaneiro Oct 2019),(Citation: CIRCL PlugX March 2013),(Citation: Cylance Machete Mar 2017),(Citation: Baumgartner Naikon 2015),(Citation: GDATA Zeus Panda June 2017),(Citation: Dell TG-3390),(Citation: District Court of NY APT10 Indictment December 2018),(Citation: FBI FLASH APT39 September 2020),(Citation: jRAT Symantec Aug 2018),(Citation: Bitdefender Agent Tesla April 2020),(Citation: Cobalt Strike Manual 4.3 November 2020),(Citation: Radware Micropsia July 2018),(Citation: Symantec Chafer Dec 2015),(Citation: FireEye Hacking FIN4 Video Dec 2014),(Citation: FSecure Lokibot November 2019),(Citation: Gh0stRAT ATT March 2019),(Citation: Uptycs Warzone UAC Bypass November 2020),(Citation: Securelist Kimsuky Sept 2013),(Citation: Cylance Cleaver),(Citation: Talos Konni May 2017),(Citation: GitHub SILENTTRINITY Modules July 2019),(Citation: Unit42 BabyShark Apr 2019),(Citation: SentinelLabs Metador Technical Appendix Sept 2022),(Citation: FireEye APT34 July 2019),(Citation: Symantec Darkmoon Aug 2005),(Citation: Unit 42 BadPatch Oct 2017),(Citation: FireEye Poison Ivy),(Citation: ESET Okrum July 2019),(Citation: Talos PoetRAT April 2020),(Citation: EST Kimsuky April 2019),(Citation: Cofense Astaroth Sept 2018),(Citation: objsee mac malware 2017),(Citation: Securelist Machete Aug 2014),(Citation: Proofpoint Operation Transparent Tribe March 2016),(Citation: Secureworks Karagany July 2019),(Citation: Unit 42 Nokki Oct 2018),(Citation: TrendMicro DarkComet Sept 2014),(Citation: Cybereason PowerLess February 2022),(Citation: FireEye APT37 Feb 2018),(Citation: Korean FSI TA505 2020),(Citation: Symantec W32.Duqu),(Citation: FoxIT Wocao December 2019),(Citation: Kaspersky Carbanak),(Citation: TrendMicro Pawn Storm Dec 2020),(Citation: Kaspersky Darkhotel),(Citation: FireEye SMOKEDHAM June 2021),(Citation: Fortinet Metamorfo Feb 2020),(Citation: Fortinet Remcos Feb 2017),(Citation: CopyKittens Nov 2015),(Citation: Novetta Blockbuster),(Citation: Hacker News LuckyMouse June 2018),(Citation: ESET Attor Oct 2019),(Citation: Mandiant APT1 Appendix),(Citation: TrendMicro BlackTech June 2017),(Citation: Kaspersky Regin),(Citation: Check Point Warzone Feb 2020),(Citation: Securelist Dtrack),(Citation: Volexity Patchwork June 2018),(Citation: FireEye APT41 Aug 2019),(Citation: ESET GreyEnergy Oct 2018),(Citation: ClearSky Lebanese Cedar Jan 2021),(Citation: FireEye APT34 Webinar Dec 2017),(Citation: Securelist Remexi Jan 2019),(Citation: Unit42 Redaman January 2019),(Citation: Cofense RevengeRAT Feb 2019),(Citation: ESET RTM Feb 2017),(Citation: ESET Grandoreiro April 2020),(Citation: FireEye CARBANAK June 2017),(Citation: FireEye NETWIRE March 2019),(Citation: Secureworks DarkTortilla Aug 2022),(Citation: Bitdefender FunnyDream Campaign November 2020),(Citation: Securelist BlackEnergy Nov 2014),(Citation: GitHub Pupy),(Citation: Novetta Blockbuster Tools),(Citation: Kaspersky QakBot September 2021),(Citation: Malwarebytes Kimsuky June 2021),(Citation: CISA AA20-301A Kimsuky),(Citation: Talent-Jump Clambling February 2020),(Citation: Crowdstrike DNC June 2016),(Citation: NCC Group APT15 Alive and Strong),(Citation: ESET InvisiMole June 2020),(Citation: ESET Telebots Dec 2016),(Citation: ASERT Donot March 2018),(Citation: Symantec Chafer February 2018),(Citation: ESET Sednit Part 2),(Citation: Kroll Qakbot June 2020),(Citation: Zscaler Cobian Aug 2017),(Citation: Red Canary NETWIRE January 2020),(Citation: PWC Cloud Hopper Technical Annex April 2017),(Citation: Secureworks BRONZE BUTLER Oct 2017),(Citation: Rapid7 KeyBoy Jun 2013),(Citation: CheckPoint Volatile Cedar March 2015),(Citation: Trend Micro njRAT 2018),(Citation: CISA EB Aug 2020),(Citation: CISA MAR SLOTHFULMEDIA October 2020),(Citation: Prevailion DarkWatchman 2021),(Citation: Talos NavRAT May 2018),(Citation: Netscout Stolen Pencil Dec 2018),(Citation: BH Manul Aug 2016),(Citation: FireEye APT33 Webinar Sept 2017),(Citation: Kaspersky Ferocious Kitten Jun 2021),(Citation: ClearSky Wilted Tulip July 2017),(Citation: Palo Alto OilRig May 2016),(Citation: PowerSploit Documentation),(Citation: Talos Remcos Aug 2018),(Citation: Volexity InkySquid RokRAT August 2021),(Citation: XAgentOSX 2017),(Citation: Trend Micro Daserf Nov 2017),(Citation: DigiTrust Agent Tesla Jan 2017),(Citation: PaloAlto Patchwork Mar 2018),(Citation: Kaspersky ProjectSauron Technical Analysis),(Citation: Symantec Buckeye),(Citation: Profero APT27 December 2020),(Citation: Palo Alto Rover),(Citation: Forcepoint Monsoon),(Citation: Microsoft PLATINUM April 2016),(Citation: FireEye Periscope March 2018),(Citation: Talos ZxShell Oct 2014),(Citation: Microsoft NICKEL December 2021),(Citation: Fidelis njRAT June 2013),(Citation: McAfee Netwire Mar 2015),(Citation: Trend Micro Qakbot December 2020),(Citation: F-Secure The Dukes),(Citation: SecureWorks August 2019),(Citation: SentinelLabs Agent Tesla Aug 2020),(Citation: ESET Machete July 2019),(Citation: Trendmicro Evolving ThiefQuest 2020),(Citation: ESET Operation Groundbait),(Citation: McAfee Gold Dragon),(Citation: Kaspersky Lyceum October 2021),(Citation: Bitdefender APT28 Dec 2015),(Citation: Kaspersky TajMahal April 2019),(Citation: PaloAlto nulloCore Feb 2016),(Citation: PaloAlto CardinalRat Apr 2017),(Citation: Securelist LuckyMouse June 2018),(Citation: SentinelLabs Metador Sept 2022),(Citation: GitHub PowerSploit May 2012),(Citation: Github PowerShell Empire),(Citation: Unit 42 VERMIN Jan 2018),(Citation: GitHub PoshC2),(Citation: Kaspersky Transparent Tribe August 2020),(Citation: DustySky),(Citation: TrendMicro Patchwork Dec 2017),(Citation: Fysbis Palo Alto Analysis),(Citation: Objective-See MacMa Nov 2021),","['actor', 'process', 'data store', 'data flow']",
T1056.002,Input Capture: GUI Input Capture,"Adversaries may mimic common operating system GUI components to prompt users for credentials with a seemingly legitimate prompt. When programs are executed that need additional privileges than are present in the current user context, it is common for the operating system to prompt the user for proper credentials to authorize the elevated privileges for the task (ex: [Bypass User Account Control](https://attack.mitre.org/techniques/T1548/002)).

Adversaries may mimic this functionality to prompt users for credentials with a seemingly legitimate prompt for a number of reasons that mimic normal usage, such as a fake installer requiring additional access or a fake malware removal suite.(Citation: OSX Malware Exploits MacKeeper) This type of prompt can be used to collect credentials via various languages such as [AppleScript](https://attack.mitre.org/techniques/T1059/002)(Citation: LogRhythm Do You Trust Oct 2014)(Citation: OSX Keydnap malware)(Citation: Spoofing credential dialogs) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).(Citation: LogRhythm Do You Trust Oct 2014)(Citation: Enigma Phishing for Credentials Jan 2015)(Citation: Spoofing credential dialogs) On Linux systems adversaries may launch dialog boxes prompting users for credentials from malicious shell scripts or the command line (i.e. [Unix Shell](https://attack.mitre.org/techniques/T1059/004)).(Citation: Spoofing credential dialogs) ",https://attack.mitre.org/techniques/T1056/002,11 February 2020,30 March 2023,1.2,"['Collection', 'Credential Access']","Monitor process execution for unusual programs as well as malicious instances of [Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059) that could be used to prompt users for credentials. For example, command/script history including abnormal parameters (such as requests for credentials and/or strings related to creating password prompts) may be malicious.(Citation: Spoofing credential dialogs) 

Inspect and scrutinize input prompts for indicators of illegitimacy, such as non-traditional banners, text, timing, and/or sources. ","['Linux', 'Windows', 'macOS']","Command: Command Execution, Process: Process Creation, Script: Script Execution",True,T1056,,"Matthew Molyett, @s1air, Cisco Talos",['User'],,,,,"(Citation: Symantec Calisto July 2018),(Citation: GitHub SILENTTRINITY Modules July 2019),(Citation: synack 2016 review),(Citation: trendmicro xcsset xcode project 2020),(Citation: FireEye Metamorfo Apr 2018),(Citation: FireEye Hacking FIN4 Video Dec 2014),(Citation: objsee mac malware 2017),(Citation: FireEye Hacking FIN4 Dec 2014),(Citation: MacKeeper Bundlore Apr 2019),","['actor', 'process', 'data store', 'data flow']","[{'mitigation id': 'M1017', 'mitigation name': 'User Training', 'mitigation description': 'Train users to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1017'}]"
T1056.003,Input Capture: Web Portal Capture,"Adversaries may install code on externally facing portals, such as a VPN login page, to capture and transmit credentials of users who attempt to log into the service. For example, a compromised login page may log provided user credentials before logging the user in to the service.

This variation on input capture may be conducted post-compromise using legitimate administrative access as a backup measure to maintain network access through [External Remote Services](https://attack.mitre.org/techniques/T1133) and [Valid Accounts](https://attack.mitre.org/techniques/T1078) or as part of the initial compromise by exploitation of the externally facing web service.(Citation: Volexity Virtual Private Keylogging)",https://attack.mitre.org/techniques/T1056/003,11 February 2020,30 March 2023,1.0,"['Collection', 'Credential Access']",File monitoring may be used to detect changes to files in the Web directory for organization login pages that do not match with authorized updates to the Web server's content.,"['Linux', 'Windows', 'macOS']",File: File Modification,True,T1056,,,,,An externally facing login portal is configured.,,,"(Citation: CrowdStrike IceApple May 2022),","['actor', 'process', 'data store', 'data flow']","[{'mitigation id': 'M1026', 'mitigation name': 'Privileged Account Management', 'mitigation description': 'Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1026'}]"
T1071,Application Layer Protocol,"Adversaries may communicate using OSI application layer protocols to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. 

Adversaries may utilize many different protocols, including those used for web browsing, transferring files, electronic mail, or DNS. For connections that occur internally within an enclave (such as those between a proxy or pivot node and other nodes), commonly used protocols are SMB, SSH, or RDP. ",https://attack.mitre.org/techniques/T1071,31 May 2017,11 April 2023,2.1,['Command and Control'],"Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect application layer protocols that do not follow the expected protocol standards regarding syntax, structure, or any other variable adversaries could leverage to conceal data.(Citation: University of Birmingham C2)","['Linux', 'Windows', 'macOS']","Network Traffic: Network Traffic Content, Network Traffic: Network Traffic Flow",False,,[],Duane Michael,,,,,,"(Citation: US-CERT TA18-074A),(Citation: Unit 42 Magic Hound Feb 2017),(Citation: Unit 42 Lucifer June 2020),(Citation: Symantec W32.Duqu),(Citation: Trend Micro DRBControl February 2020),(Citation: DFIR Phosphorus November 2021),(Citation: Talos Cobalt Strike September 2020),(Citation: Unit 42 Siloscape Jun 2021),(Citation: Kaspersky Regin),(Citation: Unit 42 Hildegard Malware),(Citation: Trend Micro TeamTNT),(Citation: cobaltstrike manual),(Citation: Talos Rocke August 2018),","['actor', 'process', 'data flow']","[{'mitigation id': 'M1031', 'mitigation name': 'Network Intrusion Prevention', 'mitigation description': 'Use intrusion detection signatures to block traffic at network boundaries.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1031'}]"
T1071.001,Application Layer Protocol: Web Protocols,"Adversaries may communicate using application layer protocols associated with web traffic to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. 

Protocols such as HTTP/S(Citation: CrowdStrike Putter Panda) and WebSocket(Citation: Brazking-Websockets) that carry web traffic may be very common in environments. HTTP/S packets have many fields and headers in which data can be concealed. An adversary may abuse these protocols to communicate with systems under their control within a victim network while also mimicking normal, expected traffic. ",https://attack.mitre.org/techniques/T1071/001,15 March 2020,11 April 2023,1.1,['Command and Control'],"Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect application layer protocols that do not follow the expected protocol standards regarding syntax, structure, or any other variable adversaries could leverage to conceal data.(Citation: University of Birmingham C2)

Monitor for web traffic to/from known-bad or suspicious domains. ","['Linux', 'Windows', 'macOS']","Network Traffic: Network Traffic Content, Network Traffic: Network Traffic Flow",True,T1071,,TruKno,,,,,,"(Citation: Cybereason Kimsuky November 2020),(Citation: Talos Kimsuky Nov 2021),(Citation: Intezer TeamTNT September 2020),(Citation: CISA ComRAT Oct 2020),(Citation: ESET Nomadic Octopus 2018),(Citation: Kaspersky Turla),(Citation: PWC WellMess C2 August 2020),(Citation: PTSecurity Cobalt Dec 2016),(Citation: Unit 42 NOKKI Sept 2018),(Citation: Checkpoint Dridex Jan 2021),(Citation: Palo Alto menuPass Feb 2017),(Citation: Radware Micropsia July 2018),(Citation: Talos Cobalt Strike September 2020),(Citation: Unit 42 BackConfig May 2020),(Citation: Fidelis INOCNATION),(Citation: FireEye Hacking FIN4 Video Dec 2014),(Citation: FireEye Fin8 May 2016),(Citation: MacKeeper Bundlore Apr 2019),(Citation: RATANKBA),(Citation: Lazarus APT January 2022),(Citation: synack 2016 review),(Citation: Security Intelligence More Eggs Aug 2019),(Citation: Recorded Future REDDELTA July 2020),(Citation: MalwareBytes WoodyRAT Aug 2022),(Citation: Unit 42 Valak July 2020),(Citation: objsee mac malware 2017),(Citation: Proofpoint Operation Transparent Tribe March 2016),(Citation: FireEye APT28),(Citation: Unit42 Xbash Sept 2018),(Citation: FireEye SMOKEDHAM June 2021),(Citation: Anomali Pirate Panda April 2020),(Citation: Mandiant APT1 Appendix),(Citation: Trend Micro Black Basta October 2022),(Citation: Kaspersky Regin),(Citation: McAfee Sharpshooter December 2018),(Citation: Mythc Documentation),(Citation: Unit42 Redaman January 2019),(Citation: ESET Grandoreiro April 2020),(Citation: Forcepoint Felismus Mar 2017),(Citation: Citizen Lab Stealth Falcon May 2016),(Citation: Kaspersky Dridex May 2017),(Citation: Kaspersky QakBot September 2021),(Citation: reed thiefquest ransomware analysis),(Citation: Palo Alto Comnie),(Citation: Securelist APT10 March 2021),(Citation: Symantec Dyre June 2015),(Citation: Malwarebytes SmokeLoader 2016),(Citation: NCC Group APT15 Alive and Strong),(Citation: ThreatStream Evasion Analysis),(Citation: ClearSky Lazarus Aug 2020),(Citation: Secureworks BRONZE PRESIDENT December 2019),(Citation: TrendMicro Taidoor),(Citation: PaloAlto UBoatRAT Nov 2017),(Citation: Kaspersky LuminousMoth July 2021),(Citation: Microsoft HAFNIUM March 2020),(Citation: ESET Turla Mosquito Jan 2018),(Citation: CheckPoint Volatile Cedar March 2015),(Citation: FireEye HAWKBALL Jun 2019),(Citation: ESET Zebrocy Nov 2018),(Citation: DFIR Conti Bazar Nov 2021),(Citation: Trend Micro IXESHE 2012),(Citation: CheckPoint SpeakUp Feb 2019),(Citation: Lab52 WIRTE Apr 2019),(Citation: FireEye Ursnif Nov 2017),(Citation: FireEye FiveHands April 2021),(Citation: Group IB GrimAgent July 2021),(Citation: DigiTrust Agent Tesla Jan 2017),(Citation: Palo Alto Shamoon Nov 2016),(Citation: Profero APT27 December 2020),(Citation: Palo Alto Brute Ratel July 2022),(Citation: JPCert PLEAD Downloader June 2018),(Citation: wardle evilquest partii),(Citation: Talos ZxShell Oct 2014),(Citation: Trend Micro Iron Tiger April 2021),(Citation: Medium Eli Salem GuLoader April 2021),(Citation: Cybereason Chaes Nov 2020),(Citation: F-Secure The Dukes),(Citation: Dell Sakula),(Citation: TrendMicro Ursnif Mar 2015),(Citation: Cisco Talos Bitter Bangladesh May 2022),(Citation: Cybersecurity Advisory GRU Brute Force Campaign July 2021),(Citation: Secureworks REvil September 2019),(Citation: Mandiant UNC3890 Aug 2022),(Citation: PaloAlto CardinalRat Apr 2017),(Citation: Securelist LuckyMouse June 2018),(Citation: SentinelLabs Metador Sept 2022),(Citation: Rancor Unit42 June 2018),(Citation: Lookout Dark Caracal Jan 2018),(Citation: Unit 42 VERMIN Jan 2018),(Citation: GitHub PoshC2),(Citation: FireEye admin@338),(Citation: Palo Alto Gamaredon Feb 2017),(Citation: ESET BackdoorDiplomacy Jun 2021),(Citation: Trend Micro Tick November 2019),(Citation: McAfee Sodinokibi October 2019),(Citation: Trend Micro DRBControl February 2020),(Citation: Trend Micro Muddy Water March 2021),(Citation: FireEye APT10 Sept 2018),(Citation: McAfee Lazarus Nov 2020),(Citation: TrendMicro macOS Dacls May 2020),(Citation: Cybereason OperationCuckooBees May 2022),(Citation: cobaltstrike manual),(Citation: Proofpoint NETWIRE December 2020),(Citation: CrowdStrike StellarParticle January 2022),(Citation: S2 Grupo TrickBot June 2017),(Citation: Trend Micro MacOS Backdoor November 2020),(Citation: Scarlet Mimic Jan 2016),(Citation: F-Secure Cosmicduke),(Citation: Malwarebytes Pony April 2016),(Citation: Talos ROKRAT),(Citation: Malwarebytes Higaisa 2020),(Citation: McAfee GhostSecret),(Citation: 360 Machete Sep 2020),(Citation: FireEye APT38 Oct 2018),(Citation: ESET Casbaneiro Oct 2019),(Citation: Cylance Machete Mar 2017),(Citation: Cisco Talos Intelligence Group),(Citation: Unit 42 PingPull Jun 2022),(Citation: Baumgartner Naikon 2015),(Citation: F-Secure CozyDuke),(Citation: Dell TG-3390),(Citation: Cobalt Strike Manual 4.3 November 2020),(Citation: Cado Security TeamTNT Worm August 2020),(Citation: Trend Micro TeamTNT),(Citation: Unit 42 QUADAGENT July 2018),(Citation: SentinelLabs Metador Technical Appendix Sept 2022),(Citation: Unit 42 BadPatch Oct 2017),(Citation: Lotus Blossom Dec 2015),(Citation: FoxIT Wocao December 2019),(Citation: Kaspersky Carbanak),(Citation: Unit 42 RGDoor Jan 2018),(Citation: NCCGroup RokRat Nov 2018),(Citation: NSA/FBI Drovorub August 2020),(Citation: JPCERT ChChes Feb 2017),(Citation: Malwarebytes Saint Bot April 2021),(Citation: TrendMicro BlackTech June 2017),(Citation: MSTIC Nobelium Toolset May 2021),(Citation: Intezer Doki July 20),(Citation: ESET GreyEnergy Oct 2018),(Citation: FireEye APT34 Webinar Dec 2017),(Citation: Sofacy DealersChoice),(Citation: Proofpoint TA505 Jan 2019),(Citation: Talos PoetRAT October 2020),(Citation: Accenture HyperStack October 2020),(Citation: CrowdStrike Grim Spider May 2019),(Citation: FireEye Know Your Enemy FIN8 Aug 2016),(Citation: Bitdefender StrongPity June 2020),(Citation: Secureworks MCMD July 2019),(Citation: Intrinsec Egregor Nov 2020),(Citation: NTT Security Flagpro new December 2021),(Citation: Secureworks BRONZE BUTLER Oct 2017),(Citation: ESET InvisiMole June 2018),(Citation: JPCert TSCookie March 2018),(Citation: Proofpoint LookBack Malware Aug 2019),(Citation: CrowdStrike Putter Panda),(Citation: Prevailion DarkWatchman 2021),(Citation: FireEye HIKIT Rootkit Part 2),(Citation: Kaspersky Ferocious Kitten Jun 2021),(Citation: Unit 42 OilRig Sept 2018),(Citation: Palo Alto OilRig May 2016),(Citation: Palo Alto Reaver Nov 2017),(Citation: Talos Frankenstein June 2019),(Citation: NCSC Cyclops Blink February 2022),(Citation: FireEye SUNSHUTTLE Mar 2021),(Citation: PaloAlto DNS Requests May 2016),(Citation: Group IB Cobalt Aug 2017),(Citation: Anomali MUSTANG PANDA October 2019),(Citation: Cyphort EvilBunny Dec 2014),(Citation: Talos Promethium June 2020),(Citation: objective-see windtail2 jan 2019),(Citation: JPCert BlackTech Malware September 2019),(Citation: ClearSky Charming Kitten Dec 2017),(Citation: Symantec Orangeworm IOCs April 2018),(Citation: Juniper IcedID June 2020),(Citation: Costa AvosLocker May 2022),(Citation: F-Secure BlackEnergy 2014),(Citation: Cybersecurity Advisory SVR TTP May 2021),(Citation: Kaspersky Lyceum October 2021),(Citation: Unit42 RDAT July 2020),(Citation: ESET Sednit Part 1),(Citation: Kaspersky ProjectSauron Full Report),(Citation: Checkpoint IndigoZebra July 2021),(Citation: Mandiant APT41),(Citation: McAfee Lazarus Resurfaces Feb 2018),(Citation: Kaspersky Cloud Atlas December 2014),(Citation: Github PowerShell Empire),(Citation: Trend Micro Cyclops Blink March 2022),(Citation: CISA SoreFang July 2016),(Citation: Talos Micropsia June 2017),(Citation: ESET Turla Mosquito May 2018),(Citation: MSTIC FoggyWeb September 2021),(Citation: Fortinet Agent Tesla June 2017),(Citation: Symantec Remsec IOCs),(Citation: FireEye FELIXROOT July 2018),(Citation: Kaspersky WIRTE November 2021),(Citation: FireEye Hacking FIN4 Dec 2014),(Citation: Unit 42 Magic Hound Feb 2017),(Citation: KISA Operation Muzabi),(Citation: Zscaler Higaisa 2020),(Citation: DFIR Phosphorus November 2021),(Citation: MalwareBytes SideCopy Dec 2021),(Citation: NCC Group Chimera January 2021),(Citation: Malwarebytes RokRAT VBA January 2021),(Citation: Antiy CERT Ramsay April 2020),(Citation: Unit 42 NETWIRE April 2020),(Citation: McAfee Bankshot),(Citation: McAfee Night Dragon),(Citation: BlackBerry Bahamut),(Citation: ProofPoint Ursnif Aug 2016),(Citation: Talos TinyTurla September 2021),(Citation: Secureworks GandCrab and REvil September 2019),(Citation: Unit42 SUPERNOVA Dec 2020),(Citation: US-CERT BLINDINGCAN Aug 2020),(Citation: Rewterz Sidewinder COVID-19 June 2020),(Citation: Infoblox Lokibot January 2019),(Citation: Unit42 Molerat Mar 2020),(Citation: CERT-EE Gamaredon January 2021),(Citation: NorthSec 2015 GData Uroburos Tools),(Citation: Bishop Fox Sliver Framework August 2019),(Citation: FOX-IT May 2016 Mofang),(Citation: ESET TeleBots Oct 2018),(Citation: Cybereason Bazar July 2020),(Citation: Palo Alto Sofacy 06-2018),(Citation: ESET Crutch December 2020),(Citation: Talos Konni May 2017),(Citation: Volexity InkySquid BLUELIGHT August 2021),(Citation: Unit42 Emissary Panda May 2019),(Citation: Unit 42 MechaFlounder March 2019),(Citation: FireEye APT30),(Citation: Unit 42 Nokki Oct 2018),(Citation: TrendMicro TropicTrooper 2015),(Citation: CYBERCOM Iranian Intel Cyber January 2022),(Citation: Microsoft GALLIUM December 2019),(Citation: CrowdStrike IceApple May 2022),(Citation: Unit42 Cannon Nov 2018),(Citation: ESET Gelsemium June 2021),(Citation: Unit 42 Gamaredon February 2022),(Citation: TrendMicro Tropic Trooper May 2020),(Citation: TrendMicro Gamaredon April 2020),(Citation: Proofpoint TA416 Europe March 2022),(Citation: Unit 42 C0d0so0 Jan 2016),(Citation: ClearSky Siamesekitten August 2021),(Citation: Securelist Remexi Jan 2019),(Citation: Microsoft Actinium February 2022),(Citation: Unit 42 Playbook Dec 2017),(Citation: Microsoft POLONIUM June 2022),(Citation: McAfee Lazarus Jul 2020),(Citation: Symantec Elfin Mar 2019),(Citation: Malwarebytes Kimsuky June 2021),(Citation: ObjectiveSee AppleJeus 2019),(Citation: Trusteer Carberp October 2010),(Citation: Cyberreason Anchor December 2019),(Citation: FireEye EPS Awakens Part 2),(Citation: Talos GravityRAT),(Citation: McAfee Dianxun March 2021),(Citation: Red Canary NETWIRE January 2020),(Citation: Unit42 SilverTerrier 2018),(Citation: Unit42 OilRig Playbook 2023),(Citation: ESET Twitter Ida Pro Nov 2021),(Citation: ClearSky MuddyWater June 2019),(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ),(Citation: Trend Micro njRAT 2018),(Citation: SentinelOne Lazarus macOS July 2020),(Citation: NCSC APT29 July 2020),(Citation: Malwarebytes DarkComet March 2018),(Citation: Unit42 Sofacy Dec 2018),(Citation: DFIR Report APT35 ProxyShell March 2022),(Citation: Palo Alto Networks BBSRAT),(Citation: Proofpoint TA505 Mar 2018),(Citation: CISA AppleJeus Feb 2021),(Citation: Kaspersky Turla Aug 2014),(Citation: Kaspersky ProjectSauron Technical Analysis),(Citation: Microsoft PLATINUM April 2016),(Citation: Check Point APT34 April 2021),(Citation: Microsoft NICKEL December 2021),(Citation: MalwareBytes LazyScripter Feb 2021),(Citation: Trend Micro Qakbot May 2020),(Citation: ZScaler Squirrelwaffle Sep 2021),(Citation: SentinelOne Aoqin Dragon June 2022),(Citation: ESET Zebrocy May 2019),(Citation: Securelist Octopus Oct 2018),(Citation: GitHub Sliver C2),(Citation: Talos Group123),(Citation: Talos Lokibot Jan 2021),(Citation: ESET Machete July 2019),(Citation: McAfee Gold Dragon),(Citation: Accenture Lyceum Targets November 2021),(Citation: ESET Gamaredon June 2020),(Citation: Donut Github),(Citation: Cylance Dust Storm),(Citation: Kaspersky ShadowPad Aug 2017),(Citation: Volexity SolarWinds),(Citation: IBM Grandoreiro April 2020),(Citation: FireEye APT41 March 2020),(Citation: FireEye APT29 Nov 2018),(Citation: DustySky),(Citation: Accenture Hogfish April 2018),(Citation: Bitdefender FIN8 July 2021),(Citation: Lotus Blossom Jun 2015),(Citation: Microsoft SIR Vol 19),(Citation: Unit 42 Sofacy Feb 2018),(Citation: Lazarus RATANKBA),(Citation: ESET Dukes October 2019),(Citation: FireEye APT19),(Citation: ANSSI Sandworm January 2021),(Citation: Cybereason Cobalt Kitty 2017),(Citation: Accenture SNAKEMACKEREL Nov 2018),(Citation: Symantec Vasport May 2012),(Citation: Malwarebytes Konni Aug 2021),(Citation: Talos Cobalt Group July 2018),(Citation: Kaspersky CactusPete Aug 2020),(Citation: Proofpoint ZeroT Feb 2017),(Citation: BlackBerry Amadey 2020),(Citation: FireEye APT10 April 2017),(Citation: Nicolas Falliere, Liam O Murchu, Eric Chien February 2011),(Citation: Volexity OceanLotus Nov 2017),(Citation: FBI FLASH APT39 September 2020),(Citation: Kaspersky Sofacy),(Citation: CISA WellMess July 2020),(Citation: Anomali Rocke March 2019),(Citation: Bitdefender Naikon April 2021),(Citation: FireEye APT34 July 2019),(Citation: Unit 42 WhisperGate January 2022),(Citation: ESET Okrum July 2019),(Citation: DHS CISA AA22-055A MuddyWater February 2022),(Citation: Secureworks Karagany July 2019),(Citation: HP SVCReady Jun 2022),(Citation: Kaspersky Cloud Atlas August 2019),(Citation: Trustwave GoldenSpy June 2020),(Citation: Proofpoint TA505 October 2019),(Citation: Talos Zeus Panda Nov 2017),(Citation: Chronicle Winnti for Linux May 2019),(Citation: Cybereason Valak May 2020),(Citation: Novetta Winnti April 2015),(Citation: Aqua Kinsing April 2020),(Citation: ATT Sidewinder January 2021),(Citation: FireEye APT34 Dec 2017),(Citation: FireEye APT29),(Citation: Kaspersky Tomiris Sep 2021),(Citation: Secureworks DarkTortilla Aug 2022),(Citation: Bitdefender FunnyDream Campaign November 2020),(Citation: ESET ComRAT May 2020),(Citation: Uptycs Confucius APT Jan 2021),(Citation: GitHub Pupy),(Citation: MSTIC NOBELIUM Mar 2021),(Citation: ESET Gazer Aug 2017),(Citation: Check Point APT35 CharmPower January 2022),(Citation: Sofacy Komplex Trojan),(Citation: FireEye APT33 Guardrail),(Citation: ESET Telebots Dec 2016),(Citation: IBM TA505 April 2020),(Citation: Morphisec ShellTea June 2019),(Citation: Symantec Shuckworm January 2022),(Citation: ESET Sednit Part 2),(Citation: Medium Metamorfo Apr 2020),(Citation: Forcepoint BITTER Pakistan Oct 2016),(Citation: CISA MAR SLOTHFULMEDIA October 2020),(Citation: Cylance Sodinokibi July 2019),(Citation: Fortinet Diavol July 2021),(Citation: Proofpoint TA459 April 2017),(Citation: McAfee Maze March 2020),(Citation: Mandiant UNC3313 Feb 2022),(Citation: Unit 42 Bisonal July 2018),(Citation: Unit 42 Kazuar May 2017),(Citation: Unit 42 OopsIE! Feb 2018),(Citation: PWC WellMess July 2020),(Citation: PaloAlto Patchwork Mar 2018),(Citation: NCC Group Team9 June 2020),(Citation: Intel 471 REvil March 2020),(Citation: Unit 42 Inception November 2018),(Citation: FireEye Periscope March 2018),(Citation: Moran 2013),(Citation: FireEye SUNBURST Backdoor December 2020),(Citation: CheckPoint Naikon May 2020),(Citation: Qualys LolZarus),(Citation: Rewterz Sidewinder APT April 2020),(Citation: Medium S2W WhisperGate January 2022),(Citation: SecureWorks August 2019),(Citation: ESET Industroyer),(Citation: Crowdstrike Qakbot October 2020),(Citation: Moran 2014),(Citation: BitDefender Chafer May 2020),(Citation: Guidepoint SUPERNOVA Dec 2020),(Citation: Malwarebytes Dyreza November 2015),","['actor', 'process', 'data flow']","[{'mitigation id': 'M1031', 'mitigation name': 'Network Intrusion Prevention', 'mitigation description': 'Use intrusion detection signatures to block traffic at network boundaries.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1031'}]"
T1071.002,Application Layer Protocol: File Transfer Protocols,"Adversaries may communicate using application layer protocols associated with transferring files to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. 

Protocols such as FTP, FTPS, and TFTP that transfer files may be very common in environments.  Packets produced from these protocols may have many fields and headers in which data can be concealed. Data could also be concealed within the transferred files. An adversary may abuse these protocols to communicate with systems under their control within a victim network while also mimicking normal, expected traffic. ",https://attack.mitre.org/techniques/T1071/002,15 March 2020,21 August 2020,1.0,['Command and Control'],"Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect application layer protocols that do not follow the expected protocol for the port that is being used.(Citation: University of Birmingham C2)","['Linux', 'Windows', 'macOS']","Network Traffic: Network Traffic Content, Network Traffic: Network Traffic Flow",True,T1071,,,,,,,,"(Citation: Mythc Documentation),(Citation: XAgentOSX 2017),(Citation: McAfee Honeybee),(Citation: Unit 42 CARROTBAT November 2018),(Citation: Talos ZxShell Oct 2014),(Citation: ESET Machete July 2019),(Citation: Unit 42 Kazuar May 2017),(Citation: ESET Attor Oct 2019),(Citation: 360 Machete Sep 2020),(Citation: FireEye APT41 March 2020),(Citation: VirusBulletin Kimsuky October 2019),(Citation: Talos PoetRAT October 2020),(Citation: Microsoft PLATINUM April 2016),(Citation: Cylance Machete Mar 2017),(Citation: Kaspersky ShadowPad Aug 2017),(Citation: Unit 42 NOKKI Sept 2018),(Citation: Unit42 SilverTerrier 2018),(Citation: Unit 42 CARROTBAT January 2020),","['actor', 'process', 'data flow']","[{'mitigation id': 'M1031', 'mitigation name': 'Network Intrusion Prevention', 'mitigation description': 'Use intrusion detection signatures to block traffic at network boundaries.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1031'}]"
T1071.003,Application Layer Protocol: Mail Protocols,"Adversaries may communicate using application layer protocols associated with electronic mail delivery to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. 

Protocols such as SMTP/S, POP3/S, and IMAP that carry electronic mail may be very common in environments.  Packets produced from these protocols may have many fields and headers in which data can be concealed. Data could also be concealed within the email messages themselves. An adversary may abuse these protocols to communicate with systems under their control within a victim network while also mimicking normal, expected traffic. ",https://attack.mitre.org/techniques/T1071/003,15 March 2020,21 October 2020,1.0,['Command and Control'],"Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect application layer protocols that do not follow the expected protocol standards regarding syntax, structure, or any other variable adversaries could leverage to conceal data.(Citation: University of Birmingham C2)","['Linux', 'Windows', 'macOS']","Network Traffic: Network Traffic Content, Network Traffic: Network Traffic Flow",True,T1071,,,,,,,,"(Citation: Palo Alto Sofacy 06-2018),(Citation: Fortinet Agent Tesla June 2017),(Citation: Crowdstrike GTR2020 Mar 2020),(Citation: Microsoft SIR Vol 19),(Citation: DigiTrust Agent Tesla Jan 2017),(Citation: CISA AA20-301A Kimsuky),(Citation: Unit 42 BadPatch Oct 2017),(Citation: Kaspersky ProjectSauron Technical Analysis),(Citation: Symantec Remsec IOCs),(Citation: Microsoft PLATINUM April 2016),(Citation: ESET Sednit Part 2),(Citation: Unit42 Cannon Nov 2018),(Citation: FireEye APT28),(Citation: Cybereason Cobalt Kitty 2017),(Citation: Accenture SNAKEMACKEREL Nov 2018),(Citation: Cybereason Oceanlotus May 2017),(Citation: ESET LightNeuron May 2019),(Citation: ESET Zebrocy May 2019),(Citation: Unit42 SilverTerrier 2018),(Citation: Unit42 RDAT July 2020),(Citation: Mandiant UNC3890 Aug 2022),(Citation: Cybersecurity Advisory GRU Brute Force Campaign July 2021),(Citation: Talos NavRAT May 2018),(Citation: Kaspersky ProjectSauron Full Report),(Citation: ESET Zebrocy Nov 2018),(Citation: Bitdefender Agent Tesla April 2020),(Citation: Unit42 Sofacy Dec 2018),(Citation: ESET ComRAT May 2020),","['actor', 'process', 'data flow']","[{'mitigation id': 'M1031', 'mitigation name': 'Network Intrusion Prevention', 'mitigation description': 'Use intrusion detection signatures to block traffic at network boundaries.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1031'}]"
T1071.004,Application Layer Protocol: DNS,"Adversaries may communicate using the Domain Name System (DNS) application layer protocol to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. 

The DNS protocol serves an administrative function in computer networking and thus may be very common in environments. DNS traffic may also be allowed even before network authentication is completed. DNS packets contain many fields and headers in which data can be concealed. Often known as DNS tunneling, adversaries may abuse DNS to communicate with systems under their control within a victim network while also mimicking normal, expected traffic.(Citation: PAN DNS Tunneling)(Citation: Medium DnsTunneling) ",https://attack.mitre.org/techniques/T1071/004,15 March 2020,17 June 2022,1.1,['Command and Control'],"Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect application layer protocols that do not follow the expected protocol standards regarding syntax, structure, or any other variable adversaries could leverage to conceal data.(Citation: University of Birmingham C2)

Monitor for DNS traffic to/from known-bad or suspicious domains.","['Linux', 'Windows', 'macOS']","Network Traffic: Network Traffic Content, Network Traffic: Network Traffic Flow",True,T1071,,"Chris Heald; Jan Petrov, Citi",,,,,,"(Citation: ESET Ebury Feb 2014),(Citation: FireEye FiveHands April 2021),(Citation: PaloAlto DNS Requests May 2016),(Citation: Group IB Cobalt Aug 2017),(Citation: Zscaler Lyceum DnsSystem June 2022),(Citation: Unit 42 QUADAGENT July 2018),(Citation: PWC WellMess July 2020),(Citation: FireEye APT34 July 2019),(Citation: Kaspersky ProjectSauron Technical Analysis),(Citation: FireEye FIN7 Aug 2018),(Citation: ESET InvisiMole June 2020),(Citation: NCC Group APT15 Alive and Strong),(Citation: Cyberreason Anchor December 2019),(Citation: Palo Alto Brute Ratel July 2022),(Citation: Palo Alto DNS Requests),(Citation: Symantec Remsec IOCs),(Citation: ThreatStream Evasion Analysis),(Citation: DHS CISA AA22-055A MuddyWater February 2022),(Citation: cobaltstrike manual),(Citation: Check Point APT34 April 2021),(Citation: CYBERCOM Iranian Intel Cyber January 2022),(Citation: Medium Anchor DNS July 2020),(Citation: Group IB APT 41 June 2021),(Citation: MalwareBytes LazyScripter Feb 2021),(Citation: ESET Gelsemium June 2021),(Citation: Cybereason Cobalt Kitty 2017),(Citation: FireEye SUNBURST Backdoor December 2020),(Citation: TrendMicro Tropic Trooper May 2020),(Citation: Cybereason Oceanlotus May 2017),(Citation: SentinelOne Aoqin Dragon June 2022),(Citation: fsecure nullHaiShu July 2016),(Citation: Talos Cobalt Group July 2018),(Citation: Zscaler Cobian Aug 2017),(Citation: CopyKittens Nov 2015),(Citation: NCC Group Chimera January 2021),(Citation: Glitch-Cat Green Lambert ATTCK Oct 2021),(Citation: Unit42 OilRig Playbook 2023),(Citation: Palo Alto OilRig Sep 2018),(Citation: SecureWorks August 2019),(Citation: Cisco DNSMessenger March 2017),(Citation: Objective See Green Lambert for OSX Oct 2021),(Citation: Cybersecurity Advisory SVR TTP May 2021),(Citation: Kaspersky Lyceum October 2021),(Citation: Unit42 RDAT July 2020),(Citation: PTSecurity Cobalt Dec 2016),(Citation: Trend Micro Black Basta October 2022),(Citation: Accenture Lyceum Targets November 2021),(Citation: BlackBerry CostaRicto November 2020),(Citation: FireEye APT34 Dec 2017),(Citation: FireEye APT41 Aug 2019),(Citation: FireEye FIN7 March 2017),(Citation: ClearSky Siamesekitten August 2021),(Citation: Mythc Documentation),(Citation: FireEye APT34 Webinar Dec 2017),(Citation: Kaspersky ProjectSauron Full Report),(Citation: Dell TG-3390),(Citation: BitDefender Chafer May 2020),(Citation: FireEye APT32 May 2017),(Citation: Lunghi Iron Tiger Linux),(Citation: NCSC APT29 July 2020),(Citation: ClearSky Wilted Tulip July 2017),(Citation: Cobalt Strike Manual 4.3 November 2020),(Citation: Palo Alto OilRig May 2016),(Citation: Talos Cobalt Strike September 2020),(Citation: Bishop Fox Sliver Framework August 2019),(Citation: GitHub Sliver C2 DNS),(Citation: Securelist Denis April 2017),(Citation: Kaspersky ShadowPad Aug 2017),","['actor', 'process', 'data flow']","[{'mitigation id': 'M1031', 'mitigation name': 'Network Intrusion Prevention', 'mitigation description': 'Use intrusion detection signatures to block traffic at network boundaries.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1031'}, {'mitigation id': 'M1037', 'mitigation name': 'Filter Network Traffic', 'mitigation description': 'Use network appliances to filter ingress or egress traffic and perform protocol-based filtering. Configure software on endpoints to filter network traffic.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1037'}]"
T1090,Proxy,"Adversaries may use a connection proxy to direct network traffic between systems or act as an intermediary for network communications to a command and control server to avoid direct connections to their infrastructure. Many tools exist that enable traffic redirection through proxies or port redirection, including [HTRAN](https://attack.mitre.org/software/S0040), ZXProxy, and ZXPortMap. (Citation: Trend Micro APT Attack Tools) Adversaries use these types of proxies to manage command and control communications, reduce the number of simultaneous outbound network connections, provide resiliency in the face of connection loss, or to ride over existing trusted communications paths between victims to avoid suspicion. Adversaries may chain together multiple proxies to further disguise the source of malicious traffic.

Adversaries can also take advantage of routing schemes in Content Delivery Networks (CDNs) to proxy command and control traffic.",https://attack.mitre.org/techniques/T1090,31 May 2017,30 August 2021,3.1,['Command and Control'],"Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server or between clients that should not or often do not communicate with one another). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2)

Consider monitoring for traffic to known anonymity networks (such as [Tor](https://attack.mitre.org/software/S0183)).","['Linux', 'Network', 'Windows', 'macOS']","Network Traffic: Network Connection Creation, Network Traffic: Network Traffic Content, Network Traffic: Network Traffic Flow",False,,[],Heather Linn; Jon Sheedy; Walker Johnson,,,,,,"(Citation: US-CERT HARDRAIN March 2018),(Citation: Bitdefender Naikon April 2021),(Citation: ESET Windigo Mar 2014),(Citation: GitHub QuasarRAT),(Citation: Microsoft POLONIUM June 2022),(Citation: Kaspersky Adwind Feb 2016),(Citation: Operation Quantum Entanglement),(Citation: Dell Dridex Oct 2015),(Citation: Check Point Pay2Key November 2020),(Citation: Crowdstrike DNC June 2016),(Citation: CISA AA20-259A Iran-Based Actor September 2020),(Citation: ClearSky Pay2Kitten December 2020),(Citation: JPCert PLEAD Downloader June 2018),(Citation: ESET Telebots Dec 2016),(Citation: Riskiq Remcos Jan 2018),(Citation: US-CERT HOPLIGHT Apr 2019),(Citation: TrendMicro EarthLusca 2022),(Citation: Talos ZxShell Oct 2014),(Citation: JPCert BlackTech Malware September 2019),(Citation: ESET Turla PowerShell May 2019),(Citation: MalwareBytes LazyScripter Feb 2021),(Citation: FoxIT Wocao December 2019),(Citation: CheckPoint Naikon May 2020),(Citation: Zdnet Ngrok September 2018),(Citation: ESET ForSSHe December 2018),(Citation: DFIR Phosphorus November 2021),(Citation: Symantec Vasport May 2012),(Citation: Glitch-Cat Green Lambert ATTCK Oct 2021),(Citation: Red Canary NETWIRE January 2020),(Citation: MalwareBytes Ngrok February 2020),(Citation: Proofpoint TA505 October 2019),(Citation: CISA AR21-126A FIVEHANDS May 2021),(Citation: US-CERT TYPEFRAME June 2018),(Citation: Securelist fileless attacks Feb 2017),(Citation: US-CERT BADCALL),(Citation: Objective See Green Lambert for OSX Oct 2021),(Citation: PaloAlto CardinalRat Apr 2017),(Citation: Check Point Warzone Feb 2020),(Citation: Volexity Patchwork June 2018),(Citation: MSTIC DEV-0537 Mar 2022),(Citation: TrendMicro Lazarus Nov 2018),(Citation: FireEye APT41 Aug 2019),(Citation: Mandiant APT41),(Citation: ProofPoint Ursnif Aug 2016),(Citation: RedCanary Mockingbird May 2020),(Citation: NCSC Joint Report Public Tools),(Citation: Checkpoint Dridex Jan 2021),(Citation: Talos Bisonal Mar 2020),(Citation: GitHub PoshC2),(Citation: NJCCIC Ursnif Sept 2016),(Citation: TrendMicro Patchwork Dec 2017),(Citation: Bitdefender FunnyDream Campaign November 2020),(Citation: Bleeping Computer Op Sharpshooter March 2019),(Citation: University of Birmingham C2)","['actor', 'process', 'data flow']","[{'mitigation id': 'M1020', 'mitigation name': 'SSL/TLS Inspection', 'mitigation description': 'Break and inspect SSL/TLS sessions to look at encrypted web traffic for adversary activity.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1020'}, {'mitigation id': 'M1031', 'mitigation name': 'Network Intrusion Prevention', 'mitigation description': 'Use intrusion detection signatures to block traffic at network boundaries.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1031'}, {'mitigation id': 'M1037', 'mitigation name': 'Filter Network Traffic', 'mitigation description': 'Use network appliances to filter ingress or egress traffic and perform protocol-based filtering. Configure software on endpoints to filter network traffic.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1037'}]"
T1090.001,Proxy: Internal Proxy,"Adversaries may use an internal proxy to direct command and control traffic between two or more systems in a compromised environment. Many tools exist that enable traffic redirection through proxies or port redirection, including [HTRAN](https://attack.mitre.org/software/S0040), ZXProxy, and ZXPortMap. (Citation: Trend Micro APT Attack Tools) Adversaries use internal proxies to manage command and control communications inside a compromised environment, to reduce the number of simultaneous outbound network connections, to provide resiliency in the face of connection loss, or to ride over existing trusted communications paths between infected systems to avoid suspicion. Internal proxy connections may use common peer-to-peer (p2p) networking protocols, such as SMB, to better blend in with the environment.

By using a compromised internal system as a proxy, adversaries may conceal the true destination of C2 traffic while reducing the need for numerous connections to external systems.",https://attack.mitre.org/techniques/T1090/001,14 March 2020,15 March 2020,1.0,['Command and Control'],Analyze network data for uncommon data flows between clients that should not or often do not communicate with one another. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2),"['Linux', 'Windows', 'macOS']","Network Traffic: Network Connection Creation, Network Traffic: Network Traffic Content, Network Traffic: Network Traffic Flow",True,T1090,,,,,,,,"(Citation: Kaspersky ProjectSauron Blog),(Citation: SentinelLabs Metador Technical Appendix Sept 2022),(Citation: Check Point Pay2Key November 2020),(Citation: FireEye APT30),(Citation: ESET Dukes October 2019),(Citation: cobaltstrike manual),(Citation: ESET Sednit Part 2),(Citation: CrowdStrike StellarParticle January 2022),(Citation: FoxIT Wocao December 2019),(Citation: Symantec W32.Duqu),(Citation: Kaspersky ThreatNeedle Feb 2021),(Citation: Zscaler Higaisa 2020),(Citation: NSA/FBI Drovorub August 2020),(Citation: ESET InvisiMole June 2018),(Citation: Symantec RAINDROP January 2021),(Citation: Novetta Winnti April 2015),(Citation: Novetta-Axiom),(Citation: Mythc Documentation),(Citation: BitDefender Chafer May 2020),(Citation: FireEye APT39 Jan 2019),(Citation: Talos TinyTurla September 2021),(Citation: Nicolas Falliere, Liam O Murchu, Eric Chien February 2011),(Citation: Cobalt Strike Manual 4.3 November 2020),(Citation: ClearkSky Fox Kitten February 2020),(Citation: Accenture HyperStack October 2020),(Citation: University of Birmingham C2)","['actor', 'process', 'data flow']","[{'mitigation id': 'M1031', 'mitigation name': 'Network Intrusion Prevention', 'mitigation description': 'Use intrusion detection signatures to block traffic at network boundaries.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1031'}]"
T1090.002,Proxy: External Proxy,"Adversaries may use an external proxy to act as an intermediary for network communications to a command and control server to avoid direct connections to their infrastructure. Many tools exist that enable traffic redirection through proxies or port redirection, including [HTRAN](https://attack.mitre.org/software/S0040), ZXProxy, and ZXPortMap. (Citation: Trend Micro APT Attack Tools) Adversaries use these types of proxies to manage command and control communications, to provide resiliency in the face of connection loss, or to ride over existing trusted communications paths to avoid suspicion.

External connection proxies are used to mask the destination of C2 traffic and are typically implemented with port redirectors. Compromised systems outside of the victim environment may be used for these purposes, as well as purchased infrastructure such as cloud-based resources or virtual private servers. Proxies may be chosen based on the low likelihood that a connection to them from a compromised system would be investigated. Victim systems would communicate directly with the external proxy on the Internet and then the proxy would forward communications to the C2 server.",https://attack.mitre.org/techniques/T1090/002,14 March 2020,27 March 2020,1.0,['Command and Control'],"Analyze network data for uncommon data flows, such as a client sending significantly more data than it receives from an external server. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)","['Linux', 'Windows', 'macOS']","Network Traffic: Network Connection Creation, Network Traffic: Network Traffic Content, Network Traffic: Network Traffic Flow",True,T1090,,,,,,,,"(Citation: Trend Micro Muddy Water March 2021),(Citation: FireEye APT10 Sept 2018),(Citation: ESET InvisiMole June 2020),(Citation: ESET Okrum July 2019),(Citation: TrendMicro macOS Dacls May 2020),(Citation: Bitdefender Trickbot C2 infra Nov 2020),(Citation: Symantec MuddyWater Dec 2018),(Citation: DOJ GRU Indictment Jul 2018),(Citation: FireEye APT28),(Citation: FireEye Operation Double Tap),(Citation: TrendMicro Tonto Team October 2020),(Citation: ESET InvisiMole June 2018),(Citation: Reaqta MuddyWater November 2017),(Citation: Bitdefender APT28 Dec 2015),(Citation: Cybereason Soft Cell June 2019),(Citation: US-CERT FALLCHILL Nov 2017),(Citation: Novetta Winnti April 2015),(Citation: Kaspersky Regin),(Citation: FireEye APT10 April 2017),(Citation: Mythc Documentation),(Citation: BitDefender Chafer May 2020),(Citation: Mandiant FIN5 GrrCON Oct 2016),(Citation: FireEye MuddyWater Mar 2018),(Citation: FOX-IT May 2016 Mofang),(Citation: Bitdefender Trickbot VNC module Whitepaper 2021),(Citation: Group IB Silence Sept 2018),(Citation: Kaspersky QakBot September 2021),(Citation: University of Birmingham C2)","['actor', 'process', 'data flow']","[{'mitigation id': 'M1031', 'mitigation name': 'Network Intrusion Prevention', 'mitigation description': 'Use intrusion detection signatures to block traffic at network boundaries.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1031'}]"
T1090.003,Proxy: Multi-hop Proxy,"To disguise the source of malicious traffic, adversaries may chain together multiple proxies. Typically, a defender will be able to identify the last proxy traffic traversed before it enters their network; the defender may or may not be able to identify any previous proxies before the last-hop proxy. This technique makes identifying the original source of the malicious traffic even more difficult by requiring the defender to trace malicious traffic through several proxies to identify its source. A particular variant of this behavior is to use onion routing networks, such as the publicly available TOR network. (Citation: Onion Routing)

In the case of network infrastructure, particularly routers, it is possible for an adversary to leverage multiple compromised devices to create a multi-hop proxy chain within the Wide-Area Network (WAN) of the enterprise.  By leveraging [Patch System Image](https://attack.mitre.org/techniques/T1601/001), adversaries can add custom code to the affected network devices that will implement onion routing between those nodes.  This custom onion routing network will transport the encrypted C2 traffic through the compromised population, allowing adversaries to communicate with any device within the onion routing network.  This method is dependent upon the [Network Boundary Bridging](https://attack.mitre.org/techniques/T1599) method in order to allow the adversaries to cross the protected network boundary of the Internet perimeter and into the organization’s WAN. Protocols such as ICMP may be used as a transport.",https://attack.mitre.org/techniques/T1090/003,14 March 2020,21 October 2020,2.0,['Command and Control'],"When observing use of Multi-hop proxies, network data from the actual command and control servers could allow correlating incoming and outgoing flows to trace malicious traffic back to its source. Multi-hop proxies can also be detected by alerting on traffic to known anonymity networks (such as [Tor](https://attack.mitre.org/software/S0183)) or known adversary infrastructure that uses this technique.

In context of network devices, monitor traffic for encrypted communications from the Internet that is addressed to border routers.  Compare this traffic with the configuration to determine whether it matches with any configured site-to-site Virtual Private Network (VPN) connections the device was intended to have. Monitor traffic for encrypted communications originating from potentially breached routers that is addressed to other routers within the organization.  Compare the source and destination with the configuration of the device to determine if these channels are an authorized Virtual Private Network (VPN) connections or other encrypted modes of communication. Monitor ICMP traffic from the Internet that is addressed to border routers and is encrypted.  Few if any legitimate use cases exist for sending encrypted data to a network device via ICMP.","['Linux', 'Network', 'Windows', 'macOS']","Network Traffic: Network Connection Creation, Network Traffic: Network Traffic Content, Network Traffic: Network Traffic Flow",True,T1090,,,,,,,,"(Citation: synack 2016 review),(Citation: ESET Kobalos Feb 2021),(Citation: Bitdefender StrongPity June 2020),(Citation: Symantec Inception Framework March 2018),(Citation: objsee mac malware 2017),(Citation: FireEye Hacking FIN4 Dec 2014),(Citation: FoxIT Wocao December 2019),(Citation: Dragos Crashoverride 2017),(Citation: TrendMicro Pawn Storm Dec 2020),(Citation: ESET Kobalos Jan 2021),(Citation: NCSC CISA Cyclops Blink Advisory February 2022),(Citation: ESET Attor Oct 2019),(Citation: SecureWorks WannaCry Analysis),(Citation: BlackBerry CostaRicto November 2020),(Citation: ESET GreyEnergy Oct 2018),(Citation: MSTIC Nobelium Oct 2021),(Citation: ProofPoint Ursnif Aug 2016),(Citation: Checkpoint Dridex Jan 2021),(Citation: CISA AA21-200A APT40 July 2021),(Citation: NJCCIC Ursnif Sept 2016),(Citation: Mandiant No Easy Breach),(Citation: Unit 42 Siloscape Jun 2021),(Citation: Dingledine Tor The Second-Generation Onion Router),","['actor', 'process', 'data flow']","[{'mitigation id': 'M1037', 'mitigation name': 'Filter Network Traffic', 'mitigation description': 'Use network appliances to filter ingress or egress traffic and perform protocol-based filtering. Configure software on endpoints to filter network traffic.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1037'}]"
T1090.004,Proxy: Domain Fronting,"Adversaries may take advantage of routing schemes in Content Delivery Networks (CDNs) and other services which host multiple domains to obfuscate the intended destination of HTTPS traffic or traffic tunneled through HTTPS. (Citation: Fifield Blocking Resistent Communication through domain fronting 2015) Domain fronting involves using different domain names in the SNI field of the TLS header and the Host field of the HTTP header. If both domains are served from the same CDN, then the CDN may route to the address specified in the HTTP header after unwrapping the TLS header. A variation of the the technique, ""domainless"" fronting, utilizes a SNI field that is left blank; this may allow the fronting to work even when the CDN attempts to validate that the SNI and HTTP Host fields match (if the blank SNI fields are ignored).

For example, if domain-x and domain-y are customers of the same CDN, it is possible to place domain-x in the TLS header and domain-y in the HTTP header. Traffic will appear to be going to domain-x, however the CDN may route it to domain-y.",https://attack.mitre.org/techniques/T1090/004,14 March 2020,30 March 2023,1.1,['Command and Control'],"If SSL inspection is in place or the traffic is not encrypted, the Host field of the HTTP header can be checked if it matches the HTTPS SNI or against a blocklist or allowlist of domain names. (Citation: Fifield Blocking Resistent Communication through domain fronting 2015)","['Linux', 'Windows', 'macOS']",Network Traffic: Network Traffic Content,True,T1090,,"Matt Kelly, @breakersall",,,,,,"(Citation: Cobalt Strike Manual 4.3 November 2020),(Citation: FireEye SMOKEDHAM June 2021),(Citation: Mandiant No Easy Breach),(Citation: Mythc Documentation),","['actor', 'process', 'data flow']","[{'mitigation id': 'M1020', 'mitigation name': 'SSL/TLS Inspection', 'mitigation description': 'Break and inspect SSL/TLS sessions to look at encrypted web traffic for adversary activity.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1020'}]"
T1092,Communication Through Removable Media,"Adversaries can perform command and control between compromised hosts on potentially disconnected networks using removable media to transfer commands from system to system. Both systems would need to be compromised, with the likelihood that an Internet-connected system was compromised first and the second through lateral movement by [Replication Through Removable Media](https://attack.mitre.org/techniques/T1091). Commands and files would be relayed from the disconnected system to the Internet-connected system to which the adversary has direct access.",https://attack.mitre.org/techniques/T1092,31 May 2017,14 July 2020,1.0,['Command and Control'],Monitor file access on removable media. Detect processes that execute when removable media is mounted.,"['Linux', 'Windows', 'macOS']","Drive: Drive Access, Drive: Drive Creation",False,,[],,,,,,,"(Citation: ESET Sednit Part 2),(Citation: Microsoft SIR Vol 19),(Citation: ESET Sednit USBStealer 2014),(Citation: FireEye APT28),(Citation: TechNet Removable Media Control),(Citation: Microsoft Disable Autorun)","['actor', 'process', 'data flow']","[{'mitigation id': 'M1028', 'mitigation name': 'Operating System Configuration', 'mitigation description': 'Make configuration changes related to the operating system or a common feature of the operating system that result in system hardening against techniques.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1028'}, {'mitigation id': 'M1042', 'mitigation name': 'Disable or Remove Feature or Program', 'mitigation description': 'Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1042'}]"
T1095,Non-Application Layer Protocol,"Adversaries may use an OSI non-application layer protocol for communication between host and C2 server or among infected hosts within a network. The list of possible protocols is extensive.(Citation: Wikipedia OSI) Specific examples include use of network layer protocols, such as the Internet Control Message Protocol (ICMP), transport layer protocols, such as the User Datagram Protocol (UDP), session layer protocols, such as Socket Secure (SOCKS), as well as redirected/tunneled protocols, such as Serial over LAN (SOL).

ICMP communication between hosts is one example.(Citation: Cisco Synful Knock Evolution) Because ICMP is part of the Internet Protocol Suite, it is required to be implemented by all IP-compatible hosts.(Citation: Microsoft ICMP) However, it is not as commonly monitored as other Internet Protocols such as TCP or UDP and may be used by adversaries to hide communications.",https://attack.mitre.org/techniques/T1095,31 May 2017,20 April 2023,2.2,['Command and Control'],"Analyze network traffic for ICMP messages or other protocols that contain abnormal data or are not normally seen within or exiting the network.(Citation: Cisco Blog Legacy Device Attacks)

ullalyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2) 

Monitor and investigate API calls to functions associated with enabling and/or utilizing alternative communication channels.","['Linux', 'Network', 'Windows', 'macOS']","Network Traffic: Network Traffic Content, Network Traffic: Network Traffic Flow",False,,[],Duane Michael; Ryan Becwar,,,,,,"(Citation: FireEye FiveHands April 2021),(Citation: Bitdefender Naikon April 2021),(Citation: CISA MAR-10292089-1.v2 TAIDOOR August 2021),(Citation: Trend Micro DRBControl February 2020),(Citation: CISA WellMail July 2020),(Citation: Palo Alto MoonWind March 2017),(Citation: SentinelLabs Metador Technical Appendix Sept 2022),(Citation: Cybereason Royal December 2022),(Citation: Check Point Pay2Key November 2020),(Citation: ESET InvisiMole June 2020),(Citation: Cyberreason Anchor December 2019),(Citation: Palo Alto Brute Ratel July 2022),(Citation: FireEye APT30),(Citation: ESET PipeMon May 2020),(Citation: Profero APT27 December 2020),(Citation: CISA AR18-352A Quasar RAT December 2018),(Citation: Symantec Remsec IOCs),(Citation: Proofpoint Operation Transparent Tribe March 2016),(Citation: Aquino RARSTONE),(Citation: JPCert BlackTech Malware September 2019),(Citation: ESET Gelsemium June 2021),(Citation: FoxIT Wocao December 2019),(Citation: CheckPoint Naikon May 2020),(Citation: ESET Carbon Mar 2017),(Citation: Scarlet Mimic Jan 2016),(Citation: FireEye Operation Double Tap),(Citation: MalwareBytes SideCopy Dec 2021),(Citation: Fidelis Turbo),(Citation: ESET DazzleSpy Jan 2022),(Citation: NSA/FBI Drovorub August 2020),(Citation: Kaspersky Turla Penquin December 2014),(Citation: Red Canary NETWIRE January 2020),(Citation: Proofpoint TA505 October 2019),(Citation: Microsoft HAFNIUM March 2020),(Citation: CheckPoint Bandook Nov 2020),(Citation: Forcepoint BITTER Pakistan Oct 2016),(Citation: Mandiant UNC3890 Aug 2022),(Citation: Chronicle Winnti for Linux May 2019),(Citation: Unit 42 NETWIRE April 2020),(Citation: Proofpoint LookBack Malware Aug 2019),(Citation: BlackBerry CostaRicto November 2020),(Citation: Novetta Winnti April 2015),(Citation: SentinelLabs Metador Sept 2022),(Citation: Cylance Dust Storm),(Citation: Kaspersky Regin),(Citation: SentinelOne Lazarus macOS July 2020),(Citation: Intezer HiddenWasp Map 2019),(Citation: Umbreon Trend Micro),(Citation: Check Point Warzone Feb 2020),(Citation: FireEye APT32 May 2017),(Citation: Kaspersky ShadowPad Aug 2017),(Citation: Kaspersky ProjectSauron Full Report),(Citation: Unit 42 PingPull Jun 2022),(Citation: Mythc Documentation),(Citation: Mandiant APT41),(Citation: Dell TG-3390),(Citation: Cobalt Strike Manual 4.3 November 2020),(Citation: Palo Alto Reaver Nov 2017),(Citation: Talos Bisonal Mar 2020),(Citation: Microsoft PLATINUM June 2017),(Citation: Talos Cobalt Strike September 2020),(Citation: Kaspersky Transparent Tribe August 2020),(Citation: FireEye APT29 Nov 2018),(Citation: FireEye Metamorfo Apr 2018),(Citation: Leonardo Turla Penquin May 2020),(Citation: FireEye admin@338),(Citation: Bitdefender FunnyDream Campaign November 2020),(Citation: Gh0stRAT ATT March 2019),(Citation: Trend Micro FIN6 October 2019),(Citation: ESET BackdoorDiplomacy Jun 2021),(Citation: Kaspersky QakBot September 2021),","['actor', 'process', 'data flow']","[{'mitigation id': 'M1030', 'mitigation name': 'Network Segmentation', 'mitigation description': 'Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network. Configure separate virtual private cloud (VPC) instances to isolate critical cloud systems.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1030'}, {'mitigation id': 'M1031', 'mitigation name': 'Network Intrusion Prevention', 'mitigation description': 'Use intrusion detection signatures to block traffic at network boundaries.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1031'}, {'mitigation id': 'M1037', 'mitigation name': 'Filter Network Traffic', 'mitigation description': 'Use network appliances to filter ingress or egress traffic and perform protocol-based filtering. Configure software on endpoints to filter network traffic.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1037'}]"
T1102,Web Service,"Adversaries may use an existing, legitimate external Web service as a means for relaying data to/from a compromised system. Popular websites and social media acting as a mechanism for C2 may give a significant amount of cover due to the likelihood that hosts within a network are already communicating with them prior to a compromise. Using common services, such as those offered by Google or Twitter, makes it easier for adversaries to hide in expected noise. Web service providers commonly use SSL/TLS encryption, giving adversaries an added level of protection.

Use of Web services may also protect back-end C2 infrastructure from discovery through malware binary analysis while also enabling operational resiliency (since this infrastructure may be dynamically changed).",https://attack.mitre.org/techniques/T1102,31 May 2017,26 March 2020,1.1,['Command and Control'],"Host data that can relate unknown or suspicious process activity using a network connection is important to supplement any existing indicators of compromise based on malware command and control signatures and infrastructure or the presence of strong encryption. Packet capture analysis will require SSL/TLS inspection if data is encrypted. Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). User behavior monitoring may help to detect abnormal patterns of activity.(Citation: University of Birmingham C2)","['Linux', 'Windows', 'macOS']","Network Traffic: Network Connection Creation, Network Traffic: Network Traffic Content, Network Traffic: Network Traffic Flow",False,,[],Anastasios Pingios,['User'],,,,,"(Citation: Bitdefender FIN8 July 2021),(Citation: FireEye Shining A Light on DARKSIDE May 2021),(Citation: Microsoft WhisperGate January 2022),(Citation: Anomali Rocke March 2019),(Citation: ESET Crutch December 2020),(Citation: Google EXOTIC LILY March 2022),(Citation: Cybereason Molerats Dec 2020),(Citation: Crowdstrike WhisperGate January 2022),(Citation: MSTIC NOBELIUM Mar 2021),(Citation: Symantec Inception Framework March 2018),(Citation: Unit 42 WhisperGate January 2022),(Citation: FireEye FIN6 Apr 2019),(Citation: Cisco Ukraine Wipers January 2022),(Citation: ClearSky Pay2Kitten December 2020),(Citation: Palo Alto Brute Ratel July 2022),(Citation: Check Point APT35 CharmPower January 2022),(Citation: MalwareBytes LazyScripter Feb 2021),(Citation: Proofpoint Bumblebee April 2022),(Citation: Zdnet Ngrok September 2018),(Citation: Medium Eli Salem GuLoader April 2021),(Citation: Aqua TeamTNT August 2020),(Citation: Medium S2W WhisperGate January 2022),(Citation: Proofpoint TA416 Europe March 2022),(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ),(Citation: ESET Gamaredon June 2020),(Citation: MSTIC Nobelium Toolset May 2021),(Citation: Intezer Doki July 20),(Citation: Cisco Talos Intelligence Group),(Citation: Mandiant APT41),(Citation: Kaspersky Cloud Atlas December 2014),(Citation: ESET Operation Spalax Jan 2021),(Citation: Volexity Ocean Lotus November 2020),(Citation: BleepingComputer Molerats Dec 2020),(Citation: Accenture HyperStack October 2020),(Citation: Zscaler Bazar September 2020),(Citation: FireEye NETWIRE March 2019),(Citation: Secureworks DarkTortilla Aug 2022),(Citation: Unit 42 Hildegard Malware),(Citation: Cybereason Bazar July 2020),(Citation: Talos Rocke August 2018),","['actor', 'process', 'data flow']","[{'mitigation id': 'M1021', 'mitigation name': 'Restrict Web-Based Content', 'mitigation description': 'Restrict use of certain websites, block downloads/attachments, block Javascript, restrict browser extensions, etc.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1021'}, {'mitigation id': 'M1031', 'mitigation name': 'Network Intrusion Prevention', 'mitigation description': 'Use intrusion detection signatures to block traffic at network boundaries.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1031'}]"
T1102.001,Web Service: Dead Drop Resolver,"Adversaries may use an existing, legitimate external Web service to host information that points to additional command and control (C2) infrastructure. Adversaries may post content, known as a dead drop resolver, on Web services with embedded (and often obfuscated/encoded) domains or IP addresses. Once infected, victims will reach out to and be redirected by these resolvers.

Popular websites and social media acting as a mechanism for C2 may give a significant amount of cover due to the likelihood that hosts within a network are already communicating with them prior to a compromise. Using common services, such as those offered by Google or Twitter, makes it easier for adversaries to hide in expected noise. Web service providers commonly use SSL/TLS encryption, giving adversaries an added level of protection.

Use of a dead drop resolver may also protect back-end C2 infrastructure from discovery through malware binary analysis while also enabling operational resiliency (since this infrastructure may be dynamically changed).",https://attack.mitre.org/techniques/T1102/001,14 March 2020,26 March 2020,1.0,['Command and Control'],Host data that can relate unknown or suspicious process activity using a network connection is important to supplement any existing indicators of compromise based on malware command and control signatures and infrastructure or the presence of strong encryption. Packet capture analysis will require SSL/TLS inspection if data is encrypted. User behavior monitoring may help to detect abnormal patterns of activity.(Citation: University of Birmingham C2),"['Linux', 'Windows', 'macOS']","Network Traffic: Network Traffic Content, Network Traffic: Network Traffic Flow",True,T1102,,,['User'],,,,,"(Citation: Anomali Rocke March 2019),(Citation: CheckPoint Redaman October 2019),(Citation: PaloAlto Patchwork Mar 2018),(Citation: Check Point APT35 CharmPower January 2022),(Citation: Forcepoint Monsoon),(Citation: ESET Dukes October 2019),(Citation: FireEye Periscope March 2018),(Citation: Unit42 Xbash Sept 2018),(Citation: F-Secure The Dukes),(Citation: Secureworks BRONZE BUTLER Oct 2017),(Citation: Securelist Brazilian Banking Malware July 2020),(Citation: ESET Casbaneiro Oct 2019),(Citation: FireEye APT17),(Citation: Securelist MiniDuke Feb 2013),(Citation: FireEye APT41 Aug 2019),(Citation: Mandiant APT41),(Citation: Palo Alto PlugX June 2017),(Citation: Unit42 Redaman January 2019),(Citation: ESET RTM Feb 2017),(Citation: Securelist Dropping Elephant),(Citation: TrendMicro Patchwork Dec 2017),","['actor', 'process', 'data flow']","[{'mitigation id': 'M1021', 'mitigation name': 'Restrict Web-Based Content', 'mitigation description': 'Restrict use of certain websites, block downloads/attachments, block Javascript, restrict browser extensions, etc.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1021'}, {'mitigation id': 'M1031', 'mitigation name': 'Network Intrusion Prevention', 'mitigation description': 'Use intrusion detection signatures to block traffic at network boundaries.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1031'}]"
T1102.002,Web Service: Bidirectional Communication,"Adversaries may use an existing, legitimate external Web service as a means for sending commands to and receiving output from a compromised system over the Web service channel. Compromised systems may leverage popular websites and social media to host command and control (C2) instructions. Those infected systems can then send the output from those commands back over that Web service channel. The return traffic may occur in a variety of ways, depending on the Web service being utilized. For example, the return traffic may take the form of the compromised system posting a comment on a forum, issuing a pull request to development project, updating a document hosted on a Web service, or by sending a Tweet. 

Popular websites and social media acting as a mechanism for C2 may give a significant amount of cover due to the likelihood that hosts within a network are already communicating with them prior to a compromise. Using common services, such as those offered by Google or Twitter, makes it easier for adversaries to hide in expected noise. Web service providers commonly use SSL/TLS encryption, giving adversaries an added level of protection. ",https://attack.mitre.org/techniques/T1102/002,14 March 2020,26 March 2020,1.0,['Command and Control'],"Host data that can relate unknown or suspicious process activity using a network connection is important to supplement any existing indicators of compromise based on malware command and control signatures and infrastructure or the presence of strong encryption. Packet capture analysis will require SSL/TLS inspection if data is encrypted. Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). User behavior monitoring may help to detect abnormal patterns of activity.(Citation: University of Birmingham C2)","['Linux', 'Windows', 'macOS']","Network Traffic: Network Connection Creation, Network Traffic: Network Traffic Content, Network Traffic: Network Traffic Flow",True,T1102,,,['User'],,,,,"(Citation: Palo Alto Comnie),(Citation: ESET Crutch December 2020),(Citation: Proofpoint Leviathan Oct 2017),(Citation: Lazarus APT January 2022),(Citation: Microsoft POLONIUM June 2022),(Citation: Talos Kimsuky Nov 2021),(Citation: Trend Micro DRBControl February 2020),(Citation: Unit 42 Kazuar May 2017),(Citation: Volexity InkySquid BLUELIGHT August 2021),(Citation: PaloAlto Patchwork Mar 2018),(Citation: Anomali Static Kitten February 2021),(Citation: FireEye FIN7 Aug 2018),(Citation: Talent-Jump Clambling February 2020),(Citation: ESET Telebots Dec 2016),(Citation: ESET Dukes October 2019),(Citation: Forcepoint Monsoon),(Citation: CISA ComRAT Oct 2020),(Citation: ASERT Donot March 2018),(Citation: FireEye Periscope March 2018),(Citation: Unit 42 Nokki Oct 2018),(Citation: CyberESI GTALK),(Citation: Forcepoint Carbanak Google C2),(Citation: Unit 42 Magic Hound Feb 2017),(Citation: FireEye APT37 Feb 2018),(Citation: ESET Turla PowerShell May 2019),(Citation: ESET Telebots June 2017),(Citation: TrendMicro Pawn Storm Dec 2020),(Citation: Securelist ScarCruft May 2019),(Citation: Unit42 DarkHydrus Jan 2019),(Citation: Meyers Numbered Panda),(Citation: PaloAlto UBoatRAT Nov 2017),(Citation: Zscaler APT31 Covid-19 October 2020),(Citation: F-Secure The Dukes),(Citation: Talos ROKRAT),(Citation: ESET Turla Mosquito Jan 2018),(Citation: Google Election Threats October 2020),(Citation: Talos Group123),(Citation: Mandiant APT1 Appendix),(Citation: Mandiant APT1),(Citation: FireEye APT17),(Citation: Checkpoint IndigoZebra July 2021),(Citation: Cofense RevengeRAT Feb 2019),(Citation: F-Secure CozyDuke),(Citation: BitDefender Chafer May 2020),(Citation: ESET ComRAT May 2020),(Citation: Github PowerShell Empire),(Citation: IBM Grandoreiro April 2020),(Citation: ESET Grandoreiro April 2020),(Citation: FireEye admin@338),(Citation: TrendMicro Patchwork Dec 2017),(Citation: NCSC GCHQ Small Sieve Jan 2022),(Citation: ESET Turla Mosquito May 2018),(Citation: Volexity InkySquid RokRAT August 2021),","['actor', 'process', 'data flow']","[{'mitigation id': 'M1021', 'mitigation name': 'Restrict Web-Based Content', 'mitigation description': 'Restrict use of certain websites, block downloads/attachments, block Javascript, restrict browser extensions, etc.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1021'}, {'mitigation id': 'M1031', 'mitigation name': 'Network Intrusion Prevention', 'mitigation description': 'Use intrusion detection signatures to block traffic at network boundaries.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1031'}]"
T1102.003,Web Service: One-Way Communication,"Adversaries may use an existing, legitimate external Web service as a means for sending commands to a compromised system without receiving return output over the Web service channel. Compromised systems may leverage popular websites and social media to host command and control (C2) instructions. Those infected systems may opt to send the output from those commands back over a different C2 channel, including to another distinct Web service. Alternatively, compromised systems may return no output at all in cases where adversaries want to send instructions to systems and do not want a response.

Popular websites and social media acting as a mechanism for C2 may give a significant amount of cover due to the likelihood that hosts within a network are already communicating with them prior to a compromise. Using common services, such as those offered by Google or Twitter, makes it easier for adversaries to hide in expected noise. Web service providers commonly use SSL/TLS encryption, giving adversaries an added level of protection.",https://attack.mitre.org/techniques/T1102/003,14 March 2020,26 March 2020,1.0,['Command and Control'],Host data that can relate unknown or suspicious process activity using a network connection is important to supplement any existing indicators of compromise based on malware command and control signatures and infrastructure or the presence of strong encryption. Packet capture analysis will require SSL/TLS inspection if data is encrypted. Analyze network data for uncommon data flows. User behavior monitoring may help to detect abnormal patterns of activity.(Citation: University of Birmingham C2),"['Linux', 'Windows', 'macOS']","Network Traffic: Network Connection Creation, Network Traffic: Network Traffic Content, Network Traffic: Network Traffic Flow",True,T1102,,,['User'],,,,,"(Citation: Medium Metamorfo Apr 2020),(Citation: FireEye APT29),(Citation: FireEye Metamorfo Apr 2018),(Citation: Fortinet Metamorfo Feb 2020),(Citation: Prevailion EvilNum May 2020),(Citation: FireEye Periscope March 2018),(Citation: F-Secure The Dukes),","['actor', 'process', 'data flow']","[{'mitigation id': 'M1021', 'mitigation name': 'Restrict Web-Based Content', 'mitigation description': 'Restrict use of certain websites, block downloads/attachments, block Javascript, restrict browser extensions, etc.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1021'}, {'mitigation id': 'M1031', 'mitigation name': 'Network Intrusion Prevention', 'mitigation description': 'Use intrusion detection signatures to block traffic at network boundaries.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1031'}]"
T1104,Multi-Stage Channels,"Adversaries may create multiple stages for command and control that are employed under different conditions or for certain functions. Use of multiple stages may obfuscate the command and control channel to make detection more difficult.

Remote access tools will call back to the first-stage command and control server for instructions. The first stage may have automated capabilities to collect basic host information, update tools, and upload additional files. A second remote access tool (RAT) could be uploaded at that point to redirect the host to the second-stage command and control server. The second stage will likely be more fully featured and allow the adversary to interact with the system through a reverse shell and additional RAT features.

The different stages will likely be hosted separately with no overlapping infrastructure. The loader may also have backup first-stage callbacks or [Fallback Channels](https://attack.mitre.org/techniques/T1008) in case the original first-stage communication path is discovered and blocked.",https://attack.mitre.org/techniques/T1104,31 May 2017,14 July 2020,1.0,['Command and Control'],Host data that can relate unknown or suspicious process activity using a network connection is important to supplement any existing indicators of compromise based on malware command and control signatures and infrastructure. Relating subsequent actions that may result from Discovery of the system and network information or Lateral Movement to the originating process may also yield useful data.,"['Linux', 'Windows', 'macOS']","Network Traffic: Network Connection Creation, Network Traffic: Network Traffic Flow",False,,[],,,,,,,"(Citation: Talos MuddyWater May 2019),(Citation: Lazarus APT January 2022),(Citation: Chaos Stolen Backdoor),(Citation: FireEye Operation Double Tap),(Citation: FireEye APT41 March 2020),(Citation: Zscaler Bazar September 2020),(Citation: FireEye APT30),(Citation: FireEye APT17),(Citation: Unit 42 Valak July 2020),(Citation: Cybereason Bazar July 2020),","['actor', 'process', 'data flow']","[{'mitigation id': 'M1031', 'mitigation name': 'Network Intrusion Prevention', 'mitigation description': 'Use intrusion detection signatures to block traffic at network boundaries.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1031'}]"
T1105,Ingress Tool Transfer,"Adversaries may transfer tools or other files from an external system into a compromised environment. Tools or files may be copied from an external adversary-controlled system to the victim network through the command and control channel or through alternate protocols such as [ftp](https://attack.mitre.org/software/S0095). Once present, adversaries may also transfer/spread tools between victim devices within a compromised environment (i.e. [Lateral Tool Transfer](https://attack.mitre.org/techniques/T1570)). 

Files can also be transferred using various [Web Service](https://attack.mitre.org/techniques/T1102)s as well as native or otherwise present tools on the victim system.(Citation: PTSecurity Cobalt Dec 2016)

On Windows, adversaries may use various utilities to download tools, such as `copy`, `finger`, [certutil](https://attack.mitre.org/software/S0160), and [PowerShell](https://attack.mitre.org/techniques/T1059/001) commands such as <code>IEX(New-Object Net.WebClient).downloadString()</code> and <code>Invoke-WebRequest</code>. On Linux and macOS systems, a variety of utilities also exist, such as `curl`, `scp`, `sftp`, `tftp`, `rsync`, `finger`, and `wget`.(Citation: t1105_lolbas)",https://attack.mitre.org/techniques/T1105,31 May 2017,14 April 2023,2.2,['Command and Control'],"Monitor for file creation and files transferred into the network. Unusual processes with external network connections creating files on-system may be suspicious. Use of utilities, such as [ftp](https://attack.mitre.org/software/S0095), that does not normally occur may also be suspicious.

ullalyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Specifically, for the finger utility on Windows and Linux systems, monitor command line or terminal execution for the finger command. Monitor network activity for TCP port 79, which is used by the finger utility, and Windows <code>netsh interface portproxy</code> modifications to well-known ports such as 80 and 443. Furthermore, monitor file system for the download/creation and execution of suspicious files, which may indicate adversary-downloaded payloads. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)","['Linux', 'Windows', 'macOS']","File: File Creation, Network Traffic: Network Connection Creation, Network Traffic: Network Traffic Content, Network Traffic: Network Traffic Flow",False,,[],"John Page (aka hyp3rlinx), ApparitionSec; Mark Wee",,,,,,"(Citation: Cybereason Kimsuky November 2020),(Citation: Talos Kimsuky Nov 2021),(Citation: Cisco Ukraine Wipers January 2022),(Citation: ESET EvilNum July 2020),(Citation: Intezer TeamTNT September 2020),(Citation: CoinTicker 2019),(Citation: Aquino RARSTONE),(Citation: Medium Anchor DNS July 2020),(Citation: ESET Nomadic Octopus 2018),(Citation: ESET LightNeuron May 2019),(Citation: Crowdstrike Indrik November 2018),(Citation: PTSecurity Cobalt Dec 2016),(Citation: Symantec Security Center Trojan.Kwampirs),(Citation: objectivesee osx.shlayer apple approved 2020),(Citation: Unit 42 NOKKI Sept 2018),(Citation: Palo Alto menuPass Feb 2017),(Citation: Cybereason Egregor Nov 2020),(Citation: Radware Micropsia July 2018),(Citation: Talos Cobalt Strike September 2020),(Citation: Zscaler Bazar September 2020),(Citation: Unit 42 BackConfig May 2020),(Citation: Fidelis INOCNATION),(Citation: Bitdefender Trickbot VNC module Whitepaper 2021),(Citation: GitHub Sliver Upload),(Citation: FireEye Fin8 May 2016),(Citation: MacKeeper Bundlore Apr 2019),(Citation: Symantec Pasam May 2012),(Citation: RATANKBA),(Citation: FireEye FIN7 April 2017),(Citation: Lazarus APT January 2022),(Citation: GitHub SILENTTRINITY Modules July 2019),(Citation: Security Intelligence More Eggs Aug 2019),(Citation: Cybereason Molerats Dec 2020),(Citation: Recorded Future REDDELTA July 2020),(Citation: Symantec Darkmoon Aug 2005),(Citation: Proofpoint Azorult July 2018),(Citation: PWC Cloud Hopper April 2017),(Citation: MalwareBytes WoodyRAT Aug 2022),(Citation: LOLBAS Certutil),(Citation: Unit 42 Valak July 2020),(Citation: Cofense Astaroth Sept 2018),(Citation: Proofpoint Operation Transparent Tribe March 2016),(Citation: Google TAG Lazarus Jan 2021),(Citation: Korean FSI TA505 2020),(Citation: FireEye APT28),(Citation: PTSecurity Cobalt Group Aug 2017),(Citation: Unit42 Xbash Sept 2018),(Citation: FireEye SMOKEDHAM June 2021),(Citation: Novetta Blockbuster),(Citation: US-CERT Bankshot Dec 2017),(Citation: Accenture Dragonfish Jan 2018),(Citation: Reaqta MuddyWater November 2017),(Citation: Mandiant APT1 Appendix),(Citation: Check Point Warzone Feb 2020),(Citation: McAfee Sharpshooter December 2018),(Citation: FireEye Clandestine Fox),(Citation: US-CERT TA18-074A),(Citation: ESET Exchange Mar 2021),(Citation: Unit 42 CARROTBAT November 2018),(Citation: Unit42 BendyBear Feb 2021),(Citation: Unit42 Redaman January 2019),(Citation: Securelist Dropping Elephant),(Citation: ESET Grandoreiro April 2020),(Citation: Forcepoint Felismus Mar 2017),(Citation: FireEye NETWIRE March 2019),(Citation: Kaspersky QakBot September 2021),(Citation: Zscaler Lyceum DnsSystem June 2022),(Citation: Securelist APT10 March 2021),(Citation: Symantec Linfo May 2012),(Citation: Symantec Dyre June 2015),(Citation: Malwarebytes SmokeLoader 2016),(Citation: Crowdstrike DNC June 2016),(Citation: FireEye POSHSPY April 2017),(Citation: sentinelone shlayer to zshlayer),(Citation: Symantec Frutas Feb 2013),(Citation: ClearSky Lazarus Aug 2020),(Citation: Securelist ScarCruft May 2019),(Citation: TrendMicro Taidoor),(Citation: PaloAlto UBoatRAT Nov 2017),(Citation: Checkpoint MosesStaff Nov 2021),(Citation: Kaspersky LuminousMoth July 2021),(Citation: PWC Cloud Hopper Technical Annex April 2017),(Citation: Microsoft HAFNIUM March 2020),(Citation: Rapid7 KeyBoy Jun 2013),(Citation: ESET Turla Mosquito Jan 2018),(Citation: Symantec Calisto July 2018),(Citation: TrendMicro POWERSTATS V3 June 2019),(Citation: CheckPoint Volatile Cedar March 2015),(Citation: Symantec Dragonfly),(Citation: Nccgroup Gh0st April 2018),(Citation: Securelist Brazilian Banking Malware July 2020),(Citation: DFIR Conti Bazar Nov 2021),(Citation: ThreatExpert Agent.btz),(Citation: ClearSky Wilted Tulip July 2017),(Citation: Trend Micro IXESHE 2012),(Citation: Leonardo Turla Penquin May 2020),(Citation: CheckPoint SpeakUp Feb 2019),(Citation: Symantec Bumblebee June 2022),(Citation: Lab52 WIRTE Apr 2019),(Citation: FireEye FiveHands April 2021),(Citation: Trend Micro Daserf Nov 2017),(Citation: Google EXOTIC LILY March 2022),(Citation: Group IB GrimAgent July 2021),(Citation: DigiTrust Agent Tesla Jan 2017),(Citation: Palo Alto Shamoon Nov 2016),(Citation: Symantec Buckeye),(Citation: Profero APT27 December 2020),(Citation: Palo Alto Brute Ratel July 2022),(Citation: US-CERT KEYMARBLE Aug 2018),(Citation: JPCert PLEAD Downloader June 2018),(Citation: wardle evilquest partii),(Citation: Talos ZxShell Oct 2014),(Citation: Trend Micro Iron Tiger April 2021),(Citation: Unit42 DarkHydrus Jan 2019),(Citation: Medium Eli Salem GuLoader April 2021),(Citation: Cybereason Chaes Nov 2020),(Citation: Trend Micro Waterbear December 2019),(Citation: F-Secure The Dukes),(Citation: Dell Sakula),(Citation: Mandiant UNC3890 Aug 2022),(Citation: Cybersecurity Advisory GRU Brute Force Campaign July 2021),(Citation: Cisco Talos Bitter Bangladesh May 2022),(Citation: Cyberint Qakbot May 2021),(Citation: Microsoft BITSAdmin),(Citation: PaloAlto CardinalRat Apr 2017),(Citation: SentinelLabs Metador Sept 2022),(Citation: Rancor Unit42 June 2018),(Citation: US District Court Indictment GRU Unit 74455 October 2020),(Citation: Intezer HiddenWasp Map 2019),(Citation: Bitdefender LuminousMoth July 2021),(Citation: TrendMicro Confucius APT Aug 2021),(Citation: Unit 42 VERMIN Jan 2018),(Citation: Secureworks GOLD KINGSWOOD September 2018),(Citation: Kaspersky Transparent Tribe August 2020),(Citation: FireEye admin@338),(Citation: Palo Alto Gamaredon Feb 2017),(Citation: ESET BackdoorDiplomacy Jun 2021),(Citation: Trend Micro Tick November 2019),(Citation: Objective-See MacMa Nov 2021),(Citation: Microsoft WhisperGate January 2022),(Citation: Cylance Shaheen Nov 2018),(Citation: McAfee Sodinokibi October 2019),(Citation: Trend Micro DRBControl February 2020),(Citation: Trend Micro Muddy Water March 2021),(Citation: FireEye APT10 Sept 2018),(Citation: Lee 2013),(Citation: Talos Agent Tesla Oct 2018),(Citation: TrendMicro macOS Dacls May 2020),(Citation: McAfee Cuba April 2021),(Citation: Proofpoint NETWIRE December 2020),(Citation: Group IB APT 41 June 2021),(Citation: Trend Micro Skidmap),(Citation: Trend Micro MacOS Backdoor November 2020),(Citation: Scarlet Mimic Jan 2016),(Citation: Symantec Hydraq Jan 2010),(Citation: Microsoft DUBNIUM June 2016),(Citation: ESET DazzleSpy Jan 2022),(Citation: Malwarebytes Pony April 2016),(Citation: Talos ROKRAT),(Citation: CrowdStrike Carbon Spider August 2021),(Citation: FireEye APT38 Oct 2018),(Citation: ESET Casbaneiro Oct 2019),(Citation: Kaspersky Winnti April 2013),(Citation: CIRCL PlugX March 2013),(Citation: Cisco Talos Intelligence Group),(Citation: GDATA Zeus Panda June 2017),(Citation: Dell TG-3390),(Citation: Cobalt Strike Manual 4.3 November 2020),(Citation: BiZone Lizar May 2021),(Citation: Gh0stRAT ATT March 2019),(Citation: TrendMicro BKDR_URSNIF.SM),(Citation: SentinelLabs Metador Technical Appendix Sept 2022),(Citation: Unit 42 BadPatch Oct 2017),(Citation: ESET PipeMon May 2020),(Citation: Talos PoetRAT April 2020),(Citation: Riskiq Remcos Jan 2018),(Citation: Lotus Blossom Dec 2015),(Citation: FireEye APT37 Feb 2018),(Citation: Prevx Carberp March 2011),(Citation: FoxIT Wocao December 2019),(Citation: Kaspersky ThreatNeedle Feb 2021),(Citation: Unit 42 RGDoor Jan 2018),(Citation: NCCGroup RokRat Nov 2018),(Citation: Threatpost Hancitor),(Citation: Unit42 CookieMiner Jan 2019),(Citation: Fortinet Metamorfo Feb 2020),(Citation: NSA/FBI Drovorub August 2020),(Citation: JPCERT ChChes Feb 2017),(Citation: Cybereason Soft Cell June 2019),(Citation: TrendMicro BlackTech June 2017),(Citation: MSTIC Nobelium Toolset May 2021),(Citation: Intezer Doki July 20),(Citation: Symantec Backdoor.Nidiran),(Citation: ESET GreyEnergy Oct 2018),(Citation: ClearSky Lebanese Cedar Jan 2021),(Citation: FireEye APT34 Webinar Dec 2017),(Citation: Proofpoint TA505 Jan 2019),(Citation: Microsoft PLATINUM June 2017),(Citation: Talos PoetRAT October 2020),(Citation: Securelist ShadowPad Aug 2017),(Citation: Crowdstrike GTR2020 Mar 2020),(Citation: FireEye Know Your Enemy FIN8 Aug 2016),(Citation: CISA WellMail July 2020),(Citation: Bitdefender StrongPity June 2020),(Citation: Palo Alto DNS Requests),(Citation: SANS Conficker),(Citation: Secureworks MCMD July 2019),(Citation: ESET ForSSHe December 2018),(Citation: Github Koadic),(Citation: Intrinsec Egregor Nov 2020),(Citation: NTT Security Flagpro new December 2021),(Citation: Secureworks BRONZE BUTLER Oct 2017),(Citation: ESET InvisiMole June 2018),(Citation: JPCert TSCookie March 2018),(Citation: Talos NavRAT May 2018),(Citation: Kaspersky Ferocious Kitten Jun 2021),(Citation: Unit 42 OilRig Sept 2018),(Citation: Palo Alto OilRig May 2016),(Citation: BleepingComputer Molerats Dec 2020),(Citation: FireEye Metamorfo Apr 2018),(Citation: Talos Frankenstein June 2019),(Citation: NCSC Cyclops Blink February 2022),(Citation: Talos Rocke August 2018),(Citation: PWC KeyBoys Feb 2017),(Citation: FireEye SUNSHUTTLE Mar 2021),(Citation: PaloAlto DNS Requests May 2016),(Citation: Unit42 Azorult Nov 2018),(Citation: Unit 42 Lucifer June 2020),(Citation: Cyphort EvilBunny Dec 2014),(Citation: US-CERT HOPLIGHT Apr 2019),(Citation: Unit 42 CARROTBAT January 2020),(Citation: Novetta Blockbuster Destructive Malware),(Citation: ClearSky MuddyWater Nov 2018),(Citation: Juniper IcedID June 2020),(Citation: Costa AvosLocker May 2022),(Citation: CheckPoint Bandook Nov 2020),(Citation: Symantec Volgmer Aug 2014),(Citation: Kaspersky Lyceum October 2021),(Citation: Bitdefender APT28 Dec 2015),(Citation: Group IB Ransomware September 2020),(Citation: Unit42 RDAT July 2020),(Citation: PaloAlto nulloCore Feb 2016),(Citation: ESET Sednit Part 1),(Citation: US-CERT Volgmer Nov 2017),(Citation: CyberBit Dtrack),(Citation: Checkpoint IndigoZebra July 2021),(Citation: Mandiant APT41),(Citation: Security Affairs DustSquad Oct 2018),(Citation: Github PowerShell Empire),(Citation: Trend Micro Ransomware February 2021),(Citation: FireEye MuddyWater Mar 2018),(Citation: Trend Micro Cyclops Blink March 2022),(Citation: Gigamon Berserk Bear October 2021),(Citation: CISA SoreFang July 2016),(Citation: TrendMicro Patchwork Dec 2017),(Citation: Talos Micropsia June 2017),(Citation: ESET Turla Mosquito May 2018),(Citation: Symantec Ristol May 2012),(Citation: Proofpoint Leviathan Oct 2017),(Citation: MSTIC FoggyWeb September 2021),(Citation: Trend Micro Totbrick Oct 2016),(Citation: IBM IcedID November 2017),(Citation: TechNet Copy),(Citation: Symantec Remsec IOCs),(Citation: CISA AA20-259A Iran-Based Actor September 2020),(Citation: FireEye FELIXROOT July 2018),(Citation: Kaspersky WIRTE November 2021),(Citation: Unit 42 Magic Hound Feb 2017),(Citation: Zscaler Kasidet),(Citation: ProofPoint SettingContent-ms July 2018),(Citation: Proofpoint Bumblebee April 2022),(Citation: DFIR Phosphorus November 2021),(Citation: MalwareBytes SideCopy Dec 2021),(Citation: Flashpoint FIN 7 March 2019),(Citation: Palo Alto OilRig Sep 2018),(Citation: Malwarebytes RokRAT VBA January 2021),(Citation: Linux FTP),(Citation: TechNet Certutil),(Citation: BlackBerry CostaRicto November 2020),(Citation: Check Point Rocket Kitten),(Citation: McAfee Night Dragon),(Citation: BlackBerry Bahamut),(Citation: Cybereason Astaroth Feb 2019),(Citation: Lunghi Iron Tiger Linux),(Citation: Talos TinyTurla September 2021),(Citation: ESET Lazarus Jun 2020),(Citation: Unit42 Molerat Mar 2020),(Citation: US-CERT BLINDINGCAN Aug 2020),(Citation: Cisco Talos Avos Jun 2022),(Citation: FOX-IT May 2016 Mofang),(Citation: ESET TeleBots Oct 2018),(Citation: Group IB Silence Sept 2018),(Citation: Cybereason Bazar July 2020),(Citation: Symantec Whitefly March 2019),(Citation: LOLBAS Esentutl),(Citation: Kaspersky MoleRATs April 2019),(Citation: Palo Alto Sofacy 06-2018),(Citation: Talos Konni May 2017),(Citation: Symantec Trojan.Hydraq Jan 2010),(Citation: Volexity InkySquid BLUELIGHT August 2021),(Citation: Unit42 Emissary Panda May 2019),(Citation: Unit 42 MechaFlounder March 2019),(Citation: Unit 42 Nokki Oct 2018),(Citation: Cybereason PowerLess February 2022),(Citation: TrendMicro TropicTrooper 2015),(Citation: Microsoft GALLIUM December 2019),(Citation: Unit42 Cannon Nov 2018),(Citation: ESET Gelsemium June 2021),(Citation: Unit 42 Gamaredon February 2022),(Citation: TrendMicro Tropic Trooper May 2020),(Citation: TrendMicro Gamaredon April 2020),(Citation: TrendMicro PE_URSNIF.A2),(Citation: Proofpoint TA416 Europe March 2022),(Citation: Securelist Dtrack),(Citation: FireEye FIN7 March 2017),(Citation: ClearSky Siamesekitten August 2021),(Citation: Novetta Blockbuster Loaders),(Citation: NCSC Joint Report Public Tools),(Citation: ESET RTM Feb 2017),(Citation: Microsoft Actinium February 2022),(Citation: Securelist MuddyWater Oct 2018),(Citation: Unit 42 Playbook Dec 2017),(Citation: Microsoft Iranian Threat Actor Trends November 2021),(Citation: Microsoft FTP),(Citation: Microsoft POLONIUM June 2022),(Citation: McAfee Lazarus Jul 2020),(Citation: Symantec Elfin Mar 2019),(Citation: Trusteer Carberp October 2010),(Citation: CISA AA20-301A Kimsuky),(Citation: ESET InvisiMole June 2020),(Citation: Cyberreason Anchor December 2019),(Citation: Microsoft Holmium June 2020),(Citation: DOJ FIN7 Aug 2018),(Citation: Accenture MUDCARP March 2019),(Citation: ESET Twitter Ida Pro Nov 2021),(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ),(Citation: Trend Micro njRAT 2018),(Citation: Cycraft Chimera April 2020),(Citation: SentinelOne Lazarus macOS July 2020),(Citation: Securelist MiniDuke Feb 2013),(Citation: CrowdStrike AQUATIC PANDA December 2021),(Citation: NCSC APT29 July 2020),(Citation: Malwarebytes DarkComet March 2018),(Citation: Talos Bisonal Mar 2020),(Citation: Cyble Sidewinder September 2020),(Citation: Unit 42 Gorgon Group Aug 2018),(Citation: DFIR Report APT35 ProxyShell March 2022),(Citation: Unit 42 KerrDown February 2019),(Citation: Volexity PowerDuke November 2016),(Citation: Kaspersky ProjectSauron Technical Analysis),(Citation: Microsoft PLATINUM April 2016),(Citation: Securelist WhiteBear Aug 2017),(Citation: Check Point APT34 April 2021),(Citation: Microsoft NICKEL December 2021),(Citation: MalwareBytes LazyScripter Feb 2021),(Citation: Trend Micro Qakbot May 2020),(Citation: ZScaler Squirrelwaffle Sep 2021),(Citation: Fidelis njRAT June 2013),(Citation: SentinelOne Aoqin Dragon June 2022),(Citation: ESET Zebrocy May 2019),(Citation: Trend Micro Qakbot December 2020),(Citation: Securelist Octopus Oct 2018),(Citation: US-CERT Volgmer 2 Nov 2017),(Citation: Talos Lokibot Jan 2021),(Citation: ESET Machete July 2019),(Citation: McAfee Gold Dragon),(Citation: CrowdStrike Wizard Spider October 2020),(Citation: Accenture Lyceum Targets November 2021),(Citation: ESET Gamaredon June 2020),(Citation: Donut Github),(Citation: Cylance Dust Storm),(Citation: Carbon Black HotCroissant April 2020),(Citation: DigiTrust nulloCore Jan 2017),(Citation: IBM Grandoreiro April 2020),(Citation: FireEye APT41 March 2020),(Citation: FireEye APT29 Nov 2018),(Citation: Cisco H1N1 Part 2),(Citation: Bitdefender FIN8 July 2021),(Citation: GitHub QuasarRAT),(Citation: ESET LoudMiner June 2019),(Citation: Kaspersky Adwind Feb 2016),(Citation: Unit 42 Sofacy Feb 2018),(Citation: Lazarus RATANKBA),(Citation: ESET Dukes October 2019),(Citation: Symantec Briba May 2012),(Citation: 20 macOS Common Tools and Techniques),(Citation: ANSSI Sandworm January 2021),(Citation: Cybereason Cobalt Kitty 2017),(Citation: Accenture SNAKEMACKEREL Nov 2018),(Citation: Symantec Vasport May 2012),(Citation: Cisco Talos Transparent Tribe Education Campaign July 2022),(Citation: Malwarebytes Konni Aug 2021),(Citation: Talos Cobalt Group July 2018),(Citation: Deep Instinct TA505 Apr 2019),(Citation: Talos Seduploader Oct 2017),(Citation: Cybereason TA505 April 2019),(Citation: Kaspersky CactusPete Aug 2020),(Citation: Morphisec Cobalt Gang Oct 2018),(Citation: Proofpoint ZeroT Feb 2017),(Citation: BlackBerry Amadey 2020),(Citation: Novetta-Axiom),(Citation: FireEye APT10 April 2017),(Citation: Volexity OceanLotus Nov 2017),(Citation: District Court of NY APT10 Indictment December 2018),(Citation: FBI FLASH APT39 September 2020),(Citation: ESET Sednit Part 3),(Citation: jRAT Symantec Aug 2018),(Citation: Symantec Wiarp May 2012),(Citation: Picus Sodinokibi January 2020),(Citation: Unit 42 Hildegard Malware),(Citation: Prevailion EvilNum May 2020),(Citation: CISA WellMess July 2020),(Citation: Bitdefender Naikon April 2021),(Citation: Unit 42 TA551 Jan 2021),(Citation: Unit42 BabyShark Apr 2019),(Citation: trendmicro xcsset xcode project 2020),(Citation: Unit 42 WhisperGate January 2022),(Citation: ESET Okrum July 2019),(Citation: Rapid7 HAFNIUM Mar 2021),(Citation: Secureworks Karagany July 2019),(Citation: HP SVCReady Jun 2022),(Citation: TrendMicro DarkComet Sept 2014),(Citation: Kaspersky Cloud Atlas August 2019),(Citation: Trustwave GoldenSpy June 2020),(Citation: TrendMicro Pawn Storm Dec 2020),(Citation: Unit 42 SeaDuke 2015),(Citation: CISA AR21-126A FIVEHANDS May 2021),(Citation: US-CERT TYPEFRAME June 2018),(Citation: Zscaler APT31 Covid-19 October 2020),(Citation: Proofpoint TA505 October 2019),(Citation: Microsoft Unidentified Dec 2018),(Citation: McAfee Honeybee),(Citation: ESET Attor Oct 2019),(Citation: Chronicle Winnti for Linux May 2019),(Citation: Cybereason Valak May 2020),(Citation: TrendMicro MacOS April 2018),(Citation: Aqua Kinsing April 2020),(Citation: Novetta Winnti April 2015),(Citation: ATT Sidewinder January 2021),(Citation: Volexity Patchwork June 2018),(Citation: FireEye APT34 Dec 2017),(Citation: CISA MAR-10288834-2.v1  TAINTEDSCRIBE MAY 2020),(Citation: Kaspersky Tomiris Sep 2021),(Citation: Talos Sodinokibi April 2019),(Citation: Mandiant No Easy Breach),(Citation: Secureworks DarkTortilla Aug 2022),(Citation: Bitdefender FunnyDream Campaign November 2020),(Citation: NCSC GCHQ Small Sieve Jan 2022),(Citation: Uptycs Confucius APT Jan 2021),(Citation: GitHub Pupy),(Citation: Cybereason StrifeWater Feb 2022),(Citation: MSTIC NOBELIUM Mar 2021),(Citation: Carbon Black Shlayer Feb 2019),(Citation: ESET Gazer Aug 2017),(Citation: Check Point APT35 CharmPower January 2022),(Citation: ESET Telebots Dec 2016),(Citation: Morphisec ShellTea June 2019),(Citation: Symantec Chafer February 2018),(Citation: Medium Metamorfo Apr 2020),(Citation: Symantec Shuckworm January 2022),(Citation: Symantec WastedLocker June 2020),(Citation: Forcepoint BITTER Pakistan Oct 2016),(Citation: CISA MAR SLOTHFULMEDIA October 2020),(Citation: Fortinet Diavol July 2021),(Citation: TrendMicro Lazarus Nov 2018),(Citation: Sophos Netwalker May 2020),(Citation: Kaspersky StoneDrill 2017),(Citation: Volexity InkySquid RokRAT August 2021),(Citation: Unit 42 Bisonal July 2018),(Citation: Unit 42 Kazuar May 2017),(Citation: Unit 42 OopsIE! Feb 2018),(Citation: PWC WellMess July 2020),(Citation: PaloAlto Patchwork Mar 2018),(Citation: NCC Group Team9 June 2020),(Citation: Forcepoint Monsoon),(Citation: FireEye Periscope March 2018),(Citation: Check Point Meteor Aug 2021),(Citation: QiAnXin APT-C-36 Feb2019),(Citation: FireEye SUNBURST Backdoor December 2020),(Citation: CheckPoint Naikon May 2020),(Citation: Qualys LolZarus),(Citation: FireEye APT33 Sept 2017),(Citation: Netskope Squirrelwaffle Oct 2021),(Citation: Medium S2W WhisperGate January 2022),(Citation: SecureWorks August 2019),(Citation: ESET Industroyer),(Citation: AhnLab Andariel Subgroup of Lazarus June 2018),(Citation: Unit 42 DarkHydrus July 2018),(Citation: Mandiant APT1),(Citation: Symantec Backdoor.Mivast),(Citation: Crowdstrike Qakbot October 2020),(Citation: University of Birmingham C2)","['actor', 'process', 'data flow']","[{'mitigation id': 'M1031', 'mitigation name': 'Network Intrusion Prevention', 'mitigation description': 'Use intrusion detection signatures to block traffic at network boundaries.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1031'}]"
T1110,Brute Force,"Adversaries may use brute force techniques to gain access to accounts when passwords are unknown or when password hashes are obtained. Without knowledge of the password for an account or set of accounts, an adversary may systematically guess the password using a repetitive or iterative mechanism. Brute forcing passwords can take place via interaction with a service that will check the validity of those credentials or offline against previously acquired credential data, such as password hashes.

Brute forcing credentials may take place at various points during a breach. For example, adversaries may attempt to brute force access to [Valid Accounts](https://attack.mitre.org/techniques/T1078) within a victim environment leveraging knowledge gathered from other post-compromise behaviors such as [OS Credential Dumping](https://attack.mitre.org/techniques/T1003), [Account Discovery](https://attack.mitre.org/techniques/T1087), or [Password Policy Discovery](https://attack.mitre.org/techniques/T1201). Adversaries may also combine brute forcing activity with behaviors such as [External Remote Services](https://attack.mitre.org/techniques/T1133) as part of Initial Access.",https://attack.mitre.org/techniques/T1110,31 May 2017,14 April 2023,2.5,['Credential Access'],"Monitor authentication logs for system and application login failures of [Valid Accounts](https://attack.mitre.org/techniques/T1078). If authentication failures are high, then there may be a brute force attempt to gain access to a system using legitimate credentials. Also monitor for many failed authentication attempts across various accounts that may result from password spraying attempts. It is difficult to detect when hashes are cracked, since this is generally done outside the scope of the target network.","['Azure AD', 'Containers', 'Google Workspace', 'IaaS', 'Linux', 'Network', 'Office 365', 'SaaS', 'Windows', 'macOS']","Application Log: Application Log Content, Command: Command Execution, User Account: User Account Authentication",False,,[],"Alfredo Oliveira, Trend Micro; David Fiser, @anu4is, Trend Micro; Ed Williams, Trustwave, SpiderLabs; Magno Logan, @magnologan, Trend Micro; Mohamed Kmal; Yossi Weizman, Azure Defender Research Team",,,,,,"(Citation: ClearSky Pay2Kitten December 2020),(Citation: Kroll Qakbot June 2020),(Citation: TrendMicro Pawn Storm Dec 2020),(Citation: Chaos Stolen Backdoor),(Citation: Kaspersky Turla),(Citation: TrendMicro Pawn Storm 2019),(Citation: Microsoft Targeting Elections September 2020),(Citation: SecureWorks August 2019),(Citation: Dragos Crashoverride 2018),(Citation: Securelist DarkVishnya Dec 2018),(Citation: CISA AA20-296A Berserk Bear December 2020),(Citation: Aqua Kinsing April 2020),(Citation: CERT-FR PYSA April 2020),(Citation: Crowdstrike Qakbot October 2020),(Citation: CME Github September 2018),(Citation: ClearSky Lebanese Cedar Jan 2021),(Citation: FireEye APT34 Webinar Dec 2017),(Citation: Mandiant FIN5 GrrCON Oct 2016),(Citation: FireEye APT39 Jan 2019),(Citation: ESET Lazarus Jun 2020),(Citation: CISA AA20-239A BeagleBoyz August 2020),(Citation: GitHub PoshC2),(Citation: DarkReading FireEye FIN5 Oct 2015),(Citation: Kaspersky QakBot September 2021),(Citation: Microsoft Common Conditional Access Policies),(Citation: NIST 800-63-3)","['actor', 'process', 'data store', 'data flow']","[{'mitigation id': 'M1018', 'mitigation name': 'User Account Management', 'mitigation description': 'Manage the creation, modification, use, and permissions associated to user accounts.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1018'}, {'mitigation id': 'M1027', 'mitigation name': 'Password Policies', 'mitigation description': 'Set and enforce secure password policies for accounts.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1027'}, {'mitigation id': 'M1032', 'mitigation name': 'Multi-factor Authentication', 'mitigation description': 'Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1032'}, {'mitigation id': 'M1036', 'mitigation name': 'Account Use Policies', 'mitigation description': 'Configure features related to account use like login attempt lockouts, specific login times, etc.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1036'}]"
T1110.001,Brute Force: Password Guessing,"Adversaries with no prior knowledge of legitimate credentials within the system or environment may guess passwords to attempt access to accounts. Without knowledge of the password for an account, an adversary may opt to systematically guess the password using a repetitive or iterative mechanism. An adversary may guess login credentials without prior knowledge of system or environment passwords during an operation by using a list of common passwords. Password guessing may or may not take into account the target's policies on password complexity or use policies that may lock accounts out after a number of failed attempts.

Guessing passwords can be a risky option because it could cause numerous authentication failures and account lockouts, depending on the organization's login failure policies. (Citation: Cylance Cleaver)

Typically, management services over commonly used ports are used when guessing passwords. Commonly targeted services include the following:

* SSH (22/TCP)
* Telnet (23/TCP)
* FTP (21/TCP)
* NetBIOS / SMB / Samba (139/TCP & 445/TCP)
* LDAP (389/TCP)
* Kerberos (88/TCP)
* RDP / Terminal Services (3389/TCP)
* HTTP/HTTP Management Services (80/TCP & 443/TCP)
* MSSQL (1433/TCP)
* Oracle (1521/TCP)
* MySQL (3306/TCP)
* VNC (5900/TCP)
* SNMP (161/UDP and 162/TCP/UDP)

In addition to management services, adversaries may ""target single sign-on (SSO) and cloud-based applications utilizing federated authentication protocols,"" as well as externally facing email applications, such as Office 365.(Citation: US-CERT TA18-068A 2018). Further, adversaries may abuse network device interfaces (such as `wlanAPI`) to brute force accessible wifi-router(s) via wireless authentication protocols.(Citation: Trend Micro Emotet 2020)

In default environments, LDAP and Kerberos connection attempts are less likely to trigger events over SMB, which creates Windows ""logon failure"" event ID 4625.",https://attack.mitre.org/techniques/T1110/001,11 February 2020,14 April 2023,1.4,['Credential Access'],"Monitor authentication logs for system and application login failures of [Valid Accounts](https://attack.mitre.org/techniques/T1078). If authentication failures are high, then there may be a brute force attempt to gain access to a system using legitimate credentials.","['Azure AD', 'Containers', 'Google Workspace', 'IaaS', 'Linux', 'Network', 'Office 365', 'SaaS', 'Windows', 'macOS']","Application Log: Application Log Content, User Account: User Account Authentication",True,T1110,,Microsoft Threat Intelligence Center (MSTIC); Mohamed Kmal,,,,,,"(Citation: Trend Micro Xbash Sept 2018),(Citation: Malwarebytes Emotet Dec 2017),(Citation: ANSSI Sandworm January 2021),(Citation: Unit 42 Lucifer June 2020),(Citation: CIS Emotet Dec 2018),(Citation: Cybersecurity Advisory GRU Brute Force Campaign July 2021),(Citation: FireEye Periscope March 2018),(Citation: ESET Hermetic Wizard March 2022),(Citation: Malwarebytes Pony April 2016),(Citation: Unit42 Xbash Sept 2018),(Citation: Symantec Emotet Jul 2018),(Citation: Secureworks Emotet Nov 2018),(Citation: US-CERT Emotet Jul 2018),(Citation: CheckPoint SpeakUp Feb 2019),(Citation: Mandiant APT29 Microsoft 365 2022),(Citation: Microsoft STRONTIUM New Patterns Cred Harvesting Sept 2020),(Citation: CME Github September 2018),(Citation: Microsoft Common Conditional Access Policies),(Citation: NIST 800-63-3)","['actor', 'process', 'data store', 'data flow']","[{'mitigation id': 'M1027', 'mitigation name': 'Password Policies', 'mitigation description': 'Set and enforce secure password policies for accounts.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1027'}, {'mitigation id': 'M1032', 'mitigation name': 'Multi-factor Authentication', 'mitigation description': 'Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1032'}, {'mitigation id': 'M1036', 'mitigation name': 'Account Use Policies', 'mitigation description': 'Configure features related to account use like login attempt lockouts, specific login times, etc.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1036'}, {'mitigation id': 'M1051', 'mitigation name': 'Update Software', 'mitigation description': 'Perform regular software updates to mitigate exploitation risk.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1051'}]"
T1110.002,Brute Force: Password Cracking,"Adversaries may use password cracking to attempt to recover usable credentials, such as plaintext passwords, when credential material such as password hashes are obtained. [OS Credential Dumping](https://attack.mitre.org/techniques/T1003) can be used to obtain password hashes, this may only get an adversary so far when [Pass the Hash](https://attack.mitre.org/techniques/T1550/002) is not an option. Further,  adversaries may leverage [Data from Configuration Repository](https://attack.mitre.org/techniques/T1602) in order to obtain hashed credentials for network devices.(Citation: US-CERT-TA18-106A) 

Techniques to systematically guess the passwords used to compute hashes are available, or the adversary may use a pre-computed rainbow table to crack hashes. Cracking hashes is usually done on adversary-controlled systems outside of the target network.(Citation: Wikipedia Password cracking) The resulting plaintext password resulting from a successfully cracked hash may be used to log into systems, resources, and services in which the account has access.",https://attack.mitre.org/techniques/T1110/002,11 February 2020,30 March 2023,1.2,['Credential Access'],"It is difficult to detect when hashes are cracked, since this is generally done outside the scope of the target network. Consider focusing efforts on detecting other adversary behavior used to acquire credential materials, such as [OS Credential Dumping](https://attack.mitre.org/techniques/T1003) or [Kerberoasting](https://attack.mitre.org/techniques/T1558/003).","['Azure AD', 'Linux', 'Network', 'Office 365', 'Windows', 'macOS']","Application Log: Application Log Content, User Account: User Account Authentication",True,T1110,,Mohamed Kmal,,,,,,"(Citation: US-CERT TA18-074A),(Citation: Cylance Cleaver),(Citation: APT3 Adversary Emulation Plan),(Citation: Kali Hydra),(Citation: McAfee Night Dragon),(Citation: FireEye APT41 Aug 2019),(Citation: FireEye FIN6 April 2016),(Citation: NIST 800-63-3)","['actor', 'process', 'data store', 'data flow']","[{'mitigation id': 'M1027', 'mitigation name': 'Password Policies', 'mitigation description': 'Set and enforce secure password policies for accounts.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1027'}, {'mitigation id': 'M1032', 'mitigation name': 'Multi-factor Authentication', 'mitigation description': 'Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1032'}]"
T1110.003,Brute Force: Password Spraying,"Adversaries may use a single or small list of commonly used passwords against many different accounts to attempt to acquire valid account credentials. Password spraying uses one password (e.g. 'Password01'), or a small list of commonly used passwords, that may match the complexity policy of the domain. Logins are attempted with that password against many different accounts on a network to avoid account lockouts that would normally occur when brute forcing a single account with many passwords. (Citation: BlackHillsInfosec Password Spraying)

Typically, management services over commonly used ports are used when password spraying. Commonly targeted services include the following:

* SSH (22/TCP)
* Telnet (23/TCP)
* FTP (21/TCP)
* NetBIOS / SMB / Samba (139/TCP & 445/TCP)
* LDAP (389/TCP)
* Kerberos (88/TCP)
* RDP / Terminal Services (3389/TCP)
* HTTP/HTTP Management Services (80/TCP & 443/TCP)
* MSSQL (1433/TCP)
* Oracle (1521/TCP)
* MySQL (3306/TCP)
* VNC (5900/TCP)

In addition to management services, adversaries may ""target single sign-on (SSO) and cloud-based applications utilizing federated authentication protocols,"" as well as externally facing email applications, such as Office 365.(Citation: US-CERT TA18-068A 2018)

In default environments, LDAP and Kerberos connection attempts are less likely to trigger events over SMB, which creates Windows ""logon failure"" event ID 4625.",https://attack.mitre.org/techniques/T1110/003,11 February 2020,14 April 2023,1.3,['Credential Access'],"Monitor authentication logs for system and application login failures of [Valid Accounts](https://attack.mitre.org/techniques/T1078). Specifically, monitor for many failed authentication attempts across various accounts that may result from password spraying attempts.

Consider the following event IDs:(Citation: Trimarc Detecting Password Spraying)

* Domain Controllers: ""Audit Logon"" (Success & Failure) for event ID 4625.
* Domain Controllers: ""Audit Kerberos Authentication Service"" (Success & Failure) for event ID 4771.
* All systems: ""Audit Logon"" (Success & Failure) for event ID 4648.","['Azure AD', 'Containers', 'Google Workspace', 'IaaS', 'Linux', 'Office 365', 'SaaS', 'Windows', 'macOS']","Application Log: Application Log Content, User Account: User Account Authentication",True,T1110,,John Strand; Microsoft Threat Intelligence Center (MSTIC),,,,,,"(Citation: Microsoft Targeting Elections September 2020),(Citation: MSTIC Nobelium Oct 2021),(Citation: SecureWorks August 2019),(Citation: Novetta Blockbuster RATs),(Citation: Cybersecurity Advisory GRU Brute Force Campaign July 2021),(Citation: MSRC Nobelium June 2021),(Citation: Secure List Bad Rabbit),(Citation: Anomali Linux Rabbit 2018),(Citation: Symantec Leafminer July 2018),(Citation: FireEye APT33 Guardrail),(Citation: GitHub MailSniper),(Citation: NCC Group Chimera January 2021),(Citation: Microsoft STRONTIUM New Patterns Cred Harvesting Sept 2020),(Citation: Novetta Blockbuster),(Citation: Microsoft Holmium June 2020),(Citation: CME Github September 2018),(Citation: DOJ Iran Indictments March 2018),(Citation: Microsoft Common Conditional Access Policies),(Citation: NIST 800-63-3)","['actor', 'process', 'data store', 'data flow']","[{'mitigation id': 'M1027', 'mitigation name': 'Password Policies', 'mitigation description': 'Set and enforce secure password policies for accounts.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1027'}, {'mitigation id': 'M1032', 'mitigation name': 'Multi-factor Authentication', 'mitigation description': 'Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1032'}, {'mitigation id': 'M1036', 'mitigation name': 'Account Use Policies', 'mitigation description': 'Configure features related to account use like login attempt lockouts, specific login times, etc.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1036'}]"
T1110.004,Brute Force: Credential Stuffing,"Adversaries may use credentials obtained from breach dumps of unrelated accounts to gain access to target accounts through credential overlap. Occasionally, large numbers of username and password pairs are dumped online when a website or service is compromised and the user account credentials accessed. The information may be useful to an adversary attempting to compromise accounts by taking advantage of the tendency for users to use the same passwords across personal and business accounts.

Credential stuffing is a risky option because it could cause numerous authentication failures and account lockouts, depending on the organization's login failure policies.

Typically, management services over commonly used ports are used when stuffing credentials. Commonly targeted services include the following:

* SSH (22/TCP)
* Telnet (23/TCP)
* FTP (21/TCP)
* NetBIOS / SMB / Samba (139/TCP & 445/TCP)
* LDAP (389/TCP)
* Kerberos (88/TCP)
* RDP / Terminal Services (3389/TCP)
* HTTP/HTTP Management Services (80/TCP & 443/TCP)
* MSSQL (1433/TCP)
* Oracle (1521/TCP)
* MySQL (3306/TCP)
* VNC (5900/TCP)

In addition to management services, adversaries may ""target single sign-on (SSO) and cloud-based applications utilizing federated authentication protocols,"" as well as externally facing email applications, such as Office 365.(Citation: US-CERT TA18-068A 2018)",https://attack.mitre.org/techniques/T1110/004,11 February 2020,14 April 2023,1.3,['Credential Access'],"Monitor authentication logs for system and application login failures of [Valid Accounts](https://attack.mitre.org/techniques/T1078). If authentication failures are high, then there may be a brute force attempt to gain access to a system using legitimate credentials.","['Azure AD', 'Containers', 'Google Workspace', 'IaaS', 'Linux', 'Office 365', 'SaaS', 'Windows', 'macOS']","Application Log: Application Log Content, User Account: User Account Authentication",True,T1110,,Anastasios Pingios; Diogo Fernulldes,,,,,,"(Citation: ESET Trickbot Oct 2020),(Citation: NCC Group Chimera January 2021),(Citation: Bitdefender Trickbot March 2020),(Citation: Microsoft Common Conditional Access Policies),(Citation: NIST 800-63-3)","['actor', 'process', 'data store', 'data flow']","[{'mitigation id': 'M1018', 'mitigation name': 'User Account Management', 'mitigation description': 'Manage the creation, modification, use, and permissions associated to user accounts.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1018'}, {'mitigation id': 'M1027', 'mitigation name': 'Password Policies', 'mitigation description': 'Set and enforce secure password policies for accounts.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1027'}, {'mitigation id': 'M1032', 'mitigation name': 'Multi-factor Authentication', 'mitigation description': 'Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1032'}, {'mitigation id': 'M1036', 'mitigation name': 'Account Use Policies', 'mitigation description': 'Configure features related to account use like login attempt lockouts, specific login times, etc.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1036'}]"
T1111,Multi-Factor Authentication Interception,"Adversaries may target multi-factor authentication (MFA) mechanisms, (i.e., smart cards, token generators, etc.) to gain access to credentials that can be used to access systems, services, and network resources. Use of MFA is recommended and provides a higher level of security than usernames and passwords alone, but organizations should be aware of techniques that could be used to intercept and bypass these security mechanisms. 

If a smart card is used for multi-factor authentication, then a keylogger will need to be used to obtain the password associated with a smart card during normal use. With both an inserted card and access to the smart card password, an adversary can connect to a network resource using the infected system to proxy the authentication with the inserted hardware token. (Citation: Mandiant M Trends 2011)

Adversaries may also employ a keylogger to similarly target other hardware tokens, such as RSA SecurID. Capturing token input (including a user's personal identification code) may provide temporary access (i.e. replay the one-time passcode until the next value rollover) as well as possibly enabling adversaries to reliably predict future authentication values (given access to both the algorithm and any seed values used to generate appended temporary codes). (Citation: GCN RSA June 2011)

Other methods of MFA may be intercepted and used by an adversary to authenticate. It is common for one-time codes to be sent via out-of-band communications (email, SMS). If the device and/or service is not secured, then it may be vulnerable to interception. Service providers can also be targeted: for example, an adversary may compromise an SMS messaging service in order to steal MFA codes sent to users’ phones.(Citation: Okta Scatter Swine 2022)",https://attack.mitre.org/techniques/T1111,31 May 2017,14 April 2023,2.1,['Credential Access'],"Detecting use of proxied smart card connections by an adversary may be difficult because it requires the token to be inserted into a system; thus it is more likely to be in use by a legitimate user and blend in with other network behavior.

Similar to [Input Capture](https://attack.mitre.org/techniques/T1056), keylogging activity can take various forms but can may be detected via installation of a driver, setting a hook, or usage of particular API calls associated with polling to intercept keystrokes.","['Linux', 'Windows', 'macOS']","Driver: Driver Load, Process: OS API Execution, Windows Registry: Windows Registry Key Modification",False,,[],"John Lambert, Microsoft Threat Intelligence Center",,,,,,"(Citation: Alienvault Sykipot DOD Smart Cards),(Citation: KISA Operation Muzabi),(Citation: FoxIT Wocao December 2019),(Citation: MSTIC DEV-0537 Mar 2022),(Citation: NCC Group Chimera January 2021),","['actor', 'process', 'data store', 'data flow']","[{'mitigation id': 'M1017', 'mitigation name': 'User Training', 'mitigation description': 'Train users to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1017'}]"
T1132,Data Encoding,"Adversaries may encode data to make the content of command and control traffic more difficult to detect. Command and control (C2) information can be encoded using a standard data encoding system. Use of data encoding may adhere to existing protocol specifications and includes use of ASCII, Unicode, Base64, MIME, or other binary-to-text and character encoding systems.(Citation: Wikipedia Binary-to-text Encoding) (Citation: Wikipedia Character Encoding) Some data encoding systems may also result in data compression, such as gzip.",https://attack.mitre.org/techniques/T1132,31 May 2017,21 April 2023,1.2,['Command and Control'],"Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2)","['Linux', 'Windows', 'macOS']",Network Traffic: Network Traffic Content,False,,[],"Itzik Kotler, SafeBreach",,,,,,"(Citation: Mythc Documentation),(Citation: ProofPoint Ursnif Aug 2016),(Citation: Anomali Linux Rabbit 2018),(Citation: Forcepoint Monsoon),(Citation: Cisco H1N1 Part 2),(Citation: University of Birmingham C2)","['actor', 'process', 'data flow']","[{'mitigation id': 'M1031', 'mitigation name': 'Network Intrusion Prevention', 'mitigation description': 'Use intrusion detection signatures to block traffic at network boundaries.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1031'}]"
T1132.001,Data Encoding: Standard Encoding,"Adversaries may encode data with a standard data encoding system to make the content of command and control traffic more difficult to detect. Command and control (C2) information can be encoded using a standard data encoding system that adheres to existing protocol specifications. Common data encoding schemes include ASCII, Unicode, hexadecimal, Base64, and MIME.(Citation: Wikipedia Binary-to-text Encoding)(Citation: Wikipedia Character Encoding) Some data encoding systems may also result in data compression, such as gzip.",https://attack.mitre.org/techniques/T1132/001,14 March 2020,03 March 2023,1.0,['Command and Control'],"Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)","['Linux', 'Windows', 'macOS']",Network Traffic: Network Traffic Content,True,T1132,,,,,,,,"(Citation: Lotus Blossom Jun 2015),(Citation: Cylance Shaheen Nov 2018),(Citation: Trend Micro Muddy Water March 2021),(Citation: Fysbis Dr Web Analysis),(Citation: McAfee Lazarus Nov 2020),(Citation: Cybereason Cobalt Kitty 2017),(Citation: Accenture SNAKEMACKEREL Nov 2018),(Citation: Proofpoint Bumblebee April 2022),(Citation: Unit42 BabyShark Feb 2019),(Citation: Kaspersky CactusPete Aug 2020),(Citation: Antiy CERT Ramsay April 2020),(Citation: Lunghi Iron Tiger Linux),(Citation: Unit 42 PingPull Jun 2022),(Citation: Nicolas Falliere, Liam O Murchu, Eric Chien February 2011),(Citation: Unit42 Molerat Mar 2020),(Citation: US-CERT BLINDINGCAN Aug 2020),(Citation: Cobalt Strike Manual 4.3 November 2020),(Citation: Palo Alto menuPass Feb 2017),(Citation: Kaspersky Sofacy),(Citation: Gh0stRAT ATT March 2019),(Citation: CISA WellMess July 2020),(Citation: Unit 42 QUADAGENT July 2018),(Citation: Security Intelligence More Eggs Aug 2019),(Citation: SentinelLabs Metador Technical Appendix Sept 2022),(Citation: Unit 42 MechaFlounder March 2019),(Citation: Unit 42 Valak July 2020),(Citation: ESET Okrum July 2019),(Citation: Cofense Astaroth Sept 2018),(Citation: Securelist Machete Aug 2014),(Citation: DHS CISA AA22-055A MuddyWater February 2022),(Citation: Kaspersky Cloud Atlas August 2019),(Citation: FireEye APT28),(Citation: Kaspersky Carbanak),(Citation: TrendMicro Tropic Trooper May 2020),(Citation: Medium KONNI Jan 2020),(Citation: Unit 42 SeaDuke 2015),(Citation: FireEye SMOKEDHAM June 2021),(Citation: JPCERT ChChes Feb 2017),(Citation: Malwarebytes Saint Bot April 2021),(Citation: FireEye APT34 Dec 2017),(Citation: Unit 42 C0d0so0 Jan 2016),(Citation: Cymmetria Patchwork),(Citation: Forcepoint Felismus Mar 2017),(Citation: FireEye CARBANAK June 2017),(Citation: Unit 42 Playbook Dec 2017),(Citation: Kaspersky QakBot September 2021),(Citation: Zscaler Lyceum DnsSystem June 2022),(Citation: Microsoft POLONIUM June 2022),(Citation: FireEye APT33 Guardrail),(Citation: Check Point APT35 CharmPower January 2022),(Citation: Cyberreason Anchor December 2019),(Citation: ESET Telebots Dec 2016),(Citation: Palo Alto DNS Requests),(Citation: Mandiant Operation Ke3chang November 2014),(Citation: ESET ForSSHe December 2018),(Citation: Zscaler Cobian Aug 2017),(Citation: NTT Security Flagpro new December 2021),(Citation: Secureworks BRONZE BUTLER Oct 2017),(Citation: Microsoft HAFNIUM March 2020),(Citation: ClearSky MuddyWater June 2019),(Citation: Symantec Dragonfly),(Citation: Prevailion DarkWatchman 2021),(Citation: Palo Alto OilRig May 2016),(Citation: Trend Micro IXESHE 2012),(Citation: Talos Bisonal Mar 2020),(Citation: CheckPoint SpeakUp Feb 2019),(Citation: ESET Ebury Feb 2014),(Citation: Unit 42 Kazuar May 2017),(Citation: Unit 42 OopsIE! Feb 2018),(Citation: Group IB GrimAgent July 2021),(Citation: PaloAlto Patchwork Mar 2018),(Citation: Unit 42 MuddyWater Nov 2017),(Citation: Forcepoint Monsoon),(Citation: Microsoft PLATINUM April 2016),(Citation: US-CERT HOPLIGHT Apr 2019),(Citation: Unit 42 Inception November 2018),(Citation: Check Point APT34 April 2021),(Citation: Moran 2013),(Citation: FireEye SUNBURST Backdoor December 2020),(Citation: ZScaler Squirrelwaffle Sep 2021),(Citation: Fidelis njRAT June 2013),(Citation: SentinelOne Aoqin Dragon June 2022),(Citation: Cybereason Chaes Nov 2020),(Citation: GitHub Sliver HTTP),(Citation: Securelist Octopus Oct 2018),(Citation: ESET Operation Groundbait),(Citation: Kaspersky Lyceum October 2021),(Citation: Unit42 RDAT July 2020),(Citation: Unit 42 DarkHydrus July 2018),(Citation: Cylance Dust Storm),(Citation: Crowdstrike Qakbot October 2020),(Citation: Checkpoint IndigoZebra July 2021),(Citation: McAfee Lazarus Resurfaces Feb 2018),(Citation: TrendMicro Patchwork Dec 2017),(Citation: Trend Micro Tick November 2019),","['actor', 'process', 'data flow']","[{'mitigation id': 'M1031', 'mitigation name': 'Network Intrusion Prevention', 'mitigation description': 'Use intrusion detection signatures to block traffic at network boundaries.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1031'}]"
T1132.002,Data Encoding: Non-Standard Encoding,"Adversaries may encode data with a non-standard data encoding system to make the content of command and control traffic more difficult to detect. Command and control (C2) information can be encoded using a non-standard data encoding system that diverges from existing protocol specifications. Non-standard data encoding schemes may be based on or related to standard data encoding schemes, such as a modified Base64 encoding for the message body of an HTTP request.(Citation: Wikipedia Binary-to-text Encoding) (Citation: Wikipedia Character Encoding) ",https://attack.mitre.org/techniques/T1132/002,14 March 2020,14 March 2020,1.0,['Command and Control'],"Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)","['Linux', 'Windows', 'macOS']",Network Traffic: Network Traffic Content,True,T1132,,,['User'],,,,,"(Citation: CYBERCOM Iranian Intel Cyber January 2022),(Citation: Unit42 RDAT July 2020),(Citation: McAfee Oceansalt Oct 2018),(Citation: McAfee Bankshot),(Citation: ESET InvisiMole June 2020),(Citation: FireEye APT30),(Citation: Securelist ShadowPad Aug 2017),(Citation: DHS CISA AA22-055A MuddyWater February 2022),(Citation: NCSC Cyclops Blink February 2022),(Citation: NCSC GCHQ Small Sieve Jan 2022),","['actor', 'process', 'data flow']","[{'mitigation id': 'M1031', 'mitigation name': 'Network Intrusion Prevention', 'mitigation description': 'Use intrusion detection signatures to block traffic at network boundaries.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1031'}]"
T1205,Traffic Signaling,"Adversaries may use traffic signaling to hide open ports or other malicious functionality used for persistence or command and control. Traffic signaling involves the use of a magic value or sequence that must be sent to a system to trigger a special response, such as opening a closed port or executing a malicious task. This may take the form of sending a series of packets with certain characteristics before a port will be opened that the adversary can use for command and control. Usually this series of packets consists of attempted connections to a predefined sequence of closed ports (i.e. [Port Knocking](https://attack.mitre.org/techniques/T1205/001)), but can involve unusual flags, specific strings, or other unique characteristics. After the sequence is completed, opening a port may be accomplished by the host-based firewall, but could also be implemented by custom software.

Adversaries may also communicate with an already open port, but the service listening on that port will only respond to commands or trigger other malicious functionality if passed the appropriate magic value(s).

The observation of the signal packets to trigger the communication can be conducted through different methods. One means, originally implemented by Cd00r (Citation: Hartrell cd00r 2002), is to use the libpcap libraries to sniff for the packets in question. Another method leverages raw sockets, which enables the malware to use ports that are already open for use by other programs.

On network devices, adversaries may use crafted packets to enable [Network Device Authentication](https://attack.mitre.org/techniques/T1556/004) for standard services offered by the device such as telnet.  Such signaling may also be used to open a closed service port such as telnet, or to trigger module modification of malware implants on the device, adding, removing, or changing malicious capabilities.  Adversaries may use crafted packets to attempt to connect to one or more (open or closed) ports, but may also attempt to connect to a router interface, broadcast, and network address IP on the same port in order to achieve their goals and objectives.(Citation: Cisco Synful Knock Evolution)(Citation: Mandiant - Synful Knock)(Citation: Cisco Blog Legacy Device Attacks)  To enable this traffic signaling on embedded devices, adversaries must first achieve and leverage [Patch System Image](https://attack.mitre.org/techniques/T1601/001) due to the monolithic nature of the architecture.

Adversaries may also use the Wake-on-LAN feature to turn on powered off systems. Wake-on-LAN is a hardware feature that allows a powered down system to be powered on, or woken up, by sending a magic packet to it. Once the system is powered on, it may become a target for lateral movement.(Citation: Bleeping Computer - Ryuk WoL)(Citation: AMD Magic Packet)",https://attack.mitre.org/techniques/T1205,18 April 2018,19 October 2022,2.4,"['Command and Control', 'Defense Evasion', 'Persistence']","Record network packets sent to and from the system, looking for extraneous packets that do not belong to established flows.

The Wake-on-LAN magic packet consists of 6 bytes of <code>FF</code> followed by sixteen repetitions of the target system's IEEE address. Seeing this string anywhere in a packet's payload may be indicative of a Wake-on-LAN attempt.(Citation: GitLab WakeOnLAN)","['Linux', 'Network', 'Windows', 'macOS']","Network Traffic: Network Connection Creation, Network Traffic: Network Traffic Content, Network Traffic: Network Traffic Flow, Process: Process Creation",False,,[],"Josh Day, Gigamon; Tony Lee",,,,,,"(Citation: Mandiant - Synful Knock),(Citation: Trend Micro Iron Tiger April 2021),(Citation: Bleeping Computer - Ryuk WoL),(Citation: Chronicle Winnti for Linux May 2019),(Citation: Chaos Stolen Backdoor),(Citation: ESET Kobalos Feb 2021),(Citation: ESET Kobalos Jan 2021),(Citation: Leonardo Turla Penquin May 2020),(Citation: Kaspersky Turla Penquin December 2014),(Citation: Umbreon Trend Micro),","['actor', 'process', 'data store', 'data flow']","[{'mitigation id': 'M1037', 'mitigation name': 'Filter Network Traffic', 'mitigation description': 'Use network appliances to filter ingress or egress traffic and perform protocol-based filtering. Configure software on endpoints to filter network traffic.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1037'}, {'mitigation id': 'M1042', 'mitigation name': 'Disable or Remove Feature or Program', 'mitigation description': 'Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1042'}]"
T1205.001,Traffic Signaling: Port Knocking,"Adversaries may use port knocking to hide open ports used for persistence or command and control. To enable a port, an adversary sends a series of attempted connections to a predefined sequence of closed ports. After the sequence is completed, opening a port is often accomplished by the host based firewall, but could also be implemented by custom software.

This technique has been observed both for the dynamic opening of a listening port as well as the initiating of a connection to a listening server on a different system.

The observation of the signal packets to trigger the communication can be conducted through different methods. One means, originally implemented by Cd00r (Citation: Hartrell cd00r 2002), is to use the libpcap libraries to sniff for the packets in question. Another method leverages raw sockets, which enables the malware to use ports that are already open for use by other programs.",https://attack.mitre.org/techniques/T1205/001,01 July 2020,11 March 2022,1.1,"['Command and Control', 'Defense Evasion', 'Persistence']","Record network packets sent to and from the system, looking for extraneous packets that do not belong to established flows.","['Linux', 'Network', 'Windows', 'macOS']","Network Traffic: Network Connection Creation, Network Traffic: Network Traffic Flow",True,T1205,,,['User'],,,,,"(Citation: SentinelLabs Metador Technical Appendix Sept 2022),(Citation: SentinelLabs Metador Sept 2022),(Citation: Bitdefender StrongPity June 2020),","['actor', 'process', 'data store', 'data flow']","[{'mitigation id': 'M1037', 'mitigation name': 'Filter Network Traffic', 'mitigation description': 'Use network appliances to filter ingress or egress traffic and perform protocol-based filtering. Configure software on endpoints to filter network traffic.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1037'}]"
T1205.002,Traffic Signaling: Socket Filters,"Adversaries may attach filters to a network socket to monitor then activate backdoors used for persistence or command and control. With elevated permissions, adversaries can use features such as the `libpcap` library to open sockets and install filters to allow or disallow certain types of data to come through the socket. The filter may apply to all traffic passing through the specified network interface (or every interface if not specified). When the network interface receives a packet matching the filter criteria, additional actions can be triggered on the host, such as activation of a reverse shell.

To establish a connection, an adversary sends a crafted packet to the targeted host that matches the installed filter criteria.(Citation: haking9 libpcap network sniffing) Adversaries have used these socket filters to trigger the installation of implants, conduct ping backs, and to invoke command shells. Communication with these socket filters may also be used in conjunction with [Protocol Tunneling](https://attack.mitre.org/techniques/T1572).(Citation: exatrack bpf filters passive backdoors)(Citation: Leonardo Turla Penquin May 2020)

Filters can be installed on any Unix-like platform with `libpcap` installed or on Windows hosts using `Winpcap`.  Adversaries may use either `libpcap` with `pcap_setfilter` or the standard library function `setsockopt` with `SO_ATTACH_FILTER` options. Since the socket connection is not active until the packet is received, this behavior may be difficult to detect due to the lack of activity on a host, low CPU overhead, and limited visibility into raw socket usage.",https://attack.mitre.org/techniques/T1205/002,30 September 2022,20 October 2022,1.0,"['Command and Control', 'Defense Evasion', 'Persistence']",Identify running processes with raw sockets. Ensure processes listed have a need for an open raw socket and are in accordance with enterprise policy.(Citation: crowdstrike bpf socket filters),"['Linux', 'Windows', 'macOS']","Network Traffic: Network Connection Creation, Process: Process Creation",True,T1205,,CrowdStrike; Tim (Wadhwa-)Brown,,,,,,"(Citation: Leonardo Turla Penquin May 2020),","['actor', 'process', 'data store', 'data flow']","[{'mitigation id': 'M1037', 'mitigation name': 'Filter Network Traffic', 'mitigation description': 'Use network appliances to filter ingress or egress traffic and perform protocol-based filtering. Configure software on endpoints to filter network traffic.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1037'}]"
T1212,Exploitation for Credential Access,"Adversaries may exploit software vulnerabilities in an attempt to collect credentials. Exploitation of a software vulnerability occurs when an adversary takes advantage of a programming error in a program, service, or within the operating system software or kernel itself to execute adversary-controlled code. Credentialing and authentication mechanisms may be targeted for exploitation by adversaries as a means to gain access to useful credentials or circumvent the process to gain access to systems. One example of this is MS14-068, which targets Kerberos and can be used to forge Kerberos tickets using domain user permissions.(Citation: Technet MS14-068)(Citation: ADSecurity Detecting Forged Tickets) Exploitation for credential access may also result in Privilege Escalation depending on the process targeted or credentials obtained.",https://attack.mitre.org/techniques/T1212,18 April 2018,28 April 2022,1.4,['Credential Access'],"Detecting software exploitation may be difficult depending on the tools available. Software exploits may not always succeed or may cause the exploited process to become unstable or crash. Also look for behavior on the system that might indicate successful compromise, such as abnormal behavior of processes. Credential resources obtained through exploitation may be detectable in use if they are not normally used or seen.","['Linux', 'Windows', 'macOS']","Application Log: Application Log Content, Process: Process Creation, User Account: User Account Authentication",False,,[],"John Lambert, Microsoft Threat Intelligence Center",,,,,,",(Citation: TechNet Moving Beyond EMET),(Citation: Ars Technica Pwn2Own 2017 VM Escape),(Citation: Wikipedia Control Flow Integrity)","['actor', 'process', 'data store', 'data flow']","[{'mitigation id': 'M1019', 'mitigation name': 'Threat Intelligence Program', 'mitigation description': 'A threat intelligence program helps an organization generate their own threat intelligence information and track trends to inform defensive priorities to mitigate risk.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1019'}, {'mitigation id': 'M1048', 'mitigation name': 'Application Isolation and Sandboxing', 'mitigation description': 'Restrict execution of code to a virtual environment on or in transit to an endpoint system.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1048'}, {'mitigation id': 'M1050', 'mitigation name': 'Exploit Protection', 'mitigation description': 'Use capabilities to detect and block conditions that may lead to or be indicative of a software exploit occurring.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1050'}, {'mitigation id': 'M1051', 'mitigation name': 'Update Software', 'mitigation description': 'Perform regular software updates to mitigate exploitation risk.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1051'}]"
T1219,Remote Access Software,"An adversary may use legitimate desktop support and remote access software, such as Team Viewer, AnyDesk, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks. These services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment. Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries.(Citation: Symantec Living off the Land)

Remote access tools may be installed and used post-compromise as alternate communications channel for redundant access or as a way to establish an interactive remote desktop session with the target system. They may also be used as a component of malware to establish a reverse connection or back-connect to a service or adversary controlled system. Installation of many remote access tools may also include persistence (ex: the tool's installation routine creates a [Windows Service](https://attack.mitre.org/techniques/T1543/003)).

Admin tools such as TeamViewer have been used by several groups targeting institutions in countries of interest to the Russian state and criminal campaigns.(Citation: CrowdStrike 2015 Global Threat Report)(Citation: CrySyS Blog TeamSpy)",https://attack.mitre.org/techniques/T1219,18 April 2018,21 April 2022,2.1,['Command and Control'],"Monitor for applications and processes related to remote admin tools. Correlate activity with other suspicious behavior that may reduce false positives if these tools are used by legitimate users and administrators.

ullalyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect application layer protocols that do not follow the expected protocol for the port that is being used.

[Domain Fronting](https://attack.mitre.org/techniques/T1090/004) may be used in conjunction to avoid defenses. Adversaries will likely need to deploy and/or install these remote tools to compromised systems. It may be possible to detect or prevent the installation of these tools with host-based solutions.","['Linux', 'Windows', 'macOS']","Network Traffic: Network Connection Creation, Network Traffic: Network Traffic Content, Network Traffic: Network Traffic Flow, Process: Process Creation",False,,[],"Matt Kelly, @breakersall; Zachary Stanford, @svch0st",,,,,,"(Citation: US-CERT Ukraine Feb 2016),(Citation: Group IB Cobalt Aug 2017),(Citation: Crowdstrike GTR2020 Mar 2020),(Citation: Dell Dridex Oct 2015),(Citation: Trend Micro Muddy Water March 2021),(Citation: Anomali Static Kitten February 2021),(Citation: Group IB RTM August 2019),(Citation: ESET EvilNum July 2020),(Citation: Bitdefender Trickbot March 2020),(Citation: Symantec Thrip June 2018),(Citation: PTSecurity Cobalt Group Aug 2017),(Citation: Secureworks BRONZE PRESIDENT December 2019),(Citation: Group-IB Anunak),(Citation: ESET Trickbot Oct 2020),(Citation: Costa AvosLocker May 2022),(Citation: Microsoft Prestige ransomware October 2022),(Citation: PTSecurity Cobalt Dec 2016),(Citation: Securelist DarkVishnya Dec 2018),(Citation: McAfee Night Dragon),(Citation: Tetra Defense Sodinokibi March 2020),(Citation: Cisco Talos Intelligence Group),(Citation: DFIR Conti Bazar Nov 2021),(Citation: ESET RTM Feb 2017),(Citation: Cisco Talos Avos Jun 2022),(Citation: Cyble Egregor Oct 2020),(Citation: FireEye CARBANAK June 2017),(Citation: Unit 42 Hildegard Malware),(Citation: Securelist Kimsuky Sept 2013),","['actor', 'process', 'data flow']","[{'mitigation id': 'M1031', 'mitigation name': 'Network Intrusion Prevention', 'mitigation description': 'Use intrusion detection signatures to block traffic at network boundaries.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1031'}, {'mitigation id': 'M1037', 'mitigation name': 'Filter Network Traffic', 'mitigation description': 'Use network appliances to filter ingress or egress traffic and perform protocol-based filtering. Configure software on endpoints to filter network traffic.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1037'}, {'mitigation id': 'M1038', 'mitigation name': 'Execution Prevention', 'mitigation description': 'Block execution of code on a system through application control, and/or script blocking.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1038'}]"
T1539,Steal Web Session Cookie,"An adversary may steal web application or service session cookies and use them to gain access to web applications or Internet services as an authenticated user without needing credentials. Web applications and services often use session cookies as an authentication token after a user has authenticated to a website.

Cookies are often valid for an extended period of time, even if the web application is not actively used. Cookies can be found on disk, in the process memory of the browser, and in network traffic to remote systems. Additionally, other applications on the targets machine might store sensitive authentication cookies in memory (e.g. apps which authenticate to cloud services). Session cookies can be used to bypasses some multi-factor authentication protocols.(Citation: Pass The Cookie)

There are several examples of malware targeting cookies from web browsers on the local system.(Citation: Kaspersky TajMahal April 2019)(Citation: Unit 42 Mac Crypto Cookies January 2019) There are also open source frameworks such as Evilginx 2 and Muraena that can gather session cookies through a malicious proxy (ex: [Adversary-in-the-Middle](https://attack.mitre.org/techniques/T1557)) that can be set up by an adversary and used in phishing campaigns.(Citation: Github evilginx2)(Citation: GitHub Mauraena)

After an adversary acquires a valid cookie, they can then perform a [Web Session Cookie](https://attack.mitre.org/techniques/T1550/004) technique to login to the corresponding web application.",https://attack.mitre.org/techniques/T1539,08 October 2019,28 July 2021,1.2,['Credential Access'],Monitor for attempts to access files and repositories on a local system that are used to store browser session cookies. Monitor for attempts by programs to inject into or dump browser process memory.,"['Google Workspace', 'Linux', 'Office 365', 'SaaS', 'Windows', 'macOS']","File: File Access, Process: Process Access",False,,[],Johann Rehberger; Microsoft Threat Intelligence Center (MSTIC),['User'],,,,,"(Citation: Prevailion EvilNum May 2020),(Citation: Kroll Qakbot June 2020),(Citation: CrowdStrike StellarParticle January 2022),(Citation: IBM Grandoreiro April 2020),(Citation: Kaspersky TajMahal April 2019),(Citation: Volexity InkySquid BLUELIGHT August 2021),(Citation: trendmicro xcsset xcode project 2020),(Citation: Cybereason Chaes Nov 2020),(Citation: Unit42 CookieMiner Jan 2019),(Citation: ESET EvilNum July 2020),(Citation: Kaspersky LuminousMoth July 2021),(Citation: Kaspersky QakBot September 2021),(Citation: Evilginx 2 July 2018)","['actor', 'process', 'data store', 'data flow']","[{'mitigation id': 'M1017', 'mitigation name': 'User Training', 'mitigation description': 'Train users to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1017'}, {'mitigation id': 'M1032', 'mitigation name': 'Multi-factor Authentication', 'mitigation description': 'Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1032'}, {'mitigation id': 'M1054', 'mitigation name': 'Software Configuration', 'mitigation description': 'Implement configuration changes to software (other than the operating system) to mitigate security risks associated to how the software operates.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1054'}]"
T1552,Unsecured Credentials,"Adversaries may search compromised systems to find and obtain insecurely stored credentials. These credentials can be stored and/or misplaced in many locations on a system, including plaintext files (e.g. [Bash History](https://attack.mitre.org/techniques/T1552/003)), operating system or application-specific repositories (e.g. [Credentials in Registry](https://attack.mitre.org/techniques/T1552/002)), or other specialized files/artifacts (e.g. [Private Keys](https://attack.mitre.org/techniques/T1552/004)).",https://attack.mitre.org/techniques/T1552,04 February 2020,13 April 2023,1.3,['Credential Access'],"While detecting adversaries accessing credentials may be difficult without knowing they exist in the environment, it may be possible to detect adversary use of credentials they have obtained. Monitor the command-line arguments of executing processes for suspicious words or regular expressions that may indicate searching for a password (for example: password, pwd, login, secure, or credentials). See [Valid Accounts](https://attack.mitre.org/techniques/T1078) for more information.

Monitor for suspicious file access activity, specifically indications that a process is reading multiple files in a short amount of time and/or using command-line arguments  indicative of searching for credential material (ex: regex patterns). These may be indicators of automated/scripted credential access behavior.

Monitoring when the user's <code>.bash_history</code> is read can help alert to suspicious activity. While users do typically rely on their history of commands, they often access this history through other utilities like ""history"" instead of commands like <code>cat ~/.bash_history</code>.

Additionally, monitor processes for applications that can be used to query the Registry, such as [Reg](https://attack.mitre.org/software/S0075), and collect command parameters that may indicate credentials are being searched. Correlate activity with related suspicious behavior that may indicate an active intrusion to reduce false positives.","['Azure AD', 'Containers', 'Google Workspace', 'IaaS', 'Linux', 'Network', 'Office 365', 'SaaS', 'Windows', 'macOS']","Application Log: Application Log Content, Command: Command Execution, File: File Access, Process: Process Creation, User Account: User Account Authentication, Windows Registry: Windows Registry Key Access",False,,[],"Austin Clark, @c2defense",,,,,,"(Citation: Cybereason Astaroth Feb 2019),(Citation: MS14-025),(Citation: ADSecurity Finding Passwords in SYSVOL),(Citation: Microsoft MS14-025),(Citation: RedLock Instance Metadata API 2018)","['actor', 'process', 'data store', 'data flow']","[{'mitigation id': 'M1015', 'mitigation name': 'Active Directory Configuration', 'mitigation description': 'Configure Active Directory to prevent use of certain techniques; use SID Filtering, etc.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1015'}, {'mitigation id': 'M1017', 'mitigation name': 'User Training', 'mitigation description': 'Train users to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1017'}, {'mitigation id': 'M1022', 'mitigation name': 'Restrict File and Directory Permissions', 'mitigation description': 'Restrict access by setting directory and file permissions that are not specific to users or privileged accounts.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1022'}, {'mitigation id': 'M1026', 'mitigation name': 'Privileged Account Management', 'mitigation description': 'Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1026'}, {'mitigation id': 'M1027', 'mitigation name': 'Password Policies', 'mitigation description': 'Set and enforce secure password policies for accounts.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1027'}, {'mitigation id': 'M1028', 'mitigation name': 'Operating System Configuration', 'mitigation description': 'Make configuration changes related to the operating system or a common feature of the operating system that result in system hardening against techniques.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1028'}, {'mitigation id': 'M1035', 'mitigation name': 'Limit Access to Resource Over Network', 'mitigation description': 'Prevent access to file shares, remote access to systems, unnecessary services. Mechanisms to limit access may include use of network concentrators, RDP gateways, etc.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1035'}, {'mitigation id': 'M1037', 'mitigation name': 'Filter Network Traffic', 'mitigation description': 'Use network appliances to filter ingress or egress traffic and perform protocol-based filtering. Configure software on endpoints to filter network traffic.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1037'}, {'mitigation id': 'M1041', 'mitigation name': 'Encrypt Sensitive Information', 'mitigation description': 'Protect sensitive information with strong encryption.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1041'}, {'mitigation id': 'M1047', 'mitigation name': 'Audit', 'mitigation description': 'Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1047'}, {'mitigation id': 'M1051', 'mitigation name': 'Update Software', 'mitigation description': 'Perform regular software updates to mitigate exploitation risk.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1051'}]"
T1552.001,Unsecured Credentials: Credentials In Files,"Adversaries may search local file systems and remote file shares for files containing insecurely stored credentials. These can be files created by users to store their own credentials, shared credential stores for a group of individuals, configuration files containing passwords for a system or service, or source code/binary files containing embedded passwords.

It is possible to extract passwords from backups or saved virtual machines through [OS Credential Dumping](https://attack.mitre.org/techniques/T1003). (Citation: CG 2014) Passwords may also be obtained from Group Policy Preferences stored on the Windows Domain Controller. (Citation: SRD GPP)

In cloud and/or containerized environments, authenticated user and service account credentials are often stored in local configuration and credential files.(Citation: Unit 42 Hildegard Malware) They may also be found as parameters to deployment commands in container logs.(Citation: Unit 42 Unsecured Docker Daemons) In some cases, these files can be copied and reused on another machine or the contents can be read and then used to authenticate without needing to copy any files.(Citation: Specter Ops - Cloud Credential Storage)",https://attack.mitre.org/techniques/T1552/001,04 February 2020,30 March 2023,1.1,['Credential Access'],"While detecting adversaries accessing these files may be difficult without knowing they exist in the first place, it may be possible to detect adversary use of credentials they have obtained. Monitor the command-line arguments of executing processes for suspicious words or regular expressions that may indicate searching for a password (for example: password, pwd, login, secure, or credentials). See [Valid Accounts](https://attack.mitre.org/techniques/T1078) for more information.","['Containers', 'IaaS', 'Linux', 'Windows', 'macOS']","Command: Command Execution, File: File Access",True,T1552,,"Jay Chen, Palo Alto Networks; Microsoft Threat Intelligence Center (MSTIC); Rory McCune, Aqua Security; Vishwas Manral, McAfee; Yossi Weizman, Azure Defender Research Team","['Administrator', 'SYSTEM', 'User']",,Access to files,,,"(Citation: Unit42 Azorult Nov 2018),(Citation: GitHub QuasarRAT),(Citation: FireEye APT35 2018),(Citation: Kaspersky Adwind Feb 2016),(Citation: Symantec Elfin Mar 2019),(Citation: GitHub LaZagne Dec 2018),(Citation: FireEye APT34 July 2019),(Citation: AADInternals Documentation),(Citation: Symantec Buckeye),(Citation: CISA AA20-259A Iran-Based Actor September 2020),(Citation: FireEye APT33 Guardrail),(Citation: Cyberreason Anchor December 2019),(Citation: Unit 42 Hildegard Malware),(Citation: Symantec MuddyWater Dec 2018),(Citation: Trend Micro Trickbot Nov 2018),(Citation: TrendMicro Trickbot Feb 2019),(Citation: Unit42 OilRig Playbook 2023),(Citation: SentinelLabs Agent Tesla Aug 2020),(Citation: F-Secure BlackEnergy 2014),(Citation: CIS Emotet Dec 2018),(Citation: CrowdStrike Putter Panda),(Citation: Symantec Leafminer July 2018),(Citation: Proofpoint TA505 Sep 2017),(Citation: CERT-FR PYSA April 2020),(Citation: Volexity Patchwork June 2018),(Citation: Netscout Stolen Pencil Dec 2018),(Citation: Cisco Talos Intelligence Group),(Citation: Securelist BlackEnergy Nov 2014),(Citation: FireEye APT34 Webinar Dec 2017),(Citation: Github PowerShell Empire),(Citation: GitHub PoshC2),(Citation: Invincea XTunnel),(Citation: Talos Smoke Loader July 2018),(Citation: US-CERT Emotet Jul 2018),(Citation: Cado Security TeamTNT Worm August 2020),(Citation: Trend Micro TeamTNT),(Citation: GitHub Pupy),","['actor', 'process', 'data store', 'data flow']","[{'mitigation id': 'M1017', 'mitigation name': 'User Training', 'mitigation description': 'Train users to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1017'}, {'mitigation id': 'M1022', 'mitigation name': 'Restrict File and Directory Permissions', 'mitigation description': 'Restrict access by setting directory and file permissions that are not specific to users or privileged accounts.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1022'}, {'mitigation id': 'M1027', 'mitigation name': 'Password Policies', 'mitigation description': 'Set and enforce secure password policies for accounts.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1027'}, {'mitigation id': 'M1047', 'mitigation name': 'Audit', 'mitigation description': 'Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1047'}]"
T1552.003,Unsecured Credentials: Bash History,"Adversaries may search the bash command history on compromised systems for insecurely stored credentials. Bash keeps track of the commands users type on the command-line with the ""history"" utility. Once a user logs out, the history is flushed to the user’s <code>.bash_history</code> file. For each user, this file resides at the same location: <code>~/.bash_history</code>. Typically, this file keeps track of the user’s last 500 commands. Users often type usernames and passwords on the command-line as parameters to programs, which then get saved to this file when they log out. Adversaries can abuse this by looking through the file for potential credentials. (Citation: External to DA, the OS X Way)",https://attack.mitre.org/techniques/T1552/003,04 February 2020,08 March 2022,1.1,['Credential Access'],"Monitoring when the user's <code>.bash_history</code> is read can help alert to suspicious activity. While users do typically rely on their history of commands, they often access this history through other utilities like ""history"" instead of commands like <code>cat ~/.bash_history</code>.","['Linux', 'macOS']","Command: Command Execution, File: File Access",True,T1552,,,['User'],,,,,"(Citation: Aqua Kinsing April 2020),","['actor', 'process', 'data store', 'data flow']","[{'mitigation id': 'M1028', 'mitigation name': 'Operating System Configuration', 'mitigation description': 'Make configuration changes related to the operating system or a common feature of the operating system that result in system hardening against techniques.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1028'}]"
T1552.004,Unsecured Credentials: Private Keys,"Adversaries may search for private key certificate files on compromised systems for insecurely stored credentials. Private cryptographic keys and certificates are used for authentication, encryption/decryption, and digital signatures.(Citation: Wikipedia Public Key Crypto) Common key and certificate file extensions include: .key, .pgp, .gpg, .ppk., .p12, .pem, .pfx, .cer, .p7b, .asc. 

Adversaries may also look in common key directories, such as <code>~/.ssh</code> for SSH keys on * nix-based systems or <code>C:&#92;Users&#92;(username)&#92;.ssh&#92;</code> on Windows. Adversary tools may also search compromised systems for file extensions relating to cryptographic keys and certificates.(Citation: Kaspersky Careto)(Citation: Palo Alto Prince of Persia)

When a device is registered to Azure AD, a device key and a transport key are generated and used to verify the device’s identity.(Citation: Microsoft Primary Refresh Token) An adversary with access to the device may be able to export the keys in order to impersonate the device.(Citation: AADInternals Azure AD Device Identities)

On network devices, private keys may be exported via [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) commands such as `crypto pki export`.(Citation: cisco_deploy_rsa_keys) 

Some private keys require a password or passphrase for operation, so an adversary may also use [Input Capture](https://attack.mitre.org/techniques/T1056) for keylogging or attempt to [Brute Force](https://attack.mitre.org/techniques/T1110) the passphrase off-line. These private keys can be used to authenticate to [Remote Services](https://attack.mitre.org/techniques/T1021) like SSH or for use in decrypting other collected files such as email.",https://attack.mitre.org/techniques/T1552/004,04 February 2020,12 April 2023,1.1,['Credential Access'],"Monitor access to files and directories related to cryptographic keys and certificates as a means for potentially detecting access patterns that may indicate collection and exfiltration activity. Collect authentication logs and look for potentially abnormal activity that may indicate improper use of keys or certificates for remote authentication. For network infrastructure devices, collect AAA logging to monitor for private keys being exported.","['Linux', 'Network', 'Windows', 'macOS']","Command: Command Execution, File: File Access",True,T1552,,"Austin Clark, @c2defense; Itzik Kotler, SafeBreach",,,,,,"(Citation: Adsecurity Mimikatz Guide),(Citation: ESET Ebury Feb 2014),(Citation: Anomali Rocke March 2019),(Citation: MSTIC FoggyWeb September 2021),(Citation: ESET Machete July 2019),(Citation: Github PowerShell Empire),(Citation: FoxIT Wocao December 2019),(Citation: Cybersecurity Advisory SVR TTP May 2021),(Citation: Kaspersky Adwind Feb 2016),(Citation: AADInternals Documentation),(Citation: Microsoft 365 Defender Solorigate),(Citation: Aqua Kinsing April 2020),(Citation: SentinelLabs Metador Sept 2022),(Citation: Unit 42 Hildegard Malware),(Citation: Cado Security TeamTNT Worm August 2020),(Citation: Trend Micro TeamTNT),(Citation: cisco_deploy_rsa_keys),(Citation: Microsoft Primary Refresh Token)","['actor', 'process', 'data store', 'data flow']","[{'mitigation id': 'M1022', 'mitigation name': 'Restrict File and Directory Permissions', 'mitigation description': 'Restrict access by setting directory and file permissions that are not specific to users or privileged accounts.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1022'}, {'mitigation id': 'M1027', 'mitigation name': 'Password Policies', 'mitigation description': 'Set and enforce secure password policies for accounts.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1027'}, {'mitigation id': 'M1041', 'mitigation name': 'Encrypt Sensitive Information', 'mitigation description': 'Protect sensitive information with strong encryption.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1041'}, {'mitigation id': 'M1047', 'mitigation name': 'Audit', 'mitigation description': 'Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1047'}]"
T1555,Credentials from Password Stores,"Adversaries may search for common password storage locations to obtain user credentials. Passwords are stored in several places on a system, depending on the operating system or application holding the credentials. There are also specific applications that store passwords to make it easier for users manage and maintain. Once credentials are obtained, they can be used to perform lateral movement and access restricted information.",https://attack.mitre.org/techniques/T1555,11 February 2020,01 April 2022,1.0,['Credential Access'],"Monitor system calls, file read events, and processes for suspicious activity that could indicate searching for a password  or other activity related to performing keyword searches (e.g. password, pwd, login, store, secure, credentials, etc.) in process memory for credentials. File read events should be monitored surrounding known password storage applications.","['Linux', 'Windows', 'macOS']","Command: Command Execution, File: File Access, Process: OS API Execution, Process: Process Access, Process: Process Creation",False,,[],,['Administrator'],,,,,"(Citation: Cybereason Kimsuky November 2020),(Citation: GitHub QuasarRAT),(Citation: FireEye APT35 2018),(Citation: Symantec Elfin Mar 2019),(Citation: Trend Micro Muddy Water March 2021),(Citation: FireEye APT34 July 2019),(Citation: Malwarebytes Agent Tesla April 2020),(Citation: FireEye APT33 Guardrail),(Citation: Unit 42 MuddyWater Nov 2017),(Citation: ESET EvilNum July 2020),(Citation: Symantec MuddyWater Dec 2018),(Citation: FireEye APT28),(Citation: Prevx Carberp March 2011),(Citation: CopyKittens Nov 2015),(Citation: Red Canary NETWIRE January 2020),(Citation: F-Secure The Dukes),(Citation: Unit42 OilRig Playbook 2023),(Citation: SecureWorks August 2019),(Citation: ESET Operation Groundbait),(Citation: Kaspersky Lyceum October 2021),(Citation: Visa FIN6 Feb 2019),(Citation: Symantec Leafminer July 2018),(Citation: Volexity Patchwork June 2018),(Citation: Cybereason Astaroth Feb 2019),(Citation: FireEye APT34 Webinar Dec 2017),(Citation: BitDefender Chafer May 2020),(Citation: GitHub Mimikatz lsadump Module),(Citation: NCSC Joint Report Public Tools),(Citation: Directory Services Internals DPAPI Backup Keys Oct 2015),(Citation: Microsoft Deep Dive Solorigate January 2021),(Citation: Infoblox Lokibot January 2019),(Citation: ClearSky Wilted Tulip July 2017),(Citation: Deply Mimikatz),(Citation: Cobalt Strike Manual 4.3 November 2020),(Citation: GitHub LaZagne Dec 2018),(Citation: GitHub Pupy),(Citation: Citizen Lab Stealth Falcon May 2016),(Citation: ESET PLEAD Malware July 2018),","['actor', 'process', 'data store', 'data flow']","[{'mitigation id': 'M1027', 'mitigation name': 'Password Policies', 'mitigation description': 'Set and enforce secure password policies for accounts.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1027'}]"
T1555.002,Credentials from Password Stores: Securityd Memory,"An adversary may obtain root access (allowing them to read securityd’s memory), then they can scan through memory to find the correct sequence of keys in relatively few tries to decrypt the user’s logon keychain. This provides the adversary with all the plaintext passwords for users, WiFi, mail, browsers, certificates, secure notes, etc.(Citation: OS X Keychain)(Citation: OSX Keydnap malware)

In OS X prior to El Capitan, users with root access can read plaintext keychain passwords of logged-in users because Apple’s keychain implementation allows these credentials to be cached so that users are not repeatedly prompted for passwords.(Citation: OS X Keychain)(Citation: External to DA, the OS X Way) Apple’s securityd utility takes the user’s logon password, encrypts it with PBKDF2, and stores this master key in memory. Apple also uses a set of keys and algorithms to encrypt the user’s password, but once the master key is found, an adversary need only iterate over the other values to unlock the final password.(Citation: OS X Keychain)",https://attack.mitre.org/techniques/T1555/002,12 February 2020,08 March 2022,1.1,['Credential Access'],Monitor processes and command-line arguments for activity surrounded users searching for credentials or using automated tools to scan memory for passwords.,"['Linux', 'macOS']","Command: Command Execution, Process: Process Access",True,T1555,,,['root'],,,,,"(Citation: synack 2016 review),","['actor', 'process', 'data store', 'data flow']",
T1555.003,Credentials from Password Stores: Credentials from Web Browsers,"Adversaries may acquire credentials from web browsers by reading files specific to the target browser.(Citation: Talos Olympic Destroyer 2018) Web browsers commonly save credentials such as website usernames and passwords so that they do not need to be entered manually in the future. Web browsers typically store the credentials in an encrypted format within a credential store; however, methods exist to extract plaintext credentials from web browsers.

For example, on Windows systems, encrypted credentials may be obtained from Google Chrome by reading a database file, <code>AppData\Local\Google\Chrome\User Data\Default\Login Data</code> and executing a SQL query: <code>SELECT action_url, username_value, password_value FROM logins;</code>. The plaintext password can then be obtained by passing the encrypted credentials to the Windows API function <code>CryptUnprotectData</code>, which uses the victim’s cached logon credentials as the decryption key.(Citation: Microsoft CryptUnprotectData April 2018)
 
Adversaries have executed similar procedures for common web browsers such as FireFox, Safari, Edge, etc.(Citation: Proofpoint Vega Credential Stealer May 2018)(Citation: FireEye HawkEye Malware July 2017) Windows stores Internet Explorer and Microsoft Edge credentials in Credential Lockers managed by the [Windows Credential Manager](https://attack.mitre.org/techniques/T1555/004).

Adversaries may also acquire credentials by searching web browser process memory for patterns that commonly match credentials.(Citation: GitHub Mimikittenz July 2016)

After acquiring credentials from web browsers, adversaries may attempt to recycle the credentials across different systems and/or accounts in order to expand access. This can result in significantly furthering an adversary's objective in cases where credentials gained from web browsers overlap with privileged accounts (e.g. domain administrator).",https://attack.mitre.org/techniques/T1555/003,12 February 2020,15 February 2022,1.1,['Credential Access'],"Identify web browser files that contain credentials such as Google Chrome’s Login Data database file: <code>AppData\Local\Google\Chrome\User Data\Default\Login Data</code>. Monitor file read events of web browser files that contain credentials, especially when the reading process is unrelated to the subject web browser. Monitor process execution logs to include PowerShell Transcription focusing on those that perform a combination of behaviors including reading web browser process memory, utilizing regular expressions, and those that contain numerous keywords for common web applications (Gmail, Twitter, Office365, etc.).","['Linux', 'Windows', 'macOS']","Command: Command Execution, File: File Access, Process: OS API Execution, Process: Process Access",True,T1555,,"Barry Shteiman, Exabeam; RedHuntLabs, @redhuntlabs; Ryan Benson, Exabeam; Sylvain Gil, Exabeam",['User'],,,,,"(Citation: Cybereason Kimsuky November 2020),(Citation: GitHub QuasarRAT),(Citation: Talos Kimsuky Nov 2021),(Citation: IBM IcedID November 2017),(Citation: Kaspersky Adwind Feb 2016),(Citation: Trend Micro Muddy Water March 2021),(Citation: Proofpoint NETWIRE December 2020),(Citation: Citizen Lab Group5),(Citation: CrowdStrike StellarParticle January 2022),(Citation: Trend Micro Emotet Jan 2019),(Citation: Talos Olympic Destroyer 2018),(Citation: Visa FIN6 Feb 2019),(Citation: Check Point Rocket Kitten),(Citation: MSTIC DEV-0537 Mar 2022),(Citation: Infoblox Lokibot January 2019),(Citation: Bitdefender Agent Tesla April 2020),(Citation: BiZone Lizar May 2021),(Citation: Talos Smoke Loader July 2018),(Citation: Bitdefender Trickbot VNC module Whitepaper 2021),(Citation: GitHub LaZagne Dec 2018),(Citation: Uptycs Warzone UAC Bypass November 2020),(Citation: ESET PLEAD Malware July 2018),(Citation: Bitdefender Naikon April 2021),(Citation: Talos Konni May 2017),(Citation: GitHub SILENTTRINITY Modules July 2019),(Citation: Volexity InkySquid BLUELIGHT August 2021),(Citation: FireEye APT34 July 2019),(Citation: Talos PoetRAT April 2020),(Citation: objsee mac malware 2017),(Citation: Proofpoint Operation Transparent Tribe March 2016),(Citation: Secureworks Karagany July 2019),(Citation: FireEye APT37 Feb 2018),(Citation: FireEye APT28),(Citation: Prevx Carberp March 2011),(Citation: Unit42 CookieMiner Jan 2019),(Citation: Zscaler APT31 Covid-19 October 2020),(Citation: TrendMicro BlackTech June 2017),(Citation: Check Point Warzone Feb 2020),(Citation: Volexity Patchwork June 2018),(Citation: FireEye APT34 Webinar Dec 2017),(Citation: NCSC Joint Report Public Tools),(Citation: ESET Grandoreiro April 2020),(Citation: Cymmetria Patchwork),(Citation: FireEye NETWIRE March 2019),(Citation: Securelist BlackEnergy Nov 2014),(Citation: GitHub Pupy),(Citation: Citizen Lab Stealth Falcon May 2016),(Citation: Kaspersky QakBot September 2021),(Citation: FireEye APT35 2018),(Citation: Symantec Elfin Mar 2019),(Citation: CISA AA20-301A Kimsuky),(Citation: FireEye APT33 Guardrail),(Citation: Cyberreason Anchor December 2019),(Citation: ESET Telebots Dec 2016),(Citation: Trend Micro Trickbot Nov 2018),(Citation: Red Canary NETWIRE January 2020),(Citation: PWC Cloud Hopper Technical Annex April 2017),(Citation: Unit42 OilRig Playbook 2023),(Citation: Rapid7 KeyBoy Jun 2013),(Citation: Symantec Dragonfly),(Citation: JPCert TSCookie March 2018),(Citation: Trend Micro njRAT 2018),(Citation: Securelist Brazilian Banking Malware July 2020),(Citation: Proofpoint TA505 Sep 2017),(Citation: Netscout Stolen Pencil Dec 2018),(Citation: GitHub Mimikatz lsadump Module),(Citation: XAgentOSX 2017),(Citation: Unit42 Azorult Nov 2018),(Citation: Symantec Inception Framework March 2018),(Citation: Symantec Buckeye),(Citation: Forcepoint Monsoon),(Citation: Zdnet Kimsuky Dec 2018),(Citation: Symantec MuddyWater Dec 2018),(Citation: QiAnXin APT-C-36 Feb2019),(Citation: Fidelis njRAT June 2013),(Citation: Cybereason Chaes Nov 2020),(Citation: ESET Zebrocy May 2019),(Citation: F-Secure The Dukes),(Citation: F-Secure BlackEnergy 2014),(Citation: ESET Machete July 2019),(Citation: Talos Group123),(Citation: ESET Operation Groundbait),(Citation: Kaspersky Lyceum October 2021),(Citation: Mandiant UNC3890 Aug 2022),(Citation: Symantec Leafminer July 2018),(Citation: Github PowerShell Empire),(Citation: IBM Grandoreiro April 2020),(Citation: Deply Mimikatz),(Citation: Directory Services Internals DPAPI Backup Keys Oct 2015),(Citation: Kaspersky Transparent Tribe August 2020),(Citation: DustySky),(Citation: Accenture Hogfish April 2018),(Citation: Cisco H1N1 Part 2),","['actor', 'process', 'data store', 'data flow']","[{'mitigation id': 'M1027', 'mitigation name': 'Password Policies', 'mitigation description': 'Set and enforce secure password policies for accounts.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1027'}]"
T1555.005,Credentials from Password Stores: Password Managers,"Adversaries may acquire user credentials from third-party password managers.(Citation: ise Password Manager February 2019) Password managers are applications designed to store user credentials, normally in an encrypted database. Credentials are typically accessible after a user provides a master password that unlocks the database. After the database is unlocked, these credentials may be copied to memory. These databases can be stored as files on disk.(Citation: ise Password Manager February 2019)

Adversaries may acquire user credentials from password managers by extracting the master password and/or plain-text credentials from memory.(Citation: FoxIT Wocao December 2019)(Citation: Github KeeThief) Adversaries may extract credentials from memory via [Exploitation for Credential Access](https://attack.mitre.org/techniques/T1212).(Citation: NVD CVE-2019-3610)
 Adversaries may also try brute forcing via [Password Guessing](https://attack.mitre.org/techniques/T1110/001) to obtain the master password of a password manager.(Citation: Cyberreason Anchor December 2019)",https://attack.mitre.org/techniques/T1555/005,22 January 2021,25 March 2022,1.0,['Credential Access'],"Consider monitoring API calls, file read events, and processes for suspicious activity that could indicate searching in process memory of password managers. 

Consider monitoring file reads surrounding known password manager applications.","['Linux', 'Windows', 'macOS']","Command: Command Execution, File: File Access, Process: OS API Execution, Process: Process Access",True,T1555,,"Matt Burrough, @mattburrough, Microsoft",['User'],,,,,"(Citation: Kaspersky Ferocious Kitten Jun 2021),(Citation: FoxIT Wocao December 2019),(Citation: Trend Micro DRBControl February 2020),(Citation: CISA AA20-259A Iran-Based Actor September 2020),(Citation: Cyberreason Anchor December 2019),(Citation: objsee mac malware 2017),(Citation: NIST 800-63-3)","['actor', 'process', 'data store', 'data flow']","[{'mitigation id': 'M1027', 'mitigation name': 'Password Policies', 'mitigation description': 'Set and enforce secure password policies for accounts.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1027'}, {'mitigation id': 'M1051', 'mitigation name': 'Update Software', 'mitigation description': 'Perform regular software updates to mitigate exploitation risk.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1051'}, {'mitigation id': 'M1054', 'mitigation name': 'Software Configuration', 'mitigation description': 'Implement configuration changes to software (other than the operating system) to mitigate security risks associated to how the software operates.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1054'}]"
T1556,Modify Authentication Process,"Adversaries may modify authentication mechanisms and processes to access user credentials or enable otherwise unwarranted access to accounts. The authentication process is handled by mechanisms, such as the Local Security Authentication Server (LSASS) process and the Security Accounts Manager (SAM) on Windows, pluggable authentication modules (PAM) on Unix-based systems, and authorization plugins on MacOS systems, responsible for gathering, storing, and validating credentials. By modifying an authentication process, an adversary may be able to authenticate to a service or system without using [Valid Accounts](https://attack.mitre.org/techniques/T1078).

Adversaries may maliciously modify a part of this process to either reveal credentials or bypass authentication mechanisms. Compromised credentials or access may be used to bypass access controls placed on various resources on systems within the network and may even be used for persistent access to remote systems and externally available services, such as VPNs, Outlook Web Access and remote desktop.",https://attack.mitre.org/techniques/T1556,11 February 2020,11 April 2023,2.3,"['Credential Access', 'Defense Evasion', 'Persistence']","Monitor for new, unfamiliar DLL files written to a domain controller and/or local computer. Monitor for changes to Registry entries for password filters (ex: <code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa\Notification Packages</code>) and correlate then investigate the DLL files these files reference. 

Password filters will also show up as an autorun and loaded DLL in lsass.exe.(Citation: Clymb3r Function Hook Passwords Sept 2013)

Monitor for calls to <code>OpenProcess</code> that can be used to manipulate lsass.exe running on a domain controller as well as for malicious modifications to functions exported from authentication-related system DLLs (such as cryptdll.dll and samsrv.dll).(Citation: Dell Skeleton) 

Monitor PAM configuration and module paths (ex: <code>/etc/pam.d/</code>) for changes. Use system-integrity tools such as AIDE and monitoring tools such as auditd to monitor PAM files.

Monitor for suspicious additions to the /Library/Security/SecurityAgentPlugins directory.(Citation: Xorrior Authorization Plugins)

Configure robust, consistent account activity audit policies across the enterprise and with externally accessible services. (Citation: TechNet Audit Policy) Look for suspicious account behavior across systems that share accounts, either user, admin, or service accounts. Examples: one account logged into multiple systems simultaneously; multiple accounts logged into the same machine simultaneously; accounts logged in at odd times or outside of business hours. Activity may be from interactive login sessions or process ownership from accounts being used to execute binaries on a remote system as a particular account. Correlate other security systems with login information (e.g., a user has an active login session but has not entered the building or does not have VPN access).

Monitor property changes in Group Policy that manage authentication mechanisms (i.e. [Group Policy Modification](https://attack.mitre.org/techniques/T1484/001)). The <code>Store passwords using reversible encryption</code> configuration should be set to Disabled. Additionally, monitor and/or block suspicious command/script execution of <code>-AllowReversiblePasswordEncryption $true</code>, <code>Set-ADUser</code> and <code>Set-ADAccountControl</code>. Finally, monitor Fine-Grained Password Policies and regularly audit user accounts and group settings.(Citation: dump_pwd_dcsync)
","['Azure AD', 'Google Workspace', 'IaaS', 'Linux', 'Network', 'Office 365', 'SaaS', 'Windows', 'macOS']","Active Directory: Active Directory Object Modification, Application Log: Application Log Content, File: File Creation, File: File Modification, Logon Session: Logon Session Creation, Module: Module Load, Process: OS API Execution, Process: Process Access, User Account: User Account Authentication, User Account: User Account Modification, Windows Registry: Windows Registry Key Creation, Windows Registry: Windows Registry Key Modification",False,,['Multi-Factor Authentication'],Chris Ross @xorrior,,,,,,"(Citation: ESET Ebury Feb 2014),(Citation: GitHub SILENTTRINITY Modules July 2019),(Citation: ESET ForSSHe December 2018),(Citation: TechNet Least Privilege),(Citation: Mandiant Azure AD Backdoors),(Citation: Microsoft Securing Privileged Access),(Citation: Microsoft LSA),(Citation: TechNet Credential Theft),(Citation: store_pwd_rev_enc),(Citation: MagicWeb),(Citation: EnableMPRNotifications)","['actor', 'process', 'data store', 'data flow']","[{'mitigation id': 'M1018', 'mitigation name': 'User Account Management', 'mitigation description': 'Manage the creation, modification, use, and permissions associated to user accounts.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1018'}, {'mitigation id': 'M1022', 'mitigation name': 'Restrict File and Directory Permissions', 'mitigation description': 'Restrict access by setting directory and file permissions that are not specific to users or privileged accounts.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1022'}, {'mitigation id': 'M1024', 'mitigation name': 'Restrict Registry Permissions', 'mitigation description': 'Restrict the ability to modify certain hives or keys in the Windows Registry.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1024'}, {'mitigation id': 'M1025', 'mitigation name': 'Privileged Process Integrity', 'mitigation description': 'Protect processes with high privileges that can be used to interact with critical system components through use of protected process light, anti-process injection defenses, or other process integrity enforcement measures.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1025'}, {'mitigation id': 'M1026', 'mitigation name': 'Privileged Account Management', 'mitigation description': 'Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1026'}, {'mitigation id': 'M1027', 'mitigation name': 'Password Policies', 'mitigation description': 'Set and enforce secure password policies for accounts.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1027'}, {'mitigation id': 'M1028', 'mitigation name': 'Operating System Configuration', 'mitigation description': 'Make configuration changes related to the operating system or a common feature of the operating system that result in system hardening against techniques.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1028'}, {'mitigation id': 'M1032', 'mitigation name': 'Multi-factor Authentication', 'mitigation description': 'Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1032'}, {'mitigation id': 'M1047', 'mitigation name': 'Audit', 'mitigation description': 'Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1047'}]"
T1556.003,Modify Authentication Process: Pluggable Authentication Modules,"Adversaries may modify pluggable authentication modules (PAM) to access user credentials or enable otherwise unwarranted access to accounts. PAM is a modular system of configuration files, libraries, and executable files which guide authentication for many services. The most common authentication module is <code>pam_unix.so</code>, which retrieves, sets, and verifies account authentication information in <code>/etc/passwd</code> and <code>/etc/shadow</code>.(Citation: Apple PAM)(Citation: Man Pam_Unix)(Citation: Red Hat PAM)

Adversaries may modify components of the PAM system to create backdoors. PAM components, such as <code>pam_unix.so</code>, can be patched to accept arbitrary adversary supplied values as legitimate credentials.(Citation: PAM Backdoor)

Malicious modifications to the PAM system may also be abused to steal credentials. Adversaries may infect PAM resources with code to harvest user credentials, since the values exchanged with PAM components may be plain-text since PAM does not store passwords.(Citation: PAM Creds)(Citation: Apple PAM)",https://attack.mitre.org/techniques/T1556/003,26 June 2020,17 October 2021,2.0,"['Credential Access', 'Defense Evasion', 'Persistence']","Monitor PAM configuration and module paths (ex: <code>/etc/pam.d/</code>) for changes. Use system-integrity tools such as AIDE and monitoring tools such as auditd to monitor PAM files.

Look for suspicious account behavior across systems that share accounts, either user, admin, or service accounts. Examples: one account logged into multiple systems simultaneously; multiple accounts logged into the same machine simultaneously; accounts logged in at odd times (ex: when the user is not present) or outside of business hours. Activity may be from interactive login sessions or process ownership from accounts being used to execute binaries on a remote system as a particular account. Correlate other security systems with login information (e.g., a user has an active login session but has not entered the building or does not have VPN access).","['Linux', 'macOS']","File: File Modification, Logon Session: Logon Session Creation",True,T1556,,"George Allen, VMware Carbon Black; Scott Knight, @sdotknight, VMware Carbon Black",['root'],,,,,"(Citation: ESET Ebury Oct 2017),(Citation: Trend Micro Skidmap),","['actor', 'process', 'data store', 'data flow']","[{'mitigation id': 'M1026', 'mitigation name': 'Privileged Account Management', 'mitigation description': 'Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1026'}, {'mitigation id': 'M1032', 'mitigation name': 'Multi-factor Authentication', 'mitigation description': 'Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1032'}]"
T1556.006,Modify Authentication Process: Multi-Factor Authentication,"Adversaries may disable or modify multi-factor authentication (MFA) mechanisms to enable persistent access to compromised accounts.

Once adversaries have gained access to a network by either compromising an account lacking MFA or by employing an MFA bypass method such as [Multi-Factor Authentication Request Generation](https://attack.mitre.org/techniques/T1621), adversaries may leverage their access to modify or completely disable MFA defenses. This can be accomplished by abusing legitimate features, such as excluding users from Azure AD Conditional Access Policies, registering a new yet vulnerable/adversary-controlled MFA method, or by manually patching MFA programs and configuration files to bypass expected functionality.(Citation: Mandiant APT42)(Citation: Azure AD Conditional Access Exclusions)

For example, modifying the Windows hosts file (`C:\windows\system32\drivers\etc\hosts`) to redirect MFA calls to localhost instead of an MFA server may cause the MFA process to fail. If a ""fail open"" policy is in place, any otherwise successful authentication attempt may be granted access without enforcing MFA. (Citation: Russians Exploit Default MFA Protocol - CISA March 2022) 

Depending on the scope, goals, and privileges of the adversary, MFA defenses may be disabled for individual accounts or for all accounts tied to a larger group, such as all domain accounts in a victim's network environment.(Citation: Russians Exploit Default MFA Protocol - CISA March 2022) ",https://attack.mitre.org/techniques/T1556/006,31 May 2022,09 February 2023,1.0,"['Credential Access', 'Defense Evasion', 'Persistence']",,"['Azure AD', 'Google Workspace', 'IaaS', 'Linux', 'Office 365', 'SaaS', 'Windows', 'macOS']","Active Directory: Active Directory Object Modification, Logon Session: Logon Session Creation, User Account: User Account Authentication, User Account: User Account Modification",True,T1556,['Multi-Factor Authentication'],"Liran Ravich, CardinalOps; Muhammad Moiz Arshad, @5T34L7H",,,,,,",","['actor', 'process', 'data store', 'data flow']","[{'mitigation id': 'M1018', 'mitigation name': 'User Account Management', 'mitigation description': 'Manage the creation, modification, use, and permissions associated to user accounts.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1018'}, {'mitigation id': 'M1032', 'mitigation name': 'Multi-factor Authentication', 'mitigation description': 'Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1032'}, {'mitigation id': 'M1047', 'mitigation name': 'Audit', 'mitigation description': 'Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1047'}]"
T1557,Adversary-in-the-Middle,"Adversaries may attempt to position themselves between two or more networked devices using an adversary-in-the-middle (AiTM) technique to support follow-on behaviors such as [Network Sniffing](https://attack.mitre.org/techniques/T1040) or [Transmitted Data Manipulation](https://attack.mitre.org/techniques/T1565/002). By abusing features of common networking protocols that can determine the flow of network traffic (e.g. ARP, DNS, LLMNR, etc.), adversaries may force a device to communicate through an adversary controlled system so they can collect information or perform additional actions.(Citation: Rapid7 MiTM Basics)

For example, adversaries may manipulate victim DNS settings to enable other malicious activities such as preventing/redirecting users from accessing legitimate sites and/or pushing additional malware.(Citation: ttint_rat)(Citation: dns_changer_trojans)(Citation: ad_blocker_with_miner) Adversaries may also manipulate DNS and leverage their position in order to intercept user credentials and session cookies.(Citation: volexity_0day_sophos_FW) [Downgrade Attack](https://attack.mitre.org/techniques/T1562/010)s can also be used to establish an AiTM position, such as by negotiating a less secure, deprecated, or weaker version of communication protocol (SSL/TLS) or encryption algorithm.(Citation: mitm_tls_downgrade_att)(Citation: taxonomy_downgrade_att_tls)(Citation: tlseminar_downgrade_att)

Adversaries may also leverage the AiTM position to attempt to monitor and/or modify traffic, such as in [Transmitted Data Manipulation](https://attack.mitre.org/techniques/T1565/002). Adversaries can setup a position similar to AiTM to prevent traffic from flowing to the appropriate destination, potentially to [Impair Defenses](https://attack.mitre.org/techniques/T1562) and/or in support of a [Network Denial of Service](https://attack.mitre.org/techniques/T1498).",https://attack.mitre.org/techniques/T1557,11 February 2020,30 March 2023,2.2,"['Collection', 'Credential Access']",Monitor network traffic for anomalies associated with known AiTM behavior. Consider monitoring for modifications to system configuration files involved in shaping network traffic flow.,"['Linux', 'Network', 'Windows', 'macOS']","Application Log: Application Log Content, Network Traffic: Network Traffic Content, Network Traffic: Network Traffic Flow, Service: Service Creation, Windows Registry: Windows Registry Key Modification",False,,[],"Daniil Yugoslavskiy, @yugoslavskiy, Atomic Threat Coverage project; Mayuresh Dani, Qualys; NEC",,,,,,"(Citation: CISA AA20-301A Kimsuky),(Citation: objsee mac malware 2017),(Citation: CheckPoint Dok),","['actor', 'process', 'data store', 'data flow']","[{'mitigation id': 'M1017', 'mitigation name': 'User Training', 'mitigation description': 'Train users to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1017'}, {'mitigation id': 'M1030', 'mitigation name': 'Network Segmentation', 'mitigation description': 'Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network. Configure separate virtual private cloud (VPC) instances to isolate critical cloud systems.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1030'}, {'mitigation id': 'M1031', 'mitigation name': 'Network Intrusion Prevention', 'mitigation description': 'Use intrusion detection signatures to block traffic at network boundaries.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1031'}, {'mitigation id': 'M1035', 'mitigation name': 'Limit Access to Resource Over Network', 'mitigation description': 'Prevent access to file shares, remote access to systems, unnecessary services. Mechanisms to limit access may include use of network concentrators, RDP gateways, etc.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1035'}, {'mitigation id': 'M1037', 'mitigation name': 'Filter Network Traffic', 'mitigation description': 'Use network appliances to filter ingress or egress traffic and perform protocol-based filtering. Configure software on endpoints to filter network traffic.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1037'}, {'mitigation id': 'M1041', 'mitigation name': 'Encrypt Sensitive Information', 'mitigation description': 'Protect sensitive information with strong encryption.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1041'}, {'mitigation id': 'M1042', 'mitigation name': 'Disable or Remove Feature or Program', 'mitigation description': 'Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1042'}]"
T1557.002,Adversary-in-the-Middle: ARP Cache Poisoning,"Adversaries may poison Address Resolution Protocol (ARP) caches to position themselves between the communication of two or more networked devices. This activity may be used to enable follow-on behaviors such as [Network Sniffing](https://attack.mitre.org/techniques/T1040) or [Transmitted Data Manipulation](https://attack.mitre.org/techniques/T1565/002).

The ARP protocol is used to resolve IPv4 addresses to link layer addresses, such as a media access control (MAC) address.(Citation: RFC826 ARP) Devices in a local network segment communicate with each other by using link layer addresses. If a networked device does not have the link layer address of a particular networked device, it may send out a broadcast ARP request to the local network to translate the IP address to a MAC address. The device with the associated IP address directly replies with its MAC address. The networked device that made the ARP request will then use as well as store that information in its ARP cache.

ull adversary may passively wait for an ARP request to poison the ARP cache of the requesting device. The adversary may reply with their MAC address, thus deceiving the victim by making them believe that they are communicating with the intended networked device. For the adversary to poison the ARP cache, their reply must be faster than the one made by the legitimate IP address owner. Adversaries may also send a gratuitous ARP reply that maliciously announces the ownership of a particular IP address to all the devices in the local network segment.

The ARP protocol is stateless and does not require authentication. Therefore, devices may wrongly add or update the MAC address of the IP address in their ARP cache.(Citation: Sans ARP Spoofing Aug 2003)(Citation: Cylance Cleaver)

Adversaries may use ARP cache poisoning as a means to intercept network traffic. This activity may be used to collect and/or relay data such as credentials, especially those sent over an insecure, unencrypted protocol.(Citation: Sans ARP Spoofing Aug 2003)
",https://attack.mitre.org/techniques/T1557/002,15 October 2020,22 July 2022,1.1,"['Collection', 'Credential Access']","Monitor network traffic for unusual ARP traffic, gratuitous ARP replies may be suspicious. 

Consider collecting changes to ARP caches across endpoints for signs of ARP poisoning. For example, if multiple IP addresses map to a single MAC address, this could be an indicator that the ARP cache has been poisoned.","['Linux', 'Windows', 'macOS']","Network Traffic: Network Traffic Content, Network Traffic: Network Traffic Flow",True,T1557,,"Jon Sternstein, Stern Security",,,,,,"(Citation: Cylance Cleaver),(Citation: Bitdefender LuminousMoth July 2021),(Citation: Cisco ARP Poisoning Mitigation 2016),(Citation: Juniper DAI 2020)","['actor', 'process', 'data store', 'data flow']","[{'mitigation id': 'M1017', 'mitigation name': 'User Training', 'mitigation description': 'Train users to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1017'}, {'mitigation id': 'M1031', 'mitigation name': 'Network Intrusion Prevention', 'mitigation description': 'Use intrusion detection signatures to block traffic at network boundaries.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1031'}, {'mitigation id': 'M1035', 'mitigation name': 'Limit Access to Resource Over Network', 'mitigation description': 'Prevent access to file shares, remote access to systems, unnecessary services. Mechanisms to limit access may include use of network concentrators, RDP gateways, etc.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1035'}, {'mitigation id': 'M1037', 'mitigation name': 'Filter Network Traffic', 'mitigation description': 'Use network appliances to filter ingress or egress traffic and perform protocol-based filtering. Configure software on endpoints to filter network traffic.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1037'}, {'mitigation id': 'M1041', 'mitigation name': 'Encrypt Sensitive Information', 'mitigation description': 'Protect sensitive information with strong encryption.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1041'}, {'mitigation id': 'M1042', 'mitigation name': 'Disable or Remove Feature or Program', 'mitigation description': 'Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1042'}]"
T1557.003,Adversary-in-the-Middle: DHCP Spoofing,"Adversaries may redirect network traffic to adversary-owned systems by spoofing Dynamic Host Configuration Protocol (DHCP) traffic and acting as a malicious DHCP server on the victim network. By achieving the adversary-in-the-middle (AiTM) position, adversaries may collect network communications, including passed credentials, especially those sent over insecure, unencrypted protocols. This may also enable follow-on behaviors such as [Network Sniffing](https://attack.mitre.org/techniques/T1040) or [Transmitted Data Manipulation](https://attack.mitre.org/techniques/T1565/002).

DHCP is based on a client-server model and has two functionalities: a protocol for providing network configuration settings from a DHCP server to a client and a mechanism for allocating network addresses to clients.(Citation: rfc2131) The typical server-client interaction is as follows: 

1. The client broadcasts a `DISCOVER` message.

2. The server responds with an `OFFER` message, which includes an available network address. 

3. The client broadcasts a `REQUEST` message, which includes the network address offered. 

4. The server acknowledges with an `ACK` message and the client receives the network configuration parameters.

Adversaries may spoof as a rogue DHCP server on the victim network, from which legitimate hosts may receive malicious network configurations. For example, malware can act as a DHCP server and provide adversary-owned DNS servers to the victimized computers.(Citation: new_rogue_DHCP_serv_malware)(Citation: w32.tidserv.g) Through the malicious network configurations, an adversary may achieve the AiTM position, route client traffic through adversary-controlled systems, and collect information from the client network.

DHCPv6 clients can receive network configuration information without being assigned an IP address by sending a <code>INFORMATION-REQUEST (code 11)</code> message to the <code>All_DHCP_Relay_Agents_and_Servers</code> multicast address.(Citation: rfc3315) Adversaries may use their rogue DHCP server to respond to this request message with malicious network configurations.

Rather than establishing an AiTM position, adversaries may also abuse DHCP spoofing to perform a DHCP exhaustion attack (i.e, [Service Exhaustion Flood](https://attack.mitre.org/techniques/T1499/002)) by generating many broadcast DISCOVER messages to exhaust a network’s DHCP allocation pool. ",https://attack.mitre.org/techniques/T1557/003,24 March 2022,21 October 2022,1.1,"['Collection', 'Credential Access']","Monitor network traffic for suspicious/malicious behavior involving DHCP, such as changes in DNS and/or gateway parameters. Additionally, monitor Windows logs for Event IDs (EIDs) 1341, 1342, 1020 and 1063, which specify that the IP allocations are low or have run out; these EIDs may indicate a denial of service attack.(Citation: dhcp_serv_op_events)(Citation: solution_monitor_dhcp_scopes)","['Linux', 'Windows', 'macOS']","Application Log: Application Log Content, Network Traffic: Network Traffic Content, Network Traffic: Network Traffic Flow",True,T1557,,"Alex Spivakovsky, Pentera; Andrew Allen, @whitehat_zero",,,,,,",(Citation: ntlm_relaying_kerberos_del),(Citation: dhcp_serv_op_events)","['actor', 'process', 'data store', 'data flow']","[{'mitigation id': 'M1031', 'mitigation name': 'Network Intrusion Prevention', 'mitigation description': 'Use intrusion detection signatures to block traffic at network boundaries.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1031'}, {'mitigation id': 'M1037', 'mitigation name': 'Filter Network Traffic', 'mitigation description': 'Use network appliances to filter ingress or egress traffic and perform protocol-based filtering. Configure software on endpoints to filter network traffic.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1037'}]"
T1558,Steal or Forge Kerberos Tickets,"Adversaries may attempt to subvert Kerberos authentication by stealing or forging Kerberos tickets to enable [Pass the Ticket](https://attack.mitre.org/techniques/T1550/003). Kerberos is an authentication protocol widely used in modern Windows domain environments. In Kerberos environments, referred to as “realms”, there are three basic participants: client, service, and Key Distribution Center (KDC).(Citation: ADSecurity Kerberos Ring Decoder) Clients request access to a service and through the exchange of Kerberos tickets, originating from KDC, they are granted access after having successfully authenticated. The KDC is responsible for both authentication and ticket granting.  Adversaries may attempt to abuse Kerberos by stealing tickets or forging tickets to enable unauthorized access.

On Windows, the built-in <code>klist</code> utility can be used to list and analyze cached Kerberos tickets.(Citation: Microsoft Klist)

Linux systems on Active Directory domains store Kerberos credentials locally in the credential cache file referred to as the ""ccache"". The credentials are stored in the ccache file while they remain valid and generally while a user's session lasts.(Citation: MIT ccache) On modern Redhat Enterprise Linux systems, and derivative distributions, the System Security Services Daemon (SSSD) handles Kerberos tickets. By default SSSD maintains a copy of the ticket database that can be found in <code>/var/lib/sss/secrets/secrets.ldb</code> as well as the corresponding key located in <code>/var/lib/sss/secrets/.secrets.mkey</code>. Both files require root access to read. If an adversary is able to access the database and key, the credential cache Kerberos blob can be extracted and converted into a usable Kerberos ccache file that adversaries may use for [Pass the Ticket](https://attack.mitre.org/techniques/T1550/003). The ccache file may also be converted into a Windows format using tools such as Kekeo.(Citation: Linux Kerberos Tickets)(Citation: Brining MimiKatz to Unix)(Citation: Kekeo)


Kerberos tickets on macOS are stored in a standard ccache format, similar to Linux. By default, access to these ccache entries is federated through the KCM daemon process via the Mach RPC protocol, which uses the caller's environment to determine access. The storage location for these ccache entries is influenced by the <code>/etc/krb5.conf</code> configuration file and the <code>KRB5CCNAME</code> environment variable which can specify to save them to disk or keep them protected via the KCM daemon. Users can interact with ticket storage using <code>kinit</code>, <code>klist</code>, <code>ktutil</code>, and <code>kcc</code> built-in binaries or via Apple's native Kerberos framework. Adversaries can use open source tools to interact with the ccache files directly or to use the Kerberos framework to call lower-level APIs for extracting the user's TGT or Service Tickets.(Citation: SpectorOps Bifrost Kerberos macOS 2019)(Citation: macOS kerberos framework MIT)
",https://attack.mitre.org/techniques/T1558,11 February 2020,30 March 2023,1.4,['Credential Access'],"Monitor for anomalous Kerberos activity, such as malformed or blank fields in Windows logon/logoff events (Event ID 4624, 4672, 4634), RC4 encryption within ticket granting tickets (TGTs), and ticket granting service (TGS) requests without preceding TGT requests.(Citation: ADSecurity Detecting Forged Tickets)(Citation: Stealthbits Detect PtT 2019)(Citation: CERT-EU Golden Ticket Protection)

Monitor the lifetime of TGT tickets for values that differ from the default domain duration.(Citation: Microsoft Kerberos Golden Ticket)

Monitor for indications of [Pass the Ticket](https://attack.mitre.org/techniques/T1550/003) being used to move laterally. 

Enable Audit Kerberos Service Ticket Operations to log Kerberos TGS service ticket requests. Particularly investigate irregular patterns of activity (ex: accounts making numerous requests, Event ID 4769, within a small time frame, especially if they also request RC4 encryption [Type 0x17]).(Citation: Microsoft Detecting Kerberoasting Feb 2018) (Citation: AdSecurity Cracking Kerberos Dec 2015)

Monitor for unexpected processes interacting with lsass.exe.(Citation: Medium Detecting Attempts to Steal Passwords from Memory) Common credential dumpers such as [Mimikatz](https://attack.mitre.org/software/S0002) access the LSA Subsystem Service (LSASS) process by opening the process, locating the LSA secrets key, and decrypting the sections in memory where credential details, including Kerberos tickets, are stored.

Monitor for unusual processes accessing <code>secrets.ldb</code> and <code>.secrets.mkey</code> located in <code>/var/lib/sss/secrets/</code>.","['Linux', 'Windows', 'macOS']","Active Directory: Active Directory Credential Request, Command: Command Execution, File: File Access, Logon Session: Logon Session Metadata",False,,[],"Cody Thomas, SpecterOps; Tim (Wadhwa-)Brown","['root', 'User']",,Kerberos authentication enabled,,,",(Citation: STIG krbtgt reset),(Citation: AdSecurity Cracking Kerberos Dec 2015)","['actor', 'process', 'data store', 'data flow']","[{'mitigation id': 'M1015', 'mitigation name': 'Active Directory Configuration', 'mitigation description': 'Configure Active Directory to prevent use of certain techniques; use SID Filtering, etc.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1015'}, {'mitigation id': 'M1026', 'mitigation name': 'Privileged Account Management', 'mitigation description': 'Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1026'}, {'mitigation id': 'M1027', 'mitigation name': 'Password Policies', 'mitigation description': 'Set and enforce secure password policies for accounts.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1027'}, {'mitigation id': 'M1041', 'mitigation name': 'Encrypt Sensitive Information', 'mitigation description': 'Protect sensitive information with strong encryption.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1041'}]"
T1567,Exfiltration Over Web Service,"Adversaries may use an existing, legitimate external Web service to exfiltrate data rather than their primary command and control channel. Popular Web services acting as an exfiltration mechanism may give a significant amount of cover due to the likelihood that hosts within a network are already communicating with them prior to compromise. Firewall rules may also already exist to permit traffic to these services.

Web service providers also commonly use SSL/TLS encryption, giving adversaries an added level of protection.",https://attack.mitre.org/techniques/T1567,09 March 2020,19 October 2022,1.2,['Exfiltration'],"Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. User behavior monitoring may help to detect abnormal patterns of activity.","['Linux', 'Windows', 'macOS']","Command: Command Execution, File: File Access, Network Traffic: Network Connection Creation, Network Traffic: Network Traffic Content, Network Traffic: Network Traffic Flow",False,,[],William Cain,,,,,,"(Citation: Mandiant APT41),(Citation: Google Iran Threats October 2021),(Citation: KISA Operation Muzabi),(Citation: TrendMicro Pawn Storm Dec 2020),(Citation: BleepingComputer Molerats Dec 2020),(Citation: MalwareBytes Ngrok February 2020),","['process', 'data store', 'data flow']","[{'mitigation id': 'M1021', 'mitigation name': 'Restrict Web-Based Content', 'mitigation description': 'Restrict use of certain websites, block downloads/attachments, block Javascript, restrict browser extensions, etc.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1021'}, {'mitigation id': 'M1057', 'mitigation name': 'Data Loss Prevention', 'mitigation description': 'Use a data loss prevention (DLP) strategy to categorize sensitive data, identify data formats indicative of personal identifiable information (PII), and restrict exfiltration of sensitive data.(Citation: PurpleSec Data Loss Prevention)', 'mitigation url': 'https://attack.mitre.org/mitigations/M1057'}]"
T1567.001,Exfiltration Over Web Service: Exfiltration to Code Repository,"Adversaries may exfiltrate data to a code repository rather than over their primary command and control channel. Code repositories are often accessible via an API (ex: https://api.github.com). Access to these APIs are often over HTTPS, which gives the adversary an additional level of protection.

Exfiltration to a code repository can also provide a significant amount of cover to the adversary if it is a popular service already used by hosts within the network. ",https://attack.mitre.org/techniques/T1567/001,09 March 2020,28 March 2020,1.0,['Exfiltration'],"Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server) to code repositories. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. User behavior monitoring may help to detect abnormal patterns of activity.","['Linux', 'Windows', 'macOS']","Command: Command Execution, File: File Access, Network Traffic: Network Traffic Content, Network Traffic: Network Traffic Flow",True,T1567,,,,,,,,"(Citation: Github PowerShell Empire),","['process', 'data store', 'data flow']","[{'mitigation id': 'M1021', 'mitigation name': 'Restrict Web-Based Content', 'mitigation description': 'Restrict use of certain websites, block downloads/attachments, block Javascript, restrict browser extensions, etc.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1021'}]"
T1567.002,Exfiltration Over Web Service: Exfiltration to Cloud Storage,"Adversaries may exfiltrate data to a cloud storage service rather than over their primary command and control channel. Cloud storage services allow for the storage, edit, and retrieval of data from a remote cloud storage server over the Internet.

Examples of cloud storage services include Dropbox and Google Docs. Exfiltration to these cloud storage services can provide a significant amount of cover to the adversary if hosts within the network are already communicating with the service. ",https://attack.mitre.org/techniques/T1567/002,09 March 2020,30 August 2022,1.1,['Exfiltration'],"Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server) to known cloud storage services. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. User behavior monitoring may help to detect abnormal patterns of activity.","['Linux', 'Windows', 'macOS']","Command: Command Execution, File: File Access, Network Traffic: Network Connection Creation, Network Traffic: Network Traffic Content, Network Traffic: Network Traffic Flow",True,T1567,,,,,,,,"(Citation: Bitdefender Naikon April 2021),(Citation: ESET Crutch December 2020),(Citation: Proofpoint Leviathan Oct 2017),(Citation: Microsoft POLONIUM June 2022),(Citation: Talos Kimsuky Nov 2021),(Citation: Trend Micro DRBControl February 2020),(Citation: Rclone),(Citation: Talent-Jump Clambling February 2020),(Citation: TrendMicro Confucius APT Feb 2018),(Citation: FireEye Periscope March 2018),(Citation: TrendMicro EarthLusca 2022),(Citation: ESET Nomadic Octopus 2018),(Citation: ClearSky Lazarus Aug 2020),(Citation: NCC Group Chimera January 2021),(Citation: Zscaler APT31 Covid-19 October 2020),(Citation: Microsoft HAFNIUM March 2020),(Citation: Malwarebytes RokRAT VBA January 2021),(Citation: CrowdStrike Carbon Spider August 2021),(Citation: Symantec Waterbug Jun 2019),(Citation: MSTIC Nobelium Toolset May 2021),(Citation: Bitdefender LuminousMoth July 2021),(Citation: Checkpoint IndigoZebra July 2021),(Citation: FireEye APT29),(Citation: ESET Lazarus Jun 2020),(Citation: DFIR Conti Bazar Nov 2021),(Citation: Github PowerShell Empire),(Citation: ESET ComRAT May 2020),(Citation: Volexity InkySquid RokRAT August 2021),","['process', 'data store', 'data flow']","[{'mitigation id': 'M1021', 'mitigation name': 'Restrict Web-Based Content', 'mitigation description': 'Restrict use of certain websites, block downloads/attachments, block Javascript, restrict browser extensions, etc.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1021'}]"
T1567.003,Exfiltration Over Web Service: Exfiltration to Text Storage Sites,"Adversaries may exfiltrate data to text storage sites instead of their primary command and control channel. Text storage sites, such as <code>pastebin[.]com</code>, are commonly used by developers to share code and other information.  

Text storage sites are often used to host malicious code for C2 communication (e.g., [Stage Capabilities](https://attack.mitre.org/techniques/T1608)), but adversaries may also use these sites to exfiltrate collected data. Furthermore, paid features and encryption options may allow adversaries to conceal and store data more securely.(Citation: Pastebin EchoSec)

**Note:** This is distinct from [Exfiltration to Code Repository](https://attack.mitre.org/techniques/T1567/001), which highlight access to code repositories via APIs.",https://attack.mitre.org/techniques/T1567/003,27 February 2023,04 May 2023,1.0,['Exfiltration'],,"['Linux', 'Windows', 'macOS']","Network Traffic: Network Traffic Content, Network Traffic: Network Traffic Flow",True,T1567,,Harun Küßner,,,,,,",","['process', 'data store', 'data flow']","[{'mitigation id': 'M1021', 'mitigation name': 'Restrict Web-Based Content', 'mitigation description': 'Restrict use of certain websites, block downloads/attachments, block Javascript, restrict browser extensions, etc.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1021'}]"
T1568,Dynamic Resolution,"Adversaries may dynamically establish connections to command and control infrastructure to evade common detections and remediations. This may be achieved by using malware that shares a common algorithm with the infrastructure the adversary uses to receive the malware's communications. These calculations can be used to dynamically adjust parameters such as the domain name, IP address, or port number the malware uses for command and control.

Adversaries may use dynamic resolution for the purpose of [Fallback Channels](https://attack.mitre.org/techniques/T1008). When contact is lost with the primary command and control server malware may employ dynamic resolution as a means to reestablishing command and control.(Citation: Talos CCleanup 2017)(Citation: FireEye POSHSPY April 2017)(Citation: ESET Sednit 2017 Activity)",https://attack.mitre.org/techniques/T1568,10 March 2020,11 March 2022,1.0,['Command and Control'],"Detecting dynamically generated C2 can be challenging due to the number of different algorithms, constantly evolving malware families, and the increasing complexity of the algorithms. There are multiple approaches to detecting a pseudo-randomly generated domain name, including using frequency analysis, Markov chains, entropy, proportion of dictionary words, ratio of vowels to other characters, and more (Citation: Data Driven Security DGA). CDN domains may trigger these detections due to the format of their domain names. In addition to detecting algorithm generated domains based on the name, another more general approach for detecting a suspicious domain is to check for recently registered names or for rarely visited domains.","['Linux', 'Windows', 'macOS']","Network Traffic: Network Connection Creation, Network Traffic: Network Traffic Content, Network Traffic: Network Traffic Flow",False,,[],Chris Roffe,['User'],,,,,"(Citation: Unit42 Redaman January 2019),(Citation: ESET Operation Spalax Jan 2021),(Citation: Forcepoint BITTER Pakistan Oct 2016),(Citation: ESET Gelsemium June 2021),(Citation: Unit 42 Gamaredon February 2022),(Citation: McAfee Maze March 2020),(Citation: CheckPoint Redaman October 2019),(Citation: FireEye SUNBURST Backdoor December 2020),(Citation: Kaspersky Tomiris Sep 2021),(Citation: Talos Bisonal Mar 2020),(Citation: Cylance Dust Storm),(Citation: FireEye APT30),(Citation: McAfee Night Dragon),(Citation: Proofpoint Operation Transparent Tribe March 2016),(Citation: Volexity SolarWinds),(Citation: Cisco Umbrella DGA Brute Force),(Citation: Cybereason Dissecting DGAs)","['actor', 'process', 'data flow']","[{'mitigation id': 'M1021', 'mitigation name': 'Restrict Web-Based Content', 'mitigation description': 'Restrict use of certain websites, block downloads/attachments, block Javascript, restrict browser extensions, etc.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1021'}, {'mitigation id': 'M1031', 'mitigation name': 'Network Intrusion Prevention', 'mitigation description': 'Use intrusion detection signatures to block traffic at network boundaries.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1031'}]"
T1568.001,Dynamic Resolution: Fast Flux DNS,"Adversaries may use Fast Flux DNS to hide a command and control channel behind an array of rapidly changing IP addresses linked to a single domain resolution. This technique uses a fully qualified domain name, with multiple IP addresses assigned to it which are swapped with high frequency, using a combination of round robin IP addressing and short Time-To-Live (TTL) for a DNS resource record.(Citation: MehtaFastFluxPt1)(Citation: MehtaFastFluxPt2)(Citation: Fast Flux - Welivesecurity)

The simplest, ""single-flux"" method, involves registering and de-registering an addresses as part of the DNS A (address) record list for a single DNS name. These registrations have a five-minute average lifespan, resulting in a constant shuffle of IP address resolution.(Citation: Fast Flux - Welivesecurity)

In contrast, the ""double-flux"" method registers and de-registers an address as part of the DNS Name Server record list for the DNS zone, providing additional resilience for the connection. With double-flux additional hosts can act as a proxy to the C2 host, further insulating the true source of the C2 channel.",https://attack.mitre.org/techniques/T1568/001,11 March 2020,27 March 2020,1.0,['Command and Control'],"In general, detecting usage of fast flux DNS is difficult due to web traffic load balancing that services client requests quickly. In single flux cases only IP addresses change for static domain names. In double flux cases, nothing is static. Defenders such as domain registrars and service providers are likely in the best position for detection.","['Linux', 'Windows', 'macOS']","Network Traffic: Network Connection Creation, Network Traffic: Network Traffic Flow",True,T1568,,,,,,,,"(Citation: Korean FSI TA505 2020),(Citation: District Court of NY APT10 Indictment December 2018),(Citation: Trend Micro njRAT 2018),(Citation: Trend Micro TA505 June 2019),(Citation: Gh0stRAT ATT March 2019),","['actor', 'process', 'data flow']",
T1568.002,Dynamic Resolution: Domain Generation Algorithms,"Adversaries may make use of Domain Generation Algorithms (DGAs) to dynamically identify a destination domain for command and control traffic rather than relying on a list of static IP addresses or domains. This has the advantage of making it much harder for defenders to block, track, or take over the command and control channel, as there potentially could be thousands of domains that malware can check for instructions.(Citation: Cybereason Dissecting DGAs)(Citation: Cisco Umbrella DGA)(Citation: Unit 42 DGA Feb 2019)

DGAs can take the form of apparently random or “gibberish” strings (ex: istgmxdejdnxuyla.ru) when they construct domain names by generating each letter. Alternatively, some DGAs employ whole words as the unit by concatenating words together instead of letters (ex: cityjulydish.net). Many DGAs are time-based, generating a different domain for each time period (hourly, daily, monthly, etc). Others incorporate a seed value as well to make predicting future domains more difficult for defenders.(Citation: Cybereason Dissecting DGAs)(Citation: Cisco Umbrella DGA)(Citation: Talos CCleanup 2017)(Citation: Akamai DGA Mitigation)

Adversaries may use DGAs for the purpose of [Fallback Channels](https://attack.mitre.org/techniques/T1008). When contact is lost with the primary command and control server malware may employ a DGA as a means to reestablishing command and control.(Citation: Talos CCleanup 2017)(Citation: FireEye POSHSPY April 2017)(Citation: ESET Sednit 2017 Activity)",https://attack.mitre.org/techniques/T1568/002,10 March 2020,11 March 2022,1.0,['Command and Control'],"Detecting dynamically generated domains can be challenging due to the number of different DGA algorithms, constantly evolving malware families, and the increasing complexity of the algorithms. There is a myriad of approaches for detecting a pseudo-randomly generated domain name, including using frequency analysis, Markov chains, entropy, proportion of dictionary words, ratio of vowels to other characters, and more.(Citation: Data Driven Security DGA) CDN domains may trigger these detections due to the format of their domain names. In addition to detecting a DGA domain based on the name, another more general approach for detecting a suspicious domain is to check for recently registered names or for rarely visited domains.

Machine learning approaches to detecting DGA domains have been developed and have seen success in applications. One approach is to use N-Gram methods to determine a randomness score for strings used in the domain name. If the randomness score is high, and the domains are not whitelisted (CDN, etc), then it may be determined if a domain is related to a legitimate host or DGA.(Citation: Pace University Detecting DGA May 2017) Another approach is to use deep learning to classify domains as DGA-generated.(Citation: Elastic Predicting DGA)","['Linux', 'Windows', 'macOS']",Network Traffic: Network Traffic Flow,True,T1568,,"Barry Shteiman, Exabeam; Ryan Benson, Exabeam; Sylvain Gil, Exabeam",['User'],,,,,"(Citation: ESET Ebury Feb 2014),(Citation: Talos CCleanup 2017),(Citation: Unit 42 TA551 Jan 2021),(Citation: FireEye POSHSPY April 2017),(Citation: ESET Dukes October 2019),(Citation: Trend Micro Qakbot May 2020),(Citation: SANS Conficker),(Citation: ESET Sednit 2017 Activity),(Citation: CheckPoint Naikon May 2020),(Citation: Zdnet Ngrok September 2018),(Citation: Secureworks GOLD CABIN),(Citation: Accenture Lyceum Targets November 2021),(Citation: Securelist Brazilian Banking Malware July 2020),(Citation: BlackBerry CostaRicto November 2020),(Citation: ESET Ebury Oct 2017),(Citation: Intezer Doki July 20),(Citation: Prevailion DarkWatchman 2021),(Citation: Cybereason Astaroth Feb 2019),(Citation: FireEye APT34 Dec 2017),(Citation: FireEye APT41 Aug 2019),(Citation: Kaspersky ShadowPad Aug 2017),(Citation: ClearSky Siamesekitten August 2021),(Citation: ProofPoint Ursnif Aug 2016),(Citation: ESET Grandoreiro April 2020),(Citation: Trend Micro Conficker),(Citation: Securelist ShadowPad Aug 2017),(Citation: Cybereason Bazar July 2020),(Citation: Akamai DGA Mitigation),(Citation: Cisco Umbrella DGA Brute Force),(Citation: Cybereason Dissecting DGAs)","['actor', 'process', 'data flow']","[{'mitigation id': 'M1021', 'mitigation name': 'Restrict Web-Based Content', 'mitigation description': 'Restrict use of certain websites, block downloads/attachments, block Javascript, restrict browser extensions, etc.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1021'}, {'mitigation id': 'M1031', 'mitigation name': 'Network Intrusion Prevention', 'mitigation description': 'Use intrusion detection signatures to block traffic at network boundaries.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1031'}]"
T1568.003,Dynamic Resolution: DNS Calculation,"Adversaries may perform calculations on addresses returned in DNS results to determine which port and IP address to use for command and control, rather than relying on a predetermined port number or the actual returned IP address. A IP and/or port number calculation can be used to bypass egress filtering on a C2 channel.(Citation: Meyers Numbered Panda)

One implementation of [DNS Calculation](https://attack.mitre.org/techniques/T1568/003) is to take the first three octets of an IP address in a DNS response and use those values to calculate the port for command and control traffic.(Citation: Meyers Numbered Panda)(Citation: Moran 2014)(Citation: Rapid7G20Espionage)",https://attack.mitre.org/techniques/T1568/003,11 March 2020,27 March 2020,1.0,['Command and Control'],Detection for this technique is difficult because it would require knowledge of the specific implementation of the port calculation algorithm. Detection may be possible by analyzing DNS records if the algorithm is known.,"['Linux', 'Windows', 'macOS']",Network Traffic: Network Traffic Content,True,T1568,,,,,,,,"(Citation: Meyers Numbered Panda),","['actor', 'process', 'data flow']",
T1571,Non-Standard Port,"Adversaries may communicate using a protocol and port pairing that are typically not associated. For example, HTTPS over port 8088(Citation: Symantec Elfin Mar 2019) or port 587(Citation: Fortinet Agent Tesla April 2018) as opposed to the traditional port 443. Adversaries may make changes to the standard port used by a protocol to bypass filtering or muddle analysis/parsing of network data.

Adversaries may also make changes to victim systems to abuse non-standard ports. For example, Registry keys and other configuration settings can be used to modify protocol and port pairings.(Citation: change_rdp_port_conti)",https://attack.mitre.org/techniques/T1571,14 March 2020,28 February 2023,1.1,['Command and Control'],"Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.(Citation: University of Birmingham C2)","['Linux', 'Windows', 'macOS']","Network Traffic: Network Traffic Content, Network Traffic: Network Traffic Flow",False,,[],,,,,,,"(Citation: Anomali Rocke March 2019),(Citation: US-CERT HARDRAIN March 2018),(Citation: Trend Micro Totbrick Oct 2016),(Citation: Symantec Elfin Mar 2019),(Citation: CISA WellMail July 2020),(Citation: Palo Alto MoonWind March 2017),(Citation: Bitdefender StrongPity June 2020),(Citation: FireEye FIN7 Aug 2018),(Citation: Talos PoetRAT April 2020),(Citation: Talos GravityRAT),(Citation: CISA AR18-352A Quasar RAT December 2018),(Citation: US-CERT HOPLIGHT Apr 2019),(Citation: Kaspersky WIRTE November 2021),(Citation: Unit 42 Magic Hound Feb 2017),(Citation: Talos ZxShell Oct 2014),(Citation: QiAnXin APT-C-36 Feb2019),(Citation: FoxIT Wocao December 2019),(Citation: S2 Grupo TrickBot June 2017),(Citation: Trustwave GoldenSpy June 2020),(Citation: DFIR Phosphorus November 2021),(Citation: ESET BlackEnergy Jan 2016),(Citation: Fidelis Turbo),(Citation: ESET DazzleSpy Jan 2022),(Citation: Novetta Blockbuster),(Citation: US-CERT TYPEFRAME June 2018),(Citation: PWC Cloud Hopper Technical Annex April 2017),(Citation: Costa AvosLocker May 2022),(Citation: US-CERT Bankshot Dec 2017),(Citation: US-CERT BADCALL),(Citation: FireEye TRITON 2019),(Citation: Trend Micro njRAT 2018),(Citation: Mandiant UNC3890 Aug 2022),(Citation: Securelist DarkVishnya Dec 2018),(Citation: Novetta Blockbuster RATs),(Citation: Fidelis TrickBot Oct 2016),(Citation: ESET OceanLotus Mar 2019),(Citation: Unit 42 PingPull Jun 2022),(Citation: Unit42 BendyBear Feb 2021),(Citation: Talos Emotet Jan 2019),(Citation: ESET RTM Feb 2017),(Citation: NCSC APT29 July 2020),(Citation: FireEye Metamorfo Apr 2018),(Citation: Bitdefender Trickbot VNC module Whitepaper 2021),(Citation: Group IB Silence Sept 2018),(Citation: NCSC Cyclops Blink February 2022),","['actor', 'process', 'data flow']","[{'mitigation id': 'M1030', 'mitigation name': 'Network Segmentation', 'mitigation description': 'Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network. Configure separate virtual private cloud (VPC) instances to isolate critical cloud systems.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1030'}, {'mitigation id': 'M1031', 'mitigation name': 'Network Intrusion Prevention', 'mitigation description': 'Use intrusion detection signatures to block traffic at network boundaries.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1031'}]"
T1572,Protocol Tunneling,"Adversaries may tunnel network communications to and from a victim system within a separate protocol to avoid detection/network filtering and/or enable access to otherwise unreachable systems. Tunneling involves explicitly encapsulating a protocol within another. This behavior may conceal malicious traffic by blending in with existing traffic and/or provide an outer layer of encryption (similar to a VPN). Tunneling could also enable routing of network packets that would otherwise not reach their intended destination, such as SMB, RDP, or other traffic that would be filtered by network appliances or not routed over the Internet. 

There are various means to encapsulate a protocol within another protocol. For example, adversaries may perform SSH tunneling (also known as SSH port forwarding), which involves forwarding arbitrary data over an encrypted SSH tunnel.(Citation: SSH Tunneling) 

[Protocol Tunneling](https://attack.mitre.org/techniques/T1572) may also be abused by adversaries during [Dynamic Resolution](https://attack.mitre.org/techniques/T1568). Known as DNS over HTTPS (DoH), queries to resolve C2 infrastructure may be encapsulated within encrypted HTTPS packets.(Citation: BleepingComp Godlua JUL19) 

Adversaries may also leverage [Protocol Tunneling](https://attack.mitre.org/techniques/T1572) in conjunction with [Proxy](https://attack.mitre.org/techniques/T1090) and/or [Protocol Impersonation](https://attack.mitre.org/techniques/T1001/003) to further conceal C2 communications and infrastructure. ",https://attack.mitre.org/techniques/T1572,15 March 2020,27 March 2020,1.0,['Command and Control'],"Monitoring for systems listening and/or establishing external connections using ports/protocols commonly associated with tunneling, such as SSH (port 22). Also monitor for processes commonly associated with tunneling, such as Plink and the OpenSSH client. 

ullalyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect application layer protocols that do not follow the expected protocol standards regarding syntax, structure, or any other variable adversaries could leverage to conceal data.(Citation: University of Birmingham C2)","['Linux', 'Windows', 'macOS']","Network Traffic: Network Connection Creation, Network Traffic: Network Traffic Content, Network Traffic: Network Traffic Flow",False,,[],,,,,,,"(Citation: Group IB Cobalt Aug 2017),(Citation: FireEye APT34 July 2019),(Citation: CISA AA20-259A Iran-Based Actor September 2020),(Citation: ClearSky Pay2Kitten December 2020),(Citation: Palo Alto Brute Ratel July 2022),(Citation: CrowdStrike PIONEER KITTEN August 2020),(Citation: cobaltstrike manual),(Citation: FireEye Maze May 2020),(Citation: Symantec W32.Duqu),(Citation: Dragos Crashoverride 2017),(Citation: DFIR Phosphorus November 2021),(Citation: SentinelOne Aoqin Dragon June 2022),(Citation: Talos Cobalt Group July 2018),(Citation: NCC Group Chimera January 2021),(Citation: MalwareBytes Ngrok February 2020),(Citation: Trend Micro Ngrok September 2020),(Citation: Unit42 OilRig Playbook 2023),(Citation: Kaspersky Lyceum October 2021),(Citation: PTSecurity Cobalt Dec 2016),(Citation: BlackBerry CostaRicto November 2020),(Citation: Trend Micro Black Basta October 2022),(Citation: Cyware Ngrok May 2019),(Citation: Mythc Documentation),(Citation: FireEye APT34 Webinar Dec 2017),(Citation: Mandiant FIN5 GrrCON Oct 2016),(Citation: Cobalt Strike Manual 4.3 November 2020),(Citation: CISA AA21-200A APT40 July 2021),(Citation: Trend Micro Cyclops Blink March 2022),(Citation: Bitdefender FunnyDream Campaign November 2020),(Citation: FireEye FIN6 April 2016),(Citation: Kaspersky QakBot September 2021),","['actor', 'process', 'data flow']","[{'mitigation id': 'M1031', 'mitigation name': 'Network Intrusion Prevention', 'mitigation description': 'Use intrusion detection signatures to block traffic at network boundaries.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1031'}, {'mitigation id': 'M1037', 'mitigation name': 'Filter Network Traffic', 'mitigation description': 'Use network appliances to filter ingress or egress traffic and perform protocol-based filtering. Configure software on endpoints to filter network traffic.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1037'}]"
T1573,Encrypted Channel,"Adversaries may employ a known encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol. Despite the use of a secure algorithm, these implementations may be vulnerable to reverse engineering if secret keys are encoded and/or generated within malware samples/configuration files.",https://attack.mitre.org/techniques/T1573,16 March 2020,20 April 2021,1.0,['Command and Control'],"SSL/TLS inspection is one way of detecting command and control traffic within some encrypted communication channels.(Citation: SANS Decrypting SSL) SSL/TLS inspection does come with certain risks that should be considered before implementing to avoid potential security issues such as incomplete certificate validation.(Citation: SEI SSL Inspection Risks)

In general, analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)","['Linux', 'Windows', 'macOS']",Network Traffic: Network Traffic Content,False,,[],,,,,,,"(Citation: ESET DazzleSpy Jan 2022),(Citation: Forcepoint BITTER Pakistan Oct 2016),(Citation: Secureworks IRON HEMLOCK Profile),(Citation: TrendMicro Tropic Trooper May 2020),(Citation: Secureworks BRONZE PRESIDENT December 2019),(Citation: BiZone Lizar May 2021),(Citation: DFIR Phosphorus November 2021),(Citation: Cybereason Chaes Nov 2020),(Citation: SentinelOne Lazarus macOS July 2020),(Citation: DHS CISA AA22-055A MuddyWater February 2022),(Citation: Gh0stRAT ATT March 2019),(Citation: Red Canary NETWIRE January 2020),(Citation: Threatpost Lizar May 2021),(Citation: Cybereason PowerLess February 2022),","['actor', 'process', 'data flow']","[{'mitigation id': 'M1020', 'mitigation name': 'SSL/TLS Inspection', 'mitigation description': 'Break and inspect SSL/TLS sessions to look at encrypted web traffic for adversary activity.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1020'}, {'mitigation id': 'M1031', 'mitigation name': 'Network Intrusion Prevention', 'mitigation description': 'Use intrusion detection signatures to block traffic at network boundaries.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1031'}]"
T1573.001,Encrypted Channel: Symmetric Cryptography,"Adversaries may employ a known symmetric encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol. Symmetric encryption algorithms use the same key for plaintext encryption and ciphertext decryption. Common symmetric encryption algorithms include AES, DES, 3DES, Blowfish, and RC4.",https://attack.mitre.org/techniques/T1573/001,16 March 2020,26 March 2020,1.0,['Command and Control'],"With symmetric encryption, it may be possible to obtain the algorithm and key from samples and use them to decode network traffic to detect malware communications signatures.

In general, analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)","['Linux', 'Windows', 'macOS']",Network Traffic: Network Traffic Content,True,T1573,,,,,,,,"(Citation: Lotus Blossom Jun 2015),(Citation: MSTIC FoggyWeb September 2021),(Citation: GitHub QuasarRAT),(Citation: Palo Alto MoonWind March 2017),(Citation: FireEye APT10 Sept 2018),(Citation: ESET Dukes October 2019),(Citation: McAfee Lazarus Nov 2020),(Citation: Proofpoint Bumblebee April 2022),(Citation: Scarlet Mimic Jan 2016),(Citation: Zscaler Higaisa 2020),(Citation: Symantec Hydraq Jan 2010),(Citation: F-Secure Cosmicduke),(Citation: Kaspersky Turla),(Citation: ESET LightNeuron May 2019),(Citation: PWC WellMess C2 August 2020),(Citation: Kaspersky CactusPete Aug 2020),(Citation: McAfee GhostSecret),(Citation: Fidelis Hi-Zor),(Citation: BlackBerry CostaRicto November 2020),(Citation: ESET Casbaneiro Oct 2019),(Citation: Proofpoint ZeroT Feb 2017),(Citation: Fidelis TrickBot Oct 2016),(Citation: Novetta-Axiom),(Citation: Unit 42 PingPull Jun 2022),(Citation: FireEye APT10 April 2017),(Citation: Baumgartner Naikon 2015),(Citation: Lunghi Iron Tiger Linux),(Citation: Nicolas Falliere, Liam O Murchu, Eric Chien February 2011),(Citation: Villeneuve 2011),(Citation: US-CERT BLINDINGCAN Aug 2020),(Citation: ESET Sednit Part 3),(Citation: Palo Alto menuPass Feb 2017),(Citation: Talos Cobalt Strike September 2020),(Citation: CISA WellMess July 2020),(Citation: Bitdefender Naikon April 2021),(Citation: Security Intelligence More Eggs Aug 2019),(Citation: SentinelLabs Metador Technical Appendix Sept 2022),(Citation: Recorded Future REDDELTA July 2020),(Citation: trendmicro xcsset xcode project 2020),(Citation: Proofpoint Azorult July 2018),(Citation: FireEye Poison Ivy),(Citation: ESET PipeMon May 2020),(Citation: ESET Okrum July 2019),(Citation: FireEye APT30),(Citation: MalwareBytes WoodyRAT Aug 2022),(Citation: Lotus Blossom Dec 2015),(Citation: CISA AR18-352A Quasar RAT December 2018),(Citation: Bitdefender Trickbot C2 infra Nov 2020),(Citation: CrowdStrike IceApple May 2022),(Citation: FireEye APT28),(Citation: Symantec W32.Duqu),(Citation: Kaspersky Carbanak),(Citation: Unit 42 SeaDuke 2015),(Citation: FireEye SMOKEDHAM June 2021),(Citation: Fidelis Turbo),(Citation: Novetta Blockbuster),(Citation: Zscaler APT31 Covid-19 October 2020),(Citation: JPCERT ChChes Feb 2017),(Citation: Proofpoint TA416 Europe March 2022),(Citation: ESET Attor Oct 2019),(Citation: Chronicle Winnti for Linux May 2019),(Citation: Novetta Winnti April 2015),(Citation: Check Point Warzone Feb 2020),(Citation: Volexity Patchwork June 2018),(Citation: CISA MAR-10288834-2.v1  TAINTEDSCRIBE MAY 2020),(Citation: ESET GreyEnergy Oct 2018),(Citation: ClearSky Lebanese Cedar Jan 2021),(Citation: Unit42 BendyBear Feb 2021),(Citation: FireEye APT29),(Citation: ESET RTM Feb 2017),(Citation: Accenture HyperStack October 2020),(Citation: Forcepoint Felismus Mar 2017),(Citation: Mandiant No Easy Breach),(Citation: FireEye CARBANAK June 2017),(Citation: GitHub Sliver Encryption),(Citation: US-CERT HOTCROISSANT February 2020),(Citation: Kaspersky Dridex May 2017),(Citation: Citizen Lab Stealth Falcon May 2016),(Citation: Kaspersky QakBot September 2021),(Citation: Palo Alto Comnie),(Citation: McAfee Lazarus Jul 2020),(Citation: Securelist APT10 March 2021),(Citation: Cybereason StrifeWater Feb 2022),(Citation: ESET Gazer Aug 2017),(Citation: FireEye APT33 Guardrail),(Citation: Check Point APT35 CharmPower January 2022),(Citation: Sofacy Komplex Trojan),(Citation: ESET Sednit Part 2),(Citation: Malwarebytes KONNI Evolves Jan 2022),(Citation: ESET ForSSHe December 2018),(Citation: ESET Kobalos Jan 2021),(Citation: TrendMicro Taidoor),(Citation: Red Canary NETWIRE January 2020),(Citation: PWC Cloud Hopper Technical Annex April 2017),(Citation: Talos MuddyWater Jan 2022),(Citation: Secureworks BRONZE BUTLER Oct 2017),(Citation: ESET Turla Mosquito Jan 2018),(Citation: ESET InvisiMole June 2018),(Citation: US-CERT BADCALL),(Citation: JPCert TSCookie March 2018),(Citation: Nccgroup Gh0st April 2018),(Citation: Proofpoint LookBack Malware Aug 2019),(Citation: CrowdStrike Putter Panda),(Citation: Proofpoint TA459 April 2017),(Citation: Palo Alto OilRig May 2016),(Citation: Talos Bisonal Mar 2020),(Citation: Talos Frankenstein June 2019),(Citation: ESET Ebury Feb 2014),(Citation: Palo Alto Networks BBSRAT),(Citation: Proofpoint TA505 Mar 2018),(Citation: Unit42 Azorult Nov 2018),(Citation: Unit 42 Bisonal July 2018),(Citation: CISA AppleJeus Feb 2021),(Citation: Unit 42 Lucifer June 2020),(Citation: CISA MAR-10292089-1.v2 TAIDOOR August 2021),(Citation: Group IB GrimAgent July 2021),(Citation: PWC WellMess July 2020),(Citation: ESET Kobalos Feb 2021),(Citation: NCC Group Team9 June 2020),(Citation: US-CERT KEYMARBLE Aug 2018),(Citation: JPCert PLEAD Downloader June 2018),(Citation: Forcepoint Monsoon),(Citation: Microsoft PLATINUM April 2016),(Citation: Securelist WhiteBear Aug 2017),(Citation: Check Point APT34 April 2021),(Citation: Trend Micro Iron Tiger April 2021),(Citation: FireEye SUNBURST Backdoor December 2020),(Citation: Chaos Stolen Backdoor),(Citation: Novetta Blockbuster Destructive Malware),(Citation: SentinelOne Aoqin Dragon June 2022),(Citation: ESET Zebrocy May 2019),(Citation: Dell Sakula),(Citation: US-CERT Volgmer 2 Nov 2017),(Citation: CheckPoint Bandook Nov 2020),(Citation: ESET Machete July 2019),(Citation: ESET Operation Groundbait),(Citation: Bitdefender APT28 Dec 2015),(Citation: Unit42 RDAT July 2020),(Citation: Microsoft DUBNIUM July 2016),(Citation: PaloAlto nulloCore Feb 2016),(Citation: PaloAlto CardinalRat Apr 2017),(Citation: US-CERT FALLCHILL Nov 2017),(Citation: SentinelLabs Metador Sept 2022),(Citation: Rancor Unit42 June 2018),(Citation: Intezer HiddenWasp Map 2019),(Citation: Carbon Black HotCroissant April 2020),(Citation: Checkpoint IndigoZebra July 2021),(Citation: Moran 2014),(Citation: McAfee Lazarus Resurfaces Feb 2018),(Citation: Kaspersky Cloud Atlas December 2014),(Citation: TrendMicro Patchwork Dec 2017),(Citation: Cisco H1N1 Part 2),(Citation: Trend Micro Tick November 2019),","['actor', 'process', 'data flow']","[{'mitigation id': 'M1031', 'mitigation name': 'Network Intrusion Prevention', 'mitigation description': 'Use intrusion detection signatures to block traffic at network boundaries.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1031'}]"
T1573.002,Encrypted Channel: Asymmetric Cryptography,"Adversaries may employ a known asymmetric encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol. Asymmetric cryptography, also known as public key cryptography, uses a keypair per party: one public that can be freely distributed, and one private. Due to how the keys are generated, the sender encrypts data with the receiver’s public key and the receiver decrypts the data with their private key. This ensures that only the intended recipient can read the encrypted data. Common public key encryption algorithms include RSA and ElGamal.

For efficiency, many protocols (including SSL/TLS) use symmetric cryptography once a connection is established, but use asymmetric cryptography to establish or transmit a key. As such, these protocols are classified as [Asymmetric Cryptography](https://attack.mitre.org/techniques/T1573/002).",https://attack.mitre.org/techniques/T1573/002,16 March 2020,20 April 2021,1.0,['Command and Control'],"SSL/TLS inspection is one way of detecting command and control traffic within some encrypted communication channels.(Citation: SANS Decrypting SSL) SSL/TLS inspection does come with certain risks that should be considered before implementing to avoid potential security issues such as incomplete certificate validation.(Citation: SEI SSL Inspection Risks)

In general, analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)","['Linux', 'Windows', 'macOS']",Network Traffic: Network Traffic Content,True,T1573,,,,,,,,"(Citation: CISA WellMess July 2020),(Citation: FireEye FiveHands April 2021),(Citation: Group IB Cobalt Aug 2017),(Citation: FireEye Know Your Enemy FIN8 Aug 2016),(Citation: IBM IcedID November 2017),(Citation: Group IB GrimAgent July 2021),(Citation: Securelist APT10 March 2021),(Citation: ESET Kobalos Feb 2021),(Citation: CISA WellMail July 2020),(Citation: PWC WellMess July 2020),(Citation: MSTIC NOBELIUM Mar 2021),(Citation: Check Point Pay2Key November 2020),(Citation: TrendMicro Tropic Trooper Mar 2018),(Citation: ESET Gazer Aug 2017),(Citation: FireEye POSHSPY April 2017),(Citation: Talos PoetRAT April 2020),(Citation: Talos Promethium June 2020),(Citation: MalwareBytes WoodyRAT Aug 2022),(Citation: Microsoft PLATINUM April 2016),(Citation: CISA ComRAT Oct 2020),(Citation: Securelist WhiteBear Aug 2017),(Citation: DHS CISA AA22-055A MuddyWater February 2022),(Citation: Secureworks Karagany July 2019),(Citation: ESET Sednit Part 2),(Citation: Medium Metamorfo Apr 2020),(Citation: FoxIT Wocao December 2019),(Citation: TrendMicro Tropic Trooper May 2020),(Citation: ESET Kobalos Jan 2021),(Citation: Github Koadic),(Citation: ESET Zebrocy May 2019),(Citation: CISA AR21-126A FIVEHANDS May 2021),(Citation: CISA Zebrocy Oct 2020),(Citation: Blasco 2013),(Citation: Kaspersky Dridex May 2017),(Citation: Kaspersky Sodin July 2019),(Citation: Juniper IcedID June 2020),(Citation: Trend Micro Emotet Jan 2019),(Citation: PWC WellMess C2 August 2020),(Citation: Fidelis Hi-Zor),(Citation: Cybersecurity Advisory SVR TTP May 2021),(Citation: Bitdefender APT28 Dec 2015),(Citation: ESET Attor Oct 2019),(Citation: Mandiant APT1 Appendix),(Citation: Bleeping Computer Op Sharpshooter March 2019),(Citation: BlackBerry CostaRicto November 2020),(Citation: SecureWorks WannaCry Analysis),(Citation: US-CERT Volgmer Nov 2017),(Citation: Intezer Doki July 20),(Citation: Prevailion DarkWatchman 2021),(Citation: Cylance Machete Mar 2017),(Citation: ESET GreyEnergy Oct 2018),(Citation: Mythc Documentation),(Citation: FireEye APT34 Webinar Dec 2017),(Citation: Mandiant APT41),(Citation: ESET Zebrocy Nov 2018),(Citation: Talos TinyTurla September 2021),(Citation: Github PowerShell Empire),(Citation: IBM Grandoreiro April 2020),(Citation: GitHub Pupy),(Citation: NCSC APT29 July 2020),(Citation: Proofpoint TA505 Jan 2019),(Citation: FireEye MuddyWater Mar 2018),(Citation: Invincea XTunnel),(Citation: Talos Cobalt Strike September 2020),(Citation: Accenture HyperStack October 2020),(Citation: FireEye APT29 Nov 2018),(Citation: Zscaler Bazar September 2020),(Citation: Leonardo Turla Penquin May 2020),(Citation: Bishop Fox Sliver Framework August 2019),(Citation: GitHub Sliver Encryption),(Citation: ESET ComRAT May 2020),(Citation: NCSC Cyclops Blink February 2022),(Citation: FireEye FIN6 April 2016),(Citation: Dingledine Tor The Second-Generation Onion Router),","['actor', 'process', 'data flow']","[{'mitigation id': 'M1020', 'mitigation name': 'SSL/TLS Inspection', 'mitigation description': 'Break and inspect SSL/TLS sessions to look at encrypted web traffic for adversary activity.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1020'}, {'mitigation id': 'M1031', 'mitigation name': 'Network Intrusion Prevention', 'mitigation description': 'Use intrusion detection signatures to block traffic at network boundaries.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1031'}]"
T1606,Forge Web Credentials,"Adversaries may forge credential materials that can be used to gain access to web applications or Internet services. Web applications and services (hosted in cloud SaaS environments or on-premise servers) often use session cookies, tokens, or other materials to authenticate and authorize user access.

Adversaries may generate these credential materials in order to gain access to web resources. This differs from [Steal Web Session Cookie](https://attack.mitre.org/techniques/T1539), [Steal Application Access Token](https://attack.mitre.org/techniques/T1528), and other similar behaviors in that the credentials are new and forged by the adversary, rather than stolen or intercepted from legitimate users. The generation of web credentials often requires secret values, such as passwords, [Private Keys](https://attack.mitre.org/techniques/T1552/004), or other cryptographic seed values.(Citation: GitHub AWS-ADFS-Credential-Generator) Adversaries may also forge tokens by taking advantage of features such as the `AssumeRole` and `GetFederationToken` APIs in AWS, which allow users to request temporary security credentials.(Citation: AWS Temporary Security Credentials)

Once forged, adversaries may use these web credentials to access resources (ex: [Use Alternate Authentication Material](https://attack.mitre.org/techniques/T1550)), which may bypass multi-factor and other authentication protection mechanisms.(Citation: Pass The Cookie)(Citation: Unit 42 Mac Crypto Cookies January 2019)(Citation: Microsoft SolarWinds Customer Guidance)  ",https://attack.mitre.org/techniques/T1606,17 December 2020,04 May 2023,1.3,['Credential Access'],"Monitor for anomalous authentication activity, such as logons or other user session activity associated with unknown accounts. Monitor for unexpected and abnormal access to resources, including access of websites and cloud-based applications by the same user in different locations or by different systems that do not match expected configurations.","['Azure AD', 'Google Workspace', 'IaaS', 'Linux', 'Office 365', 'SaaS', 'Windows', 'macOS']","Logon Session: Logon Session Creation, Web Credential: Web Credential Creation, Web Credential: Web Credential Usage",False,,[],"Dylan Silva, AWS Security",,,,,,",(Citation: Microsoft SolarWinds Customer Guidance),(Citation: Crowdstrike AWS User Federation Persistence),(Citation: FireEye ADFS)","['actor', 'process', 'data store', 'data flow']","[{'mitigation id': 'M1018', 'mitigation name': 'User Account Management', 'mitigation description': 'Manage the creation, modification, use, and permissions associated to user accounts.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1018'}, {'mitigation id': 'M1026', 'mitigation name': 'Privileged Account Management', 'mitigation description': 'Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1026'}, {'mitigation id': 'M1047', 'mitigation name': 'Audit', 'mitigation description': 'Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1047'}, {'mitigation id': 'M1054', 'mitigation name': 'Software Configuration', 'mitigation description': 'Implement configuration changes to software (other than the operating system) to mitigate security risks associated to how the software operates.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1054'}]"
T1606.001,Forge Web Credentials: Web Cookies,"Adversaries may forge web cookies that can be used to gain access to web applications or Internet services. Web applications and services (hosted in cloud SaaS environments or on-premise servers) often use session cookies to authenticate and authorize user access.

Adversaries may generate these cookies in order to gain access to web resources. This differs from [Steal Web Session Cookie](https://attack.mitre.org/techniques/T1539) and other similar behaviors in that the cookies are new and forged by the adversary, rather than stolen or intercepted from legitimate users. Most common web applications have standardized and documented cookie values that can be generated using provided tools or interfaces.(Citation: Pass The Cookie) The generation of web cookies often requires secret values, such as passwords, [Private Keys](https://attack.mitre.org/techniques/T1552/004), or other cryptographic seed values.

Once forged, adversaries may use these web cookies to access resources ([Web Session Cookie](https://attack.mitre.org/techniques/T1550/004)), which may bypass multi-factor and other authentication protection mechanisms.(Citation: Volexity SolarWinds)(Citation: Pass The Cookie)(Citation: Unit 42 Mac Crypto Cookies January 2019)",https://attack.mitre.org/techniques/T1606/001,17 December 2020,20 September 2021,1.1,['Credential Access'],"Monitor for anomalous authentication activity, such as logons or other user session activity associated with unknown accounts. Monitor for unexpected and abnormal access to resources, including access of websites and cloud-based applications by the same user in different locations or by different systems that do not match expected configurations.","['IaaS', 'Linux', 'SaaS', 'Windows', 'macOS']","Logon Session: Logon Session Creation, Web Credential: Web Credential Usage",True,T1606,,"Jen Burns, HubSpot",,,,,,"(Citation: Volexity SolarWinds),","['actor', 'process', 'data store', 'data flow']","[{'mitigation id': 'M1047', 'mitigation name': 'Audit', 'mitigation description': 'Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1047'}, {'mitigation id': 'M1054', 'mitigation name': 'Software Configuration', 'mitigation description': 'Implement configuration changes to software (other than the operating system) to mitigate security risks associated to how the software operates.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1054'}]"
T1621,Multi-Factor Authentication Request Generation,"Adversaries may attempt to bypass multi-factor authentication (MFA) mechanisms and gain access to accounts by generating MFA requests sent to users.

Adversaries in possession of credentials to [Valid Accounts](https://attack.mitre.org/techniques/T1078) may be unable to complete the login process if they lack access to the 2FA or MFA mechanisms required as an additional credential and security control. To circumvent this, adversaries may abuse the automatic generation of push notifications to MFA services such as Duo Push, Microsoft Authenticator, Okta, or similar services to have the user grant access to their account.

In some cases, adversaries may continuously repeat login attempts in order to bombard users with MFA push notifications, SMS messages, and phone calls, potentially resulting in the user finally accepting the authentication request in response to “MFA fatigue.”(Citation: Russian 2FA Push Annoyance - Cimpanu)(Citation: MFA Fatigue Attacks - PortSwigger)(Citation: Suspected Russian Activity Targeting Government and Business Entities Around the Globe)",https://attack.mitre.org/techniques/T1621,01 April 2022,04 April 2023,1.0,['Credential Access'],"Monitor user account logs as well as 2FA/MFA application logs for suspicious events: unusual login attempt source location, mismatch in location of login attempt and smart device receiving 2FA/MFA request prompts, and high volume of repeated login attempts, all of which may indicate user's primary credentials have been compromised minus 2FA/MFA mechanism. ","['Azure AD', 'Google Workspace', 'IaaS', 'Linux', 'Office 365', 'SaaS', 'Windows', 'macOS']","Application Log: Application Log Content, Logon Session: Logon Session Creation, Logon Session: Logon Session Metadata, User Account: User Account Authentication",False,,[],"Jon Sternstein, Stern Security; Pawel Partyka, Microsoft 365 Defender; Shanief Webb",,,,,,"(Citation: MSTIC DEV-0537 Mar 2022),(Citation: Suspected Russian Activity Targeting Government and Business Entities Around the Globe),(Citation: Microsoft Common Conditional Access Policies),(Citation: MFA Fatigue Attacks - PortSwigger)","['actor', 'process', 'data store', 'data flow']","[{'mitigation id': 'M1017', 'mitigation name': 'User Training', 'mitigation description': 'Train users to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1017'}, {'mitigation id': 'M1032', 'mitigation name': 'Multi-factor Authentication', 'mitigation description': 'Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1032'}, {'mitigation id': 'M1036', 'mitigation name': 'Account Use Policies', 'mitigation description': 'Configure features related to account use like login attempt lockouts, specific login times, etc.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1036'}]"
T1649,Steal or Forge Authentication Certificates,"Adversaries may steal or forge certificates used for authentication to access remote systems or resources. Digital certificates are often used to sign and encrypt messages and/or files. Certificates are also used as authentication material. For example, Azure AD device certificates and Active Directory Certificate Services (AD CS) certificates bind to an identity and can be used as credentials for domain accounts.(Citation: O365 Blog Azure AD Device IDs)(Citation: Microsoft AD CS Overview)

Authentication certificates can be both stolen and forged. For example, AD CS certificates can be stolen from encrypted storage (in the Registry or files)(Citation: APT29 Deep Look at Credential Roaming), misplaced certificate files (i.e. [Unsecured Credentials](https://attack.mitre.org/techniques/T1552)), or directly from the Windows certificate store via various crypto APIs.(Citation: SpecterOps Certified Pre Owned)(Citation: GitHub CertStealer)(Citation: GitHub GhostPack Certificates) With appropriate enrollment rights, users and/or machines within a domain can also request and/or manually renew certificates from enterprise certificate authorities (CA). This enrollment process defines various settings and permissions associated with the certificate. Of note, the certificate’s extended key usage (EKU) values define signing, encryption, and authentication use cases, while the certificate’s subject alternative name (SAN) values define the certificate owner’s alternate names.(Citation: Medium Certified Pre Owned)

Abusing certificates for authentication credentials may enable other behaviors such as [Lateral Movement](https://attack.mitre.org/tactics/TA0008). Certificate-related misconfigurations may also enable opportunities for [Privilege Escalation](https://attack.mitre.org/tactics/TA0004), by way of allowing users to impersonate or assume privileged accounts or permissions via the identities (SANs) associated with a certificate. These abuses may also enable [Persistence](https://attack.mitre.org/tactics/TA0003) via stealing or forging certificates that can be used as [Valid Accounts](https://attack.mitre.org/techniques/T1078) for the duration of the certificate's validity, despite user password resets. Authentication certificates can also be stolen and forged for machine accounts.

Adversaries who have access to root (or subordinate) CA certificate private keys (or mechanisms protecting/managing these keys) may also establish [Persistence](https://attack.mitre.org/tactics/TA0003) by forging arbitrary authentication certificates for the victim domain (known as “golden” certificates).(Citation: Medium Certified Pre Owned) Adversaries may also target certificates and related services in order to access other forms of credentials, such as [Golden Ticket](https://attack.mitre.org/techniques/T1558/001) ticket-granting tickets (TGT) or NTLM plaintext.(Citation: Medium Certified Pre Owned)",https://attack.mitre.org/techniques/T1649,03 August 2022,02 March 2023,1.1,['Credential Access'],,"['Azure AD', 'Linux', 'Windows', 'macOS']","Active Directory: Active Directory Credential Request, Active Directory: Active Directory Object Modification, Application Log: Application Log Content, Command: Command Execution, File: File Access, Logon Session: Logon Session Creation, Windows Registry: Windows Registry Key Access",False,,[],"Lee Christensen, SpecterOps; Thirumalai Natarajan, Mandiant; Tristan Bennett, Seamless Intelligence",,,,,,"(Citation: Adsecurity Mimikatz Guide),(Citation: Mandiant APT29 Trello),(Citation: AADInternals Documentation),(Citation: SpecterOps Certified Pre Owned),(Citation: GitHub PSPKIAudit),(Citation: GitHub Certify)","['actor', 'process', 'data store', 'data flow']","[{'mitigation id': 'M1015', 'mitigation name': 'Active Directory Configuration', 'mitigation description': 'Configure Active Directory to prevent use of certain techniques; use SID Filtering, etc.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1015'}, {'mitigation id': 'M1041', 'mitigation name': 'Encrypt Sensitive Information', 'mitigation description': 'Protect sensitive information with strong encryption.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1041'}, {'mitigation id': 'M1042', 'mitigation name': 'Disable or Remove Feature or Program', 'mitigation description': 'Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1042'}, {'mitigation id': 'M1047', 'mitigation name': 'Audit', 'mitigation description': 'Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1047'}]"
