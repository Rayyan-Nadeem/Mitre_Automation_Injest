ID,name,description,url,created,last modified,version,tactics,detection,platforms,data sources,is sub-technique,sub-technique of,defenses bypassed,contributors,permissions required,supports remote,system requirements,impact type,effective permissions,relationship citations,entities,mitigations
T1021.007,Remote Services: Cloud Services,"Adversaries may log into accessible cloud services within a compromised environment using [Valid Accounts](https://attack.mitre.org/techniques/T1078) that are synchronized with or federated to on-premises user identities. The adversary may then perform management actions or access cloud-hosted resources as the logged-on user. 

Many enterprises federate centrally managed user identities to cloud services, allowing users to login with their domain credentials in order to access the cloud control plane. Similarly, adversaries may connect to available cloud services through the web console or through the cloud command line interface (CLI) (e.g., [Cloud API](https://attack.mitre.org/techniques/T1059/009)), using commands such as <code>Connect-AZAccount</code> for Azure PowerShell, <code>Connect-MgGraph</code> for Microsoft Graph PowerShell, and <code>gcloud auth login</code> for the Google Cloud CLI.

In some cases, adversaries may be able to authenticate to these services via [Application Access Token](https://attack.mitre.org/techniques/T1550/001) instead of a username and password. ",https://attack.mitre.org/techniques/T1021/007,21 February 2023,14 April 2023,1.0,['Lateral Movement'],,"['Azure AD', 'Google Workspace', 'IaaS', 'Office 365', 'SaaS']",Logon Session: Logon Session Creation,True,T1021,,,,,,,,"(Citation: Mandiant Remediation and Hardening Strategies for Microsoft 365),(Citation: Protecting Microsoft 365 From On-Premises Attacks)","['actor', 'process']","[{'mitigation id': 'M1026', 'mitigation name': 'Privileged Account Management', 'mitigation description': 'Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1026'}, {'mitigation id': 'M1032', 'mitigation name': 'Multi-factor Authentication', 'mitigation description': 'Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1032'}]"
T1059,Command and Scripting Interpreter,"Adversaries may abuse command and script interpreters to execute commands, scripts, or binaries. These interfaces and languages provide ways of interacting with computer systems and are a common feature across many different platforms. Most systems come with some built-in command-line interface and scripting capabilities, for example, macOS and Linux distributions include some flavor of [Unix Shell](https://attack.mitre.org/techniques/T1059/004) while Windows installations include the [Windows Command Shell](https://attack.mitre.org/techniques/T1059/003) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).

There are also cross-platform interpreters such as [Python](https://attack.mitre.org/techniques/T1059/006), as well as those commonly associated with client applications such as [JavaScript](https://attack.mitre.org/techniques/T1059/007) and [Visual Basic](https://attack.mitre.org/techniques/T1059/005).

Adversaries may abuse these technologies in various ways as a means of executing arbitrary commands. Commands and scripts can be embedded in [Initial Access](https://attack.mitre.org/tactics/TA0001) payloads delivered to victims as lure documents or as secondary payloads downloaded from an existing C2. Adversaries may also execute commands through interactive terminals/shells, as well as utilize various [Remote Services](https://attack.mitre.org/techniques/T1021) in order to achieve remote Execution.(Citation: Powershell Remote Commands)(Citation: Cisco IOS Software Integrity Assurance - Command History)(Citation: Remote Shell Execution in Python)",https://attack.mitre.org/techniques/T1059,31 May 2017,27 March 2023,2.4,['Execution'],"Command-line and scripting activities can be captured through proper logging of process execution with command-line arguments. This information can be useful in gaining additional insight to adversaries' actions through how they use native processes or custom tools. Also monitor for loading of modules associated with specific languages.

If scripting is restricted for normal users, then any attempt to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent.

Scripts are likely to perform actions with various effects on a system that may generate events, depending on the types of monitoring used. Monitor processes and command-line arguments for script execution and subsequent behavior. Actions may be related to network and system information discovery, collection, or other scriptable post-compromise behaviors and could be used as indicators of detection leading back to the source script.","['Azure AD', 'Google Workspace', 'IaaS', 'Linux', 'Network', 'Office 365', 'Windows', 'macOS']","Command: Command Execution, Module: Module Load, Process: Process Creation, Process: Process Metadata, Script: Script Execution",False,,[],,,True,,,,"(Citation: FireEye FiveHands April 2021),(Citation: Unit 42 OopsIE! Feb 2018),(Citation: Unit 42 QUADAGENT July 2018),(Citation: FireEye FIN6 Apr 2019),(Citation: FireEye FIN7 Aug 2018),(Citation: ClearSky Pay2Kitten December 2020),(Citation: NCC Group APT15 Alive and Strong),(Citation: Symantec Whitefly March 2019),(Citation: Crowdstrike DNC June 2016),(Citation: FireEye APT19),(Citation: ESET Sednit Part 2),(Citation: ANSSI Sandworm January 2021),(Citation: QiAnXin APT-C-36 Feb2019),(Citation: FireEye APT37 Feb 2018),(Citation: Mandiant Operation Ke3chang November 2014),(Citation: Cybereason Cobalt Kitty 2017),(Citation: ESET ForSSHe December 2018),(Citation: Flashpoint FIN 7 March 2019),(Citation: NCC Group Fivehands June 2021),(Citation: Proofpoint TA505 October 2019),(Citation: Citizen Lab Stealth Falcon May 2016),(Citation: CheckPoint Bandook Nov 2020),(Citation: Nccgroup Gh0st April 2018),(Citation: Donut Github),(Citation: Securelist Brazilian Banking Malware July 2020),(Citation: FireEye Hacking Team),(Citation: FireEye APT34 Dec 2017),(Citation: US-CERT TA18-074A),(Citation: GDATA Zeus Panda June 2017),(Citation: Mandiant FIN5 GrrCON Oct 2016),(Citation: FireEye APT39 Jan 2019),(Citation: ESET Operation Spalax Jan 2021),(Citation: FBI FLASH APT39 September 2020),(Citation: Github PowerShell Empire),(Citation: Malwarebytes DarkComet March 2018),(Citation: ClearSky Wilted Tulip July 2017),(Citation: Talos PoetRAT October 2020),(Citation: FireEye FIN6 April 2016),(Citation: Unit42 OilRig Nov 2018),(Citation: CheckPoint SpeakUp Feb 2019),(Citation: Volexity InkySquid RokRAT August 2021),(Citation: OilRig ISMAgent July 2017),(Citation: Microsoft PS JEA),(Citation: Microsoft PowerShell CLM),(Citation: Netspi PowerShell Execution Policy Bypass),(Citation: win10_asr)",['process'],"[{'mitigation id': 'M1021', 'mitigation name': 'Restrict Web-Based Content', 'mitigation description': 'Restrict use of certain websites, block downloads/attachments, block Javascript, restrict browser extensions, etc.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1021'}, {'mitigation id': 'M1026', 'mitigation name': 'Privileged Account Management', 'mitigation description': 'Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1026'}, {'mitigation id': 'M1038', 'mitigation name': 'Execution Prevention', 'mitigation description': 'Block execution of code on a system through application control, and/or script blocking.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1038'}, {'mitigation id': 'M1040', 'mitigation name': 'Behavior Prevention on Endpoint', 'mitigation description': 'Use capabilities to prevent suspicious behavior patterns from occurring on endpoint systems. This could include suspicious process, file, API call, etc. behavior.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1040'}, {'mitigation id': 'M1042', 'mitigation name': 'Disable or Remove Feature or Program', 'mitigation description': 'Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1042'}, {'mitigation id': 'M1045', 'mitigation name': 'Code Signing', 'mitigation description': 'Enforce binary and application integrity with digital signature verification to prevent untrusted code from executing.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1045'}, {'mitigation id': 'M1049', 'mitigation name': 'Antivirus/Antimalware', 'mitigation description': 'Use signatures or heuristics to detect malicious software.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1049'}]"
T1059.009,Command and Scripting Interpreter: Cloud API,"Adversaries may abuse cloud APIs to execute malicious commands. APIs available in cloud environments provide various functionalities and are a feature-rich method for programmatic access to nearly all aspects of a tenullt. These APIs may be utilized through various methods such as command line interpreters (CLIs), in-browser Cloud Shells, [PowerShell](https://attack.mitre.org/techniques/T1059/001) modules like Azure for PowerShell(Citation: Microsoft - Azure PowerShell), or software developer kits (SDKs) available for languages such as [Python](https://attack.mitre.org/techniques/T1059/006).  

Cloud API functionality may allow for administrative access across all major services in a tenullt such as compute, storage, identity and access management (IAM), networking, and security policies.

With proper permissions (often via use of credentials such as [Application Access Token](https://attack.mitre.org/techniques/T1550/001) and [Web Session Cookie](https://attack.mitre.org/techniques/T1550/004)), adversaries may abuse cloud APIs to invoke various functions that execute malicious actions. For example, CLI and PowerShell functionality may be accessed through binaries installed on cloud-hosted or on-premises hosts or accessed through a browser-based cloud shell offered by many cloud platforms (such as AWS, Azure, and GCP). These cloud shells are often a packaged unified environment to use CLI and/or scripting modules hosted as a container in the cloud environment.  ",https://attack.mitre.org/techniques/T1059/009,17 March 2022,14 April 2023,1.0,['Execution'],,"['Azure AD', 'Google Workspace', 'IaaS', 'Office 365', 'SaaS']",Command: Command Execution,True,T1059,,Caio Silva; Jason Sevilla; Marcus Weeks; Nichols Jasper; Ozan Olali,,False,,,,"(Citation: MSTIC Nobelium Toolset May 2021),(Citation: Talos TeamTNT),",['process'],"[{'mitigation id': 'M1026', 'mitigation name': 'Privileged Account Management', 'mitigation description': 'Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1026'}, {'mitigation id': 'M1038', 'mitigation name': 'Execution Prevention', 'mitigation description': 'Block execution of code on a system through application control, and/or script blocking.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1038'}]"
T1069,Permission Groups Discovery,"Adversaries may attempt to discover group and permission settings. This information can help adversaries determine which user accounts and groups are available, the membership of users in particular groups, and which users and groups have elevated permissions.

Adversaries may attempt to discover group permission settings in many different ways. This data may provide the adversary with information about the compromised environment that can be used in follow-on activity and targeting.(Citation: CrowdStrike BloodHound April 2018)",https://attack.mitre.org/techniques/T1069,31 May 2017,15 April 2023,2.5,['Discovery'],"System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained.

Monitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001). Monitor container logs for commands and/or API calls related to listing permissions for pods and nodes, such as <code>kubectl auth can-i</code>.(Citation: K8s Authorization Overview)","['Azure AD', 'Containers', 'Google Workspace', 'IaaS', 'Linux', 'Office 365', 'SaaS', 'Windows', 'macOS']","Application Log: Application Log Content, Command: Command Execution, Group: Group Enumeration, Group: Group Metadata, Process: Process Creation",False,,[],"Daniel Prizmant, Palo Alto Networks; Microsoft Threat Intelligence Center (MSTIC); Yuval Avrahami, Palo Alto Networks",,,,,,"(Citation: IBM IcedID November 2017),(Citation: FireEye Periscope March 2018),(Citation: Trend Micro TA505 June 2019),(Citation: Symantec Buckeye),(Citation: FOX-IT May 2016 Mofang),(Citation: Unit 42 Siloscape Jun 2021),(Citation: Cyberreason Anchor December 2019),(Citation: IBM TA505 April 2020),(Citation: GovCERT Carbon May 2016),(Citation: Volexity SolarWinds),","['actor', 'process', 'data store']",
T1069.003,Permission Groups Discovery: Cloud Groups,"Adversaries may attempt to find cloud groups and permission settings. The knowledge of cloud permission groups can help adversaries determine the particular roles of users and groups within an environment, as well as which users are associated with a particular group.

With authenticated access there are several tools that can be used to find permissions groups. The <code>Get-MsolRole</code> PowerShell cmdlet can be used to obtain roles and permissions groups for Exchange and Office 365 accounts (Citation: Microsoft Msolrole)(Citation: GitHub Raindance).

Azure CLI (AZ CLI) and the Google Cloud Identity Provider API also provide interfaces to obtain permissions groups. The command <code>az ad user get-member-groups</code> will list groups associated to a user account for Azure while the API endpoint <code>GET https://cloudidentity.googleapis.com/v1/groups</code> lists group resources available to a user for Google.(Citation: Microsoft AZ CLI)(Citation: Black Hills Red Teaming MS AD Azure, 2018)(Citation: Google Cloud Identity API Documentation) In AWS, the commands `ListRolePolicies` and `ListAttachedRolePolicies` allow users to enumerate the policies attached to a role.(Citation: Palo Alto Unit 42 Compromised Cloud Compute Credentials 2022)

Adversaries may attempt to list ACLs for objects to determine the owner and other accounts with access to the object, for example, via the AWS <code>GetBucketAcl</code> API (Citation: AWS Get Bucket ACL). Using this information an adversary can target accounts with permissions to a given object or leverage accounts they have already compromised to access the object.",https://attack.mitre.org/techniques/T1069/003,21 February 2020,21 March 2023,1.4,['Discovery'],"System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained.

Monitor processes and command-line arguments for actions that could be taken to gather system and network information. Activity and account logs for the cloud services can also be monitored for suspicious commands that are anomalous compared to a baseline of normal activity.","['Azure AD', 'Google Workspace', 'IaaS', 'Office 365', 'SaaS']","Application Log: Application Log Content, Command: Command Execution, Group: Group Enumeration, Group: Group Metadata, Process: Process Creation",True,T1069,,"Isif Ibrahima, Mandiant; Regina Elwell",,,,,,"(Citation: Roadtools),(Citation: AADInternals Documentation),","['actor', 'process', 'data store']",
T1078,Valid Accounts,"Adversaries may obtain and abuse credentials of existing accounts as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion. Compromised credentials may be used to bypass access controls placed on various resources on systems within the network and may even be used for persistent access to remote systems and externally available services, such as VPNs, Outlook Web Access, network devices, and remote desktop.(Citation: volexity_0day_sophos_FW) Compromised credentials may also grant an adversary increased privilege to specific systems or access to restricted areas of the network. Adversaries may choose not to use malware or tools in conjunction with the legitimate access those credentials provide to make it harder to detect their presence.

In some cases, adversaries may abuse inactive accounts: for example, those belonging to individuals who are no longer part of an organization. Using these accounts may allow the adversary to evade detection, as the original account user will not be present to identify any anomalous activity taking place on their account.(Citation: CISA MFA PrintNightmare)

The overlap of permissions for local, domain, and cloud accounts across a network of systems is of concern because the adversary may be able to pivot across accounts and systems to reach a high level of access (i.e., domain or enterprise administrator) to bypass access controls set within the enterprise.(Citation: TechNet Credential Theft)",https://attack.mitre.org/techniques/T1078,31 May 2017,30 March 2023,2.6,"['Defense Evasion', 'Initial Access', 'Persistence', 'Privilege Escalation']","Configure robust, consistent account activity audit policies across the enterprise and with externally accessible services.(Citation: TechNet Audit Policy) Look for suspicious account behavior across systems that share accounts, either user, admin, or service accounts. Examples: one account logged into multiple systems simultaneously; multiple accounts logged into the same machine simultaneously; accounts logged in at odd times or outside of business hours. Activity may be from interactive login sessions or process ownership from accounts being used to execute binaries on a remote system as a particular account. Correlate other security systems with login information (e.g., a user has an active login session but has not entered the building or does not have VPN access).

Perform regular audits of domain and local system accounts to detect accounts that may have been created by an adversary for persistence. Checks on these accounts could also include whether default accounts such as Guest have been activated. These audits should also include checks on any appliances and applications for default credentials or SSH keys, and if any are discovered, they should be updated immediately.","['Azure AD', 'Containers', 'Google Workspace', 'IaaS', 'Linux', 'Network', 'Office 365', 'SaaS', 'Windows', 'macOS']","Logon Session: Logon Session Creation, Logon Session: Logon Session Metadata, User Account: User Account Authentication",False,,[],"Goldstein Menachem; Jon Sternstein, Stern Security; Mark Wee; Netskope; Praetorian; Prasad Somasamudram, McAfee; Sekhar Sarukkai, McAfee; Syed Ummar Farooqh, McAfee; Yossi Weizman, Azure Defender Research Team","['Administrator', 'User']",,,,"Administrator, User","(Citation: CrowdStrike Grim Spider May 2019),(Citation: US-CERT Ukraine Feb 2016),(Citation: Crowdstrike GTR2020 Mar 2020),(Citation: FireEye Know Your Enemy FIN8 Aug 2016),(Citation: Microsoft POLONIUM June 2022),(Citation: Securelist APT10 March 2021),(Citation: MSTIC NOBELIUM Mar 2021),(Citation: Anomali Linux Rabbit 2018),(Citation: FireEye FIN6 Apr 2019),(Citation: PWC Cloud Hopper April 2017),(Citation: FireEye APT33 Guardrail),(Citation: CISA AA20-259A Iran-Based Actor September 2020),(Citation: Bizeul 2014),(Citation: Symantec Seaduke 2015),(Citation: Mandiant APT29 Microsoft 365 2022),(Citation: FireEye FIN10 June 2017),(Citation: FireEye Hacking FIN4 Dec 2014),(Citation: Microsoft NICKEL December 2021),(Citation: DOJ GRU Indictment Jul 2018),(Citation: FireEye Respond Webinar July 2017),(Citation: Symantec Suckfly May 2016),(Citation: FoxIT Wocao December 2019),(Citation: FireEye SUNBURST Backdoor December 2020),(Citation: Kaspersky Carbanak),(Citation: Kaspersky ThreatNeedle Feb 2021),(Citation: Symantec W32.Duqu),(Citation: Accenture MUDCARP March 2019),(Citation: DOJ Iran Indictments March 2018),(Citation: Unit42 OilRig Playbook 2023),(Citation: ESET Industroyer),(Citation: Symantec Cicada November 2020),(Citation: Cybersecurity Advisory SVR TTP May 2021),(Citation: FireEye TRITON 2019),(Citation: CrowdStrike Carbon Spider August 2021),(Citation: Cybersecurity Advisory GRU Brute Force Campaign July 2021),(Citation: Visa FIN6 Feb 2019),(Citation: Cybereason Soft Cell June 2019),(Citation: RSA2017 Detect and Respond Adair),(Citation: Microsoft STRONTIUM Aug 2019),(Citation: CISA AA20-296A Berserk Bear December 2020),(Citation: Aqua Kinsing April 2020),(Citation: CyberBit Dtrack),(Citation: Cycraft Chimera April 2020),(Citation: McAfee Night Dragon),(Citation: MSTIC DEV-0537 Mar 2022),(Citation: FireEye APT41 Aug 2019),(Citation: Novetta-Axiom),(Citation: US-CERT TA18-074A),(Citation: FireEye APT33 Webinar Sept 2017),(Citation: FireEye APT34 Webinar Dec 2017),(Citation: Trend Micro Pawn Storm April 2017),(Citation: FireEye APT39 Jan 2019),(Citation: Mandiant FIN5 GrrCON Oct 2016),(Citation: Dell TG-3390),(Citation: District Court of NY APT10 Indictment December 2018),(Citation: CISA AA21-200A APT40 July 2021),(Citation: DarkReading FireEye FIN5 Oct 2015),(Citation: Gigamon Berserk Bear October 2021),(Citation: FireEye Hacking FIN4 Video Dec 2014),(Citation: Group IB Silence Sept 2018),(Citation: FireEye FIN6 April 2016),(Citation: TechNet Least Privilege),(Citation: Microsoft Common Conditional Access Policies),(Citation: Microsoft Securing Privileged Access),(Citation: TechNet Credential Theft),(Citation: US-CERT Alert TA13-175A Risks of Default Passwords on the Internet)","['actor', 'process', 'data store']","[{'mitigation id': 'M1013', 'mitigation name': 'Application Developer Guidance', 'mitigation description': 'This mitigation describes any guidance or training given to developers of applications to avoid introducing security weaknesses that an adversary may be able to take advantage of.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1013'}, {'mitigation id': 'M1015', 'mitigation name': 'Active Directory Configuration', 'mitigation description': 'Configure Active Directory to prevent use of certain techniques; use SID Filtering, etc.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1015'}, {'mitigation id': 'M1017', 'mitigation name': 'User Training', 'mitigation description': 'Train users to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1017'}, {'mitigation id': 'M1018', 'mitigation name': 'User Account Management', 'mitigation description': 'Manage the creation, modification, use, and permissions associated to user accounts.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1018'}, {'mitigation id': 'M1026', 'mitigation name': 'Privileged Account Management', 'mitigation description': 'Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1026'}, {'mitigation id': 'M1027', 'mitigation name': 'Password Policies', 'mitigation description': 'Set and enforce secure password policies for accounts.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1027'}, {'mitigation id': 'M1036', 'mitigation name': 'Account Use Policies', 'mitigation description': 'Configure features related to account use like login attempt lockouts, specific login times, etc.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1036'}]"
T1078.001,Valid Accounts: Default Accounts,"Adversaries may obtain and abuse credentials of a default account as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion. Default accounts are those that are built-into an OS, such as the Guest or Administrator accounts on Windows systems. Default accounts also include default factory/provider set accounts on other types of systems, software, or devices, including the root user account in AWS and the default service account in Kubernetes.(Citation: Microsoft Local Accounts Feb 2019)(Citation: AWS Root User)(Citation: Threat Matrix for Kubernetes)

Default accounts are not limited to client machines, rather also include accounts that are preset for equipment such as network devices and computer applications whether they are internal, open source, or commercial. Appliances that come preset with a username and password combination pose a serious threat to organizations that do not change it post installation, as they are easy targets for an adversary. Similarly, adversaries may also utilize publicly disclosed or stolen [Private Keys](https://attack.mitre.org/techniques/T1552/004) or credential materials to legitimately connect to remote environments via [Remote Services](https://attack.mitre.org/techniques/T1021).(Citation: Metasploit SSH Module)",https://attack.mitre.org/techniques/T1078/001,13 March 2020,30 March 2023,1.2,"['Defense Evasion', 'Initial Access', 'Persistence', 'Privilege Escalation']","Monitor whether default accounts have been activated or logged into. These audits should also include checks on any appliances and applications for default credentials or SSH keys, and if any are discovered, they should be updated immediately.","['Azure AD', 'Containers', 'Google Workspace', 'IaaS', 'Linux', 'Office 365', 'SaaS', 'Windows', 'macOS']","Logon Session: Logon Session Creation, User Account: User Account Authentication",True,T1078,,,"['Administrator', 'User']",,,,,"(Citation: Accenture HyperStack October 2020),(Citation: Nicolas Falliere, Liam O Murchu, Eric Chien February 2011),(Citation: DFIR Phosphorus November 2021),(Citation: US-CERT Alert TA13-175A Risks of Default Passwords on the Internet)","['actor', 'process', 'data store']","[{'mitigation id': 'M1027', 'mitigation name': 'Password Policies', 'mitigation description': 'Set and enforce secure password policies for accounts.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1027'}]"
T1078.004,Valid Accounts: Cloud Accounts,"Adversaries may obtain and abuse credentials of a cloud account as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion. Cloud accounts are those created and configured by an organization for use by users, remote support, services, or for administration of resources within a cloud service provider or SaaS application. In some cases, cloud accounts may be federated with traditional identity management systems, such as Windows Active Directory.(Citation: AWS Identity Federation)(Citation: Google Federating GC)(Citation: Microsoft Deploying AD Federation)

Compromised credentials for cloud accounts can be used to harvest sensitive data from online storage accounts and databases. Access to cloud accounts can also be abused to gain Initial Access to a network by abusing a [Trusted Relationship](https://attack.mitre.org/techniques/T1199). Similar to [Domain Accounts](https://attack.mitre.org/techniques/T1078/002), compromise of federated cloud accounts may allow adversaries to more easily move laterally within an environment.

Once a cloud account is compromised, an adversary may perform [Account Manipulation](https://attack.mitre.org/techniques/T1098) - for example, by adding [Additional Cloud Roles](https://attack.mitre.org/techniques/T1098/003) - to maintain persistence and potentially escalate their privileges.",https://attack.mitre.org/techniques/T1078/004,13 March 2020,21 March 2023,1.5,"['Defense Evasion', 'Initial Access', 'Persistence', 'Privilege Escalation']","Monitor the activity of cloud accounts to detect abnormal or malicious behavior, such as accessing information outside of the normal function of the account or account usage at atypical hours.","['Azure AD', 'Google Workspace', 'IaaS', 'Office 365', 'SaaS']","Logon Session: Logon Session Creation, Logon Session: Logon Session Metadata, User Account: User Account Authentication",True,T1078,,"Jon Sternstein, Stern Security","['Administrator', 'User']",,,,,"(Citation: Microsoft NICKEL December 2021),(Citation: CrowdStrike StellarParticle January 2022),(Citation: Cybersecurity Advisory GRU Brute Force Campaign July 2021),(Citation: Peirates GitHub),(Citation: MSTIC DEV-0537 Mar 2022),(Citation: Mandiant APT29 Microsoft 365 2022),(Citation: Roadtools),(Citation: Microsoft Holmium June 2020),(Citation: Microsoft Azure security baseline for Azure Active Directory),(Citation: TechNet Least Privilege),(Citation: Microsoft Common Conditional Access Policies),(Citation: TechNet Credential Theft),(Citation: AWS - IAM Console Best Practices),(Citation: Microsoft Security Alerts for Azure AD Roles)","['actor', 'process', 'data store']","[{'mitigation id': 'M1015', 'mitigation name': 'Active Directory Configuration', 'mitigation description': 'Configure Active Directory to prevent use of certain techniques; use SID Filtering, etc.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1015'}, {'mitigation id': 'M1017', 'mitigation name': 'User Training', 'mitigation description': 'Train users to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1017'}, {'mitigation id': 'M1018', 'mitigation name': 'User Account Management', 'mitigation description': 'Manage the creation, modification, use, and permissions associated to user accounts.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1018'}, {'mitigation id': 'M1026', 'mitigation name': 'Privileged Account Management', 'mitigation description': 'Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1026'}, {'mitigation id': 'M1027', 'mitigation name': 'Password Policies', 'mitigation description': 'Set and enforce secure password policies for accounts.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1027'}, {'mitigation id': 'M1032', 'mitigation name': 'Multi-factor Authentication', 'mitigation description': 'Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1032'}, {'mitigation id': 'M1036', 'mitigation name': 'Account Use Policies', 'mitigation description': 'Configure features related to account use like login attempt lockouts, specific login times, etc.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1036'}]"
T1087,Account Discovery,"Adversaries may attempt to get a listing of valid accounts, usernames, or email addresses on a system or within a compromised environment. This information can help adversaries determine which accounts exist, which can aid in follow-on behavior such as brute-forcing, spear-phishing attacks, or account takeovers (e.g., [Valid Accounts](https://attack.mitre.org/techniques/T1078)).

Adversaries may use several methods to enumerate accounts, including abuse of existing tools, built-in commands, and potential misconfigurations that leak account names and roles or permissions in the targeted environment.

For examples, cloud environments typically provide easily accessible interfaces to obtain user lists. On hosts, adversaries can use default [PowerShell](https://attack.mitre.org/techniques/T1059/001) and other command line functionality to identify accounts. Information about email addresses and accounts may also be extracted by searching an infected system’s files.",https://attack.mitre.org/techniques/T1087,31 May 2017,15 April 2023,2.4,['Discovery'],"System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained.

Monitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).

Monitor for processes that can be used to enumerate user accounts, such as <code>net.exe</code> and <code>net1.exe</code>, especially when executed in quick succession.(Citation: Elastic - Koadiac Detection with EQL)","['Azure AD', 'Google Workspace', 'IaaS', 'Linux', 'Office 365', 'SaaS', 'Windows', 'macOS']","Command: Command Execution, File: File Access, Process: Process Creation",False,,[],"Daniel Stepanic, Elastic; Microsoft Threat Intelligence Center (MSTIC); Travis Smith, Tripwire",,,,,,"(Citation: MalwareBytes WoodyRAT Aug 2022),(Citation: FOX-IT May 2016 Mofang),(Citation: Volexity SolarWinds),(Citation: trendmicro xcsset xcode project 2020),(Citation: UCF STIG Elevation Account Enumeration)","['actor', 'process', 'data store']","[{'mitigation id': 'M1028', 'mitigation name': 'Operating System Configuration', 'mitigation description': 'Make configuration changes related to the operating system or a common feature of the operating system that result in system hardening against techniques.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1028'}]"
T1087.004,Account Discovery: Cloud Account,"Adversaries may attempt to get a listing of cloud accounts. Cloud accounts are those created and configured by an organization for use by users, remote support, services, or for administration of resources within a cloud service provider or SaaS application.

With authenticated access there are several tools that can be used to find accounts. The <code>Get-MsolRoleMember</code> PowerShell cmdlet can be used to obtain account names given a role or permissions group in Office 365.(Citation: Microsoft msolrolemember)(Citation: GitHub Raindance) The Azure CLI (AZ CLI) also provides an interface to obtain user accounts with authenticated access to a domain. The command <code>az ad user list</code> will list all users within a domain.(Citation: Microsoft AZ CLI)(Citation: Black Hills Red Teaming MS AD Azure, 2018) 

The AWS command <code>aws iam list-users</code> may be used to obtain a list of users in the current account while <code>aws iam list-roles</code> can obtain IAM roles that have a specified path prefix.(Citation: AWS List Roles)(Citation: AWS List Users) In GCP, <code>gcloud iam service-accounts list</code> and <code>gcloud projects get-iam-policy</code> may be used to obtain a listing of service accounts and users in a project.(Citation: Google Cloud - IAM Servie Accounts List API)",https://attack.mitre.org/techniques/T1087/004,21 February 2020,16 March 2021,1.2,['Discovery'],"Monitor processes, command-line arguments, and logs for actions that could be taken to gather information about cloud accounts, including the use of calls to cloud APIs that perform account discovery.

System and network discovery techniques normally occur throughout an operation as an adversary learns the environment, and also to an extent in normal network operations. Therefore discovery data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained.","['Azure AD', 'Google Workspace', 'IaaS', 'Office 365', 'SaaS']",Command: Command Execution,True,T1087,,Praetorian,['User'],,,,,"(Citation: MSTIC Nobelium Oct 2021),(Citation: Roadtools),(Citation: AADInternals Documentation),","['actor', 'process', 'data store']","[{'mitigation id': 'M1018', 'mitigation name': 'User Account Management', 'mitigation description': 'Manage the creation, modification, use, and permissions associated to user accounts.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1018'}, {'mitigation id': 'M1047', 'mitigation name': 'Audit', 'mitigation description': 'Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1047'}]"
T1098,Account Manipulation,"Adversaries may manipulate accounts to maintain access to victim systems. Account manipulation may consist of any action that preserves adversary access to a compromised account, such as modifying credentials or permission groups. These actions could also include account activity designed to subvert security policies, such as performing iterative password updates to bypass password duration policies and preserve the life of compromised credentials. 

In order to create or manipulate accounts, the adversary must already have sufficient permissions on systems or the domain. However, account manipulation may also lead to privilege escalation where modifications grant access to additional roles, permissions, or higher-privileged [Valid Accounts](https://attack.mitre.org/techniques/T1078).",https://attack.mitre.org/techniques/T1098,31 May 2017,12 April 2023,2.5,['Persistence'],"Collect events that correlate with changes to account objects and/or permissions on systems and the domain, such as event IDs 4738, 4728 and 4670.(Citation: Microsoft User Modified Event)(Citation: Microsoft Security Event 4670)(Citation: Microsoft Security Event 4670) Monitor for modification of accounts in correlation with other suspicious activity. Changes may occur at unusual times or from unusual systems. Especially flag events where the subject and target accounts differ(Citation: InsiderThreat ChangeNTLM July 2017) or that include additional flags such as changing a password without knowledge of the old password.(Citation: GitHub Mimikatz Issue 92 June 2017)

Monitor for use of credentials at unusual times or to unusual systems or services. This may also correlate with other suspicious activity.

Monitor for unusual permissions changes that may indicate excessively broad permissions being granted to compromised accounts. However, account manipulation may also lead to privilege escalation where modifications grant access to additional roles, permissions, or higher-privileged [Valid Accounts](https://attack.mitre.org/techniques/T1078)","['Azure AD', 'Google Workspace', 'IaaS', 'Linux', 'Network', 'Office 365', 'SaaS', 'Windows', 'macOS']","Active Directory: Active Directory Object Modification, Command: Command Execution, File: File Modification, Group: Group Modification, Process: Process Creation, User Account: User Account Modification",False,,[],"Jannie Li, Microsoft Threat Intelligence Center (MSTIC); Praetorian; Tim MalcomVetter; Wojciech Lesicki",,,,,,"(Citation: Adsecurity Mimikatz Guide),(Citation: US-CERT TA18-074A),(Citation: DFIR Report APT35 ProxyShell March 2022),(Citation: Metcalf 2015),(Citation: Symantec Calisto July 2018),(Citation: Dragos Crashoverride 2018),(Citation: KISA Operation Muzabi),(Citation: Proofpoint TA505 Jan 2019),(Citation: Novetta Blockbuster Destructive Malware),(Citation: aptsim),(Citation: FireEye SMOKEDHAM June 2021),(Citation: Volexity Exchange Marauder March 2021),(Citation: Novetta Blockbuster),(Citation: FireEye APT41 Aug 2019),","['actor', 'process']","[{'mitigation id': 'M1018', 'mitigation name': 'User Account Management', 'mitigation description': 'Manage the creation, modification, use, and permissions associated to user accounts.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1018'}, {'mitigation id': 'M1026', 'mitigation name': 'Privileged Account Management', 'mitigation description': 'Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1026'}, {'mitigation id': 'M1028', 'mitigation name': 'Operating System Configuration', 'mitigation description': 'Make configuration changes related to the operating system or a common feature of the operating system that result in system hardening against techniques.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1028'}, {'mitigation id': 'M1030', 'mitigation name': 'Network Segmentation', 'mitigation description': 'Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network. Configure separate virtual private cloud (VPC) instances to isolate critical cloud systems.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1030'}, {'mitigation id': 'M1032', 'mitigation name': 'Multi-factor Authentication', 'mitigation description': 'Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1032'}]"
T1098.001,Account Manipulation: Additional Cloud Credentials,"Adversaries may add adversary-controlled credentials to a cloud account to maintain persistent access to victim accounts and instances within the environment.

For example, adversaries may add credentials for Service Principals and Applications in addition to existing legitimate credentials in Azure AD.(Citation: Microsoft SolarWinds Customer Guidance)(Citation: Blue Cloud of Death)(Citation: Blue Cloud of Death Video) These credentials include both x509 keys and passwords.(Citation: Microsoft SolarWinds Customer Guidance) With sufficient permissions, there are a variety of ways to add credentials including the Azure Portal, Azure command line interface, and Azure or Az PowerShell modules.(Citation: Demystifying Azure AD Service Principals)

In infrastructure-as-a-service (IaaS) environments, after gaining access through [Cloud Accounts](https://attack.mitre.org/techniques/T1078/004), adversaries may generate or import their own SSH keys using either the <code>CreateKeyPair</code> or <code>ImportKeyPair</code> API in AWS or the <code>gcloud compute os-login ssh-keys add</code> command in GCP.(Citation: GCP SSH Key Add) This allows persistent access to instances within the cloud environment without further usage of the compromised cloud accounts.(Citation: Expel IO Evil in AWS)(Citation: Expel Behind the Scenes)

Adversaries may also use the <code>CreateAccessKey</code> API in AWS or the <code>gcloud iam service-accounts keys create</code> command in GCP to add access keys to an account. If the target account has different permissions from the requesting account, the adversary may also be able to escalate their privileges in the environment (i.e. [Cloud Accounts](https://attack.mitre.org/techniques/T1078/004)).(Citation: Rhino Security Labs AWS Privilege Escalation)

In AWS environments, adversaries with the appropriate permissions may also use the `sts:GetFederationToken` API call to create a temporary set of credentials tied to the permissions of the original user account. These credentials may remain valid for the duration of their lifetime even if the original account’s API credentials are deactivated.
(Citation: Crowdstrike AWS User Federation Persistence)",https://attack.mitre.org/techniques/T1098/001,19 January 2020,04 May 2023,2.5,['Persistence'],"Monitor Azure Activity Logs for Service Principal and Application modifications. Monitor for the usage of APIs that create or import SSH keys, particularly by unexpected users or accounts such as the root account.

Monitor for use of credentials at unusual times or to unusual systems or services. This may also correlate with other suspicious activity.","['Azure AD', 'IaaS', 'SaaS']",User Account: User Account Modification,True,T1098,,"Alex Soler, AttackIQ; Dylan Silva, AWS Security; Expel; Jannie Li, Microsoft Threat Intelligence Center (MSTIC); Oleg Kolesnikov, Securonix; Zur Ulianitzky, XM Cyber",,,,,,"(Citation: CrowdStrike StellarParticle January 2022),(Citation: Microsoft - Customer Guidance on Recent Nation-State Cyber Attacks),(Citation: Crowdstrike AWS User Federation Persistence),(Citation: Expel IO Evil in AWS)","['actor', 'process']","[{'mitigation id': 'M1018', 'mitigation name': 'User Account Management', 'mitigation description': 'Manage the creation, modification, use, and permissions associated to user accounts.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1018'}, {'mitigation id': 'M1026', 'mitigation name': 'Privileged Account Management', 'mitigation description': 'Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1026'}, {'mitigation id': 'M1030', 'mitigation name': 'Network Segmentation', 'mitigation description': 'Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network. Configure separate virtual private cloud (VPC) instances to isolate critical cloud systems.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1030'}, {'mitigation id': 'M1032', 'mitigation name': 'Multi-factor Authentication', 'mitigation description': 'Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1032'}]"
T1098.003,Account Manipulation: Additional Cloud Roles,"An adversary may add additional roles or permissions to an adversary-controlled cloud account to maintain persistent access to a tenullt. For example, adversaries may update IAM policies in cloud-based environments or add a new global administrator in Office 365 environments.(Citation: AWS IAM Policies and Permissions)(Citation: Google Cloud IAM Policies)(Citation: Microsoft Support O365 Add Another Admin, October 2019)(Citation: Microsoft O365 Admin Roles) With sufficient permissions, a compromised account can gain almost unlimited access to data and settings (including the ability to reset the passwords of other admins).(Citation: Expel AWS Attacker)
(Citation: Microsoft O365 Admin Roles) 

This account modification may immediately follow [Create Account](https://attack.mitre.org/techniques/T1136) or other malicious account activity. Adversaries may also modify existing [Valid Accounts](https://attack.mitre.org/techniques/T1078) that they have compromised. This could lead to privilege escalation, particularly if the roles added allow for lateral movement to additional accounts.

For example, in Azure AD environments, an adversary with the Application Administrator role can add [Additional Cloud Credentials](https://attack.mitre.org/techniques/T1098/001) to their application's service principal. In doing so the adversary would be able to gain the service principal’s roles and permissions, which may be different from those of the Application Administrator.(Citation: SpecterOps Azure Privilege Escalation) Similarly, in AWS environments, an adversary with appropriate permissions may be able to use the <code>CreatePolicyVersion</code> API to define a new version of an IAM policy or the <code>AttachUserPolicy</code> API to attach an IAM policy with additional or distinct permissions to a compromised user account.(Citation: Rhino Security Labs AWS Privilege Escalation)

Similarly, an adversary with the Azure AD Global Administrator role can toggle the “Access management for Azure resources” option to gain the ability to assign privileged access to Azure subscriptions and virtual machines to Azure AD users, including themselves.(Citation: Azure AD to AD) ",https://attack.mitre.org/techniques/T1098/003,19 January 2020,14 April 2023,2.2,['Persistence'],Collect activity logs from IAM services and cloud administrator accounts to identify unusual activity in the assignment of roles to those accounts. Monitor for accounts assigned to admin roles that go over a certain threshold of known admins. ,"['Azure AD', 'Google Workspace', 'IaaS', 'Office 365', 'SaaS']",User Account: User Account Modification,True,T1098,,"Alex Parsons, Crowdstrike; Alex Soler, AttackIQ; Chris Romano, Crowdstrike; Clément Notin, Tenable; Microsoft Threat Intelligence Center (MSTIC); Pià Consigny, Tenable; Praetorian; Wojciech Lesicki",,,,,,"(Citation: CrowdStrike StellarParticle January 2022),(Citation: MSTIC DEV-0537 Mar 2022),(Citation: Microsoft Requests for Azure AD Roles in Privileged Identity Management)","['actor', 'process']","[{'mitigation id': 'M1018', 'mitigation name': 'User Account Management', 'mitigation description': 'Manage the creation, modification, use, and permissions associated to user accounts.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1018'}, {'mitigation id': 'M1026', 'mitigation name': 'Privileged Account Management', 'mitigation description': 'Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1026'}, {'mitigation id': 'M1032', 'mitigation name': 'Multi-factor Authentication', 'mitigation description': 'Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1032'}]"
T1098.005,Account Manipulation: Device Registration,"Adversaries may register a device to an adversary-controlled account. Devices may be registered in a multifactor authentication (MFA) system, which handles authentication to the network, or in a device management system, which handles device access and compliance.

MFA systems, such as Duo or Okta, allow users to associate devices with their accounts in order to complete MFA requirements. An adversary that compromises a user’s credentials may enroll a new device in order to bypass initial MFA requirements and gain persistent access to a network.(Citation: CISA MFA PrintNightmare)(Citation: DarkReading FireEye SolarWinds) In some cases, the MFA self-enrollment process may require only a username and password to enroll the account's first device or to enroll a device to an inactive account. (Citation: Mandiant APT29 Microsoft 365 2022)

Similarly, an adversary with existing access to a network may register a device to Azure AD and/or its device management system, Microsoft Intune, in order to access sensitive data or resources while bypassing conditional access policies.(Citation: AADInternals - Device Registration)(Citation: AADInternals - Conditional Access Bypass)(Citation: Microsoft DEV-0537) 

Devices registered in Azure AD may be able to conduct [Internal Spearphishing](https://attack.mitre.org/techniques/T1534) campaigns via intra-organizational emails, which are less likely to be treated as suspicious by the email client.(Citation: Microsoft - Device Registration) Additionally, an adversary may be able to perform a [Service Exhaustion Flood](https://attack.mitre.org/techniques/T1499/002) on an Azure AD tenullt by registering a large number of devices.(Citation: AADInternals - BPRT)",https://attack.mitre.org/techniques/T1098/005,04 March 2022,20 April 2023,1.1,['Persistence'],,"['Azure AD', 'SaaS', 'Windows']","Active Directory: Active Directory Object Creation, Application Log: Application Log Content, User Account: User Account Modification",True,T1098,,"Joe Gumke, U.S. Bank; Mike Moran; Pawel Partyka, Microsoft 365 Defender",,,,,,"(Citation: Mandiant APT29 Microsoft 365 2022),(Citation: Volexity SolarWinds),(Citation: AADInternals Documentation),(Citation: CISA MFA PrintNightmare),(Citation: Mandiant APT29 Microsoft 365 2022),(Citation: Microsoft - Device Registration)","['actor', 'process']","[{'mitigation id': 'M1032', 'mitigation name': 'Multi-factor Authentication', 'mitigation description': 'Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1032'}]"
T1110,Brute Force,"Adversaries may use brute force techniques to gain access to accounts when passwords are unknown or when password hashes are obtained. Without knowledge of the password for an account or set of accounts, an adversary may systematically guess the password using a repetitive or iterative mechanism. Brute forcing passwords can take place via interaction with a service that will check the validity of those credentials or offline against previously acquired credential data, such as password hashes.

Brute forcing credentials may take place at various points during a breach. For example, adversaries may attempt to brute force access to [Valid Accounts](https://attack.mitre.org/techniques/T1078) within a victim environment leveraging knowledge gathered from other post-compromise behaviors such as [OS Credential Dumping](https://attack.mitre.org/techniques/T1003), [Account Discovery](https://attack.mitre.org/techniques/T1087), or [Password Policy Discovery](https://attack.mitre.org/techniques/T1201). Adversaries may also combine brute forcing activity with behaviors such as [External Remote Services](https://attack.mitre.org/techniques/T1133) as part of Initial Access.",https://attack.mitre.org/techniques/T1110,31 May 2017,14 April 2023,2.5,['Credential Access'],"Monitor authentication logs for system and application login failures of [Valid Accounts](https://attack.mitre.org/techniques/T1078). If authentication failures are high, then there may be a brute force attempt to gain access to a system using legitimate credentials. Also monitor for many failed authentication attempts across various accounts that may result from password spraying attempts. It is difficult to detect when hashes are cracked, since this is generally done outside the scope of the target network.","['Azure AD', 'Containers', 'Google Workspace', 'IaaS', 'Linux', 'Network', 'Office 365', 'SaaS', 'Windows', 'macOS']","Application Log: Application Log Content, Command: Command Execution, User Account: User Account Authentication",False,,[],"Alfredo Oliveira, Trend Micro; David Fiser, @anu4is, Trend Micro; Ed Williams, Trustwave, SpiderLabs; Magno Logan, @magnologan, Trend Micro; Mohamed Kmal; Yossi Weizman, Azure Defender Research Team",,,,,,"(Citation: ClearSky Pay2Kitten December 2020),(Citation: Kroll Qakbot June 2020),(Citation: TrendMicro Pawn Storm Dec 2020),(Citation: Chaos Stolen Backdoor),(Citation: Kaspersky Turla),(Citation: TrendMicro Pawn Storm 2019),(Citation: Microsoft Targeting Elections September 2020),(Citation: SecureWorks August 2019),(Citation: Dragos Crashoverride 2018),(Citation: Securelist DarkVishnya Dec 2018),(Citation: CISA AA20-296A Berserk Bear December 2020),(Citation: Aqua Kinsing April 2020),(Citation: CERT-FR PYSA April 2020),(Citation: Crowdstrike Qakbot October 2020),(Citation: CME Github September 2018),(Citation: ClearSky Lebanese Cedar Jan 2021),(Citation: FireEye APT34 Webinar Dec 2017),(Citation: Mandiant FIN5 GrrCON Oct 2016),(Citation: FireEye APT39 Jan 2019),(Citation: ESET Lazarus Jun 2020),(Citation: CISA AA20-239A BeagleBoyz August 2020),(Citation: GitHub PoshC2),(Citation: DarkReading FireEye FIN5 Oct 2015),(Citation: Kaspersky QakBot September 2021),(Citation: Microsoft Common Conditional Access Policies),(Citation: NIST 800-63-3)","['actor', 'process', 'data store', 'data flow']","[{'mitigation id': 'M1018', 'mitigation name': 'User Account Management', 'mitigation description': 'Manage the creation, modification, use, and permissions associated to user accounts.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1018'}, {'mitigation id': 'M1027', 'mitigation name': 'Password Policies', 'mitigation description': 'Set and enforce secure password policies for accounts.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1027'}, {'mitigation id': 'M1032', 'mitigation name': 'Multi-factor Authentication', 'mitigation description': 'Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1032'}, {'mitigation id': 'M1036', 'mitigation name': 'Account Use Policies', 'mitigation description': 'Configure features related to account use like login attempt lockouts, specific login times, etc.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1036'}]"
T1110.001,Brute Force: Password Guessing,"Adversaries with no prior knowledge of legitimate credentials within the system or environment may guess passwords to attempt access to accounts. Without knowledge of the password for an account, an adversary may opt to systematically guess the password using a repetitive or iterative mechanism. An adversary may guess login credentials without prior knowledge of system or environment passwords during an operation by using a list of common passwords. Password guessing may or may not take into account the target's policies on password complexity or use policies that may lock accounts out after a number of failed attempts.

Guessing passwords can be a risky option because it could cause numerous authentication failures and account lockouts, depending on the organization's login failure policies. (Citation: Cylance Cleaver)

Typically, management services over commonly used ports are used when guessing passwords. Commonly targeted services include the following:

* SSH (22/TCP)
* Telnet (23/TCP)
* FTP (21/TCP)
* NetBIOS / SMB / Samba (139/TCP & 445/TCP)
* LDAP (389/TCP)
* Kerberos (88/TCP)
* RDP / Terminal Services (3389/TCP)
* HTTP/HTTP Management Services (80/TCP & 443/TCP)
* MSSQL (1433/TCP)
* Oracle (1521/TCP)
* MySQL (3306/TCP)
* VNC (5900/TCP)
* SNMP (161/UDP and 162/TCP/UDP)

In addition to management services, adversaries may ""target single sign-on (SSO) and cloud-based applications utilizing federated authentication protocols,"" as well as externally facing email applications, such as Office 365.(Citation: US-CERT TA18-068A 2018). Further, adversaries may abuse network device interfaces (such as `wlanAPI`) to brute force accessible wifi-router(s) via wireless authentication protocols.(Citation: Trend Micro Emotet 2020)

In default environments, LDAP and Kerberos connection attempts are less likely to trigger events over SMB, which creates Windows ""logon failure"" event ID 4625.",https://attack.mitre.org/techniques/T1110/001,11 February 2020,14 April 2023,1.4,['Credential Access'],"Monitor authentication logs for system and application login failures of [Valid Accounts](https://attack.mitre.org/techniques/T1078). If authentication failures are high, then there may be a brute force attempt to gain access to a system using legitimate credentials.","['Azure AD', 'Containers', 'Google Workspace', 'IaaS', 'Linux', 'Network', 'Office 365', 'SaaS', 'Windows', 'macOS']","Application Log: Application Log Content, User Account: User Account Authentication",True,T1110,,Microsoft Threat Intelligence Center (MSTIC); Mohamed Kmal,,,,,,"(Citation: Trend Micro Xbash Sept 2018),(Citation: Malwarebytes Emotet Dec 2017),(Citation: ANSSI Sandworm January 2021),(Citation: Unit 42 Lucifer June 2020),(Citation: CIS Emotet Dec 2018),(Citation: Cybersecurity Advisory GRU Brute Force Campaign July 2021),(Citation: FireEye Periscope March 2018),(Citation: ESET Hermetic Wizard March 2022),(Citation: Malwarebytes Pony April 2016),(Citation: Unit42 Xbash Sept 2018),(Citation: Symantec Emotet Jul 2018),(Citation: Secureworks Emotet Nov 2018),(Citation: US-CERT Emotet Jul 2018),(Citation: CheckPoint SpeakUp Feb 2019),(Citation: Mandiant APT29 Microsoft 365 2022),(Citation: Microsoft STRONTIUM New Patterns Cred Harvesting Sept 2020),(Citation: CME Github September 2018),(Citation: Microsoft Common Conditional Access Policies),(Citation: NIST 800-63-3)","['actor', 'process', 'data store', 'data flow']","[{'mitigation id': 'M1027', 'mitigation name': 'Password Policies', 'mitigation description': 'Set and enforce secure password policies for accounts.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1027'}, {'mitigation id': 'M1032', 'mitigation name': 'Multi-factor Authentication', 'mitigation description': 'Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1032'}, {'mitigation id': 'M1036', 'mitigation name': 'Account Use Policies', 'mitigation description': 'Configure features related to account use like login attempt lockouts, specific login times, etc.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1036'}, {'mitigation id': 'M1051', 'mitigation name': 'Update Software', 'mitigation description': 'Perform regular software updates to mitigate exploitation risk.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1051'}]"
T1110.002,Brute Force: Password Cracking,"Adversaries may use password cracking to attempt to recover usable credentials, such as plaintext passwords, when credential material such as password hashes are obtained. [OS Credential Dumping](https://attack.mitre.org/techniques/T1003) can be used to obtain password hashes, this may only get an adversary so far when [Pass the Hash](https://attack.mitre.org/techniques/T1550/002) is not an option. Further,  adversaries may leverage [Data from Configuration Repository](https://attack.mitre.org/techniques/T1602) in order to obtain hashed credentials for network devices.(Citation: US-CERT-TA18-106A) 

Techniques to systematically guess the passwords used to compute hashes are available, or the adversary may use a pre-computed rainbow table to crack hashes. Cracking hashes is usually done on adversary-controlled systems outside of the target network.(Citation: Wikipedia Password cracking) The resulting plaintext password resulting from a successfully cracked hash may be used to log into systems, resources, and services in which the account has access.",https://attack.mitre.org/techniques/T1110/002,11 February 2020,30 March 2023,1.2,['Credential Access'],"It is difficult to detect when hashes are cracked, since this is generally done outside the scope of the target network. Consider focusing efforts on detecting other adversary behavior used to acquire credential materials, such as [OS Credential Dumping](https://attack.mitre.org/techniques/T1003) or [Kerberoasting](https://attack.mitre.org/techniques/T1558/003).","['Azure AD', 'Linux', 'Network', 'Office 365', 'Windows', 'macOS']","Application Log: Application Log Content, User Account: User Account Authentication",True,T1110,,Mohamed Kmal,,,,,,"(Citation: US-CERT TA18-074A),(Citation: Cylance Cleaver),(Citation: APT3 Adversary Emulation Plan),(Citation: Kali Hydra),(Citation: McAfee Night Dragon),(Citation: FireEye APT41 Aug 2019),(Citation: FireEye FIN6 April 2016),(Citation: NIST 800-63-3)","['actor', 'process', 'data store', 'data flow']","[{'mitigation id': 'M1027', 'mitigation name': 'Password Policies', 'mitigation description': 'Set and enforce secure password policies for accounts.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1027'}, {'mitigation id': 'M1032', 'mitigation name': 'Multi-factor Authentication', 'mitigation description': 'Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1032'}]"
T1110.003,Brute Force: Password Spraying,"Adversaries may use a single or small list of commonly used passwords against many different accounts to attempt to acquire valid account credentials. Password spraying uses one password (e.g. 'Password01'), or a small list of commonly used passwords, that may match the complexity policy of the domain. Logins are attempted with that password against many different accounts on a network to avoid account lockouts that would normally occur when brute forcing a single account with many passwords. (Citation: BlackHillsInfosec Password Spraying)

Typically, management services over commonly used ports are used when password spraying. Commonly targeted services include the following:

* SSH (22/TCP)
* Telnet (23/TCP)
* FTP (21/TCP)
* NetBIOS / SMB / Samba (139/TCP & 445/TCP)
* LDAP (389/TCP)
* Kerberos (88/TCP)
* RDP / Terminal Services (3389/TCP)
* HTTP/HTTP Management Services (80/TCP & 443/TCP)
* MSSQL (1433/TCP)
* Oracle (1521/TCP)
* MySQL (3306/TCP)
* VNC (5900/TCP)

In addition to management services, adversaries may ""target single sign-on (SSO) and cloud-based applications utilizing federated authentication protocols,"" as well as externally facing email applications, such as Office 365.(Citation: US-CERT TA18-068A 2018)

In default environments, LDAP and Kerberos connection attempts are less likely to trigger events over SMB, which creates Windows ""logon failure"" event ID 4625.",https://attack.mitre.org/techniques/T1110/003,11 February 2020,14 April 2023,1.3,['Credential Access'],"Monitor authentication logs for system and application login failures of [Valid Accounts](https://attack.mitre.org/techniques/T1078). Specifically, monitor for many failed authentication attempts across various accounts that may result from password spraying attempts.

Consider the following event IDs:(Citation: Trimarc Detecting Password Spraying)

* Domain Controllers: ""Audit Logon"" (Success & Failure) for event ID 4625.
* Domain Controllers: ""Audit Kerberos Authentication Service"" (Success & Failure) for event ID 4771.
* All systems: ""Audit Logon"" (Success & Failure) for event ID 4648.","['Azure AD', 'Containers', 'Google Workspace', 'IaaS', 'Linux', 'Office 365', 'SaaS', 'Windows', 'macOS']","Application Log: Application Log Content, User Account: User Account Authentication",True,T1110,,John Strand; Microsoft Threat Intelligence Center (MSTIC),,,,,,"(Citation: Microsoft Targeting Elections September 2020),(Citation: MSTIC Nobelium Oct 2021),(Citation: SecureWorks August 2019),(Citation: Novetta Blockbuster RATs),(Citation: Cybersecurity Advisory GRU Brute Force Campaign July 2021),(Citation: MSRC Nobelium June 2021),(Citation: Secure List Bad Rabbit),(Citation: Anomali Linux Rabbit 2018),(Citation: Symantec Leafminer July 2018),(Citation: FireEye APT33 Guardrail),(Citation: GitHub MailSniper),(Citation: NCC Group Chimera January 2021),(Citation: Microsoft STRONTIUM New Patterns Cred Harvesting Sept 2020),(Citation: Novetta Blockbuster),(Citation: Microsoft Holmium June 2020),(Citation: CME Github September 2018),(Citation: DOJ Iran Indictments March 2018),(Citation: Microsoft Common Conditional Access Policies),(Citation: NIST 800-63-3)","['actor', 'process', 'data store', 'data flow']","[{'mitigation id': 'M1027', 'mitigation name': 'Password Policies', 'mitigation description': 'Set and enforce secure password policies for accounts.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1027'}, {'mitigation id': 'M1032', 'mitigation name': 'Multi-factor Authentication', 'mitigation description': 'Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1032'}, {'mitigation id': 'M1036', 'mitigation name': 'Account Use Policies', 'mitigation description': 'Configure features related to account use like login attempt lockouts, specific login times, etc.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1036'}]"
T1110.004,Brute Force: Credential Stuffing,"Adversaries may use credentials obtained from breach dumps of unrelated accounts to gain access to target accounts through credential overlap. Occasionally, large numbers of username and password pairs are dumped online when a website or service is compromised and the user account credentials accessed. The information may be useful to an adversary attempting to compromise accounts by taking advantage of the tendency for users to use the same passwords across personal and business accounts.

Credential stuffing is a risky option because it could cause numerous authentication failures and account lockouts, depending on the organization's login failure policies.

Typically, management services over commonly used ports are used when stuffing credentials. Commonly targeted services include the following:

* SSH (22/TCP)
* Telnet (23/TCP)
* FTP (21/TCP)
* NetBIOS / SMB / Samba (139/TCP & 445/TCP)
* LDAP (389/TCP)
* Kerberos (88/TCP)
* RDP / Terminal Services (3389/TCP)
* HTTP/HTTP Management Services (80/TCP & 443/TCP)
* MSSQL (1433/TCP)
* Oracle (1521/TCP)
* MySQL (3306/TCP)
* VNC (5900/TCP)

In addition to management services, adversaries may ""target single sign-on (SSO) and cloud-based applications utilizing federated authentication protocols,"" as well as externally facing email applications, such as Office 365.(Citation: US-CERT TA18-068A 2018)",https://attack.mitre.org/techniques/T1110/004,11 February 2020,14 April 2023,1.3,['Credential Access'],"Monitor authentication logs for system and application login failures of [Valid Accounts](https://attack.mitre.org/techniques/T1078). If authentication failures are high, then there may be a brute force attempt to gain access to a system using legitimate credentials.","['Azure AD', 'Containers', 'Google Workspace', 'IaaS', 'Linux', 'Office 365', 'SaaS', 'Windows', 'macOS']","Application Log: Application Log Content, User Account: User Account Authentication",True,T1110,,Anastasios Pingios; Diogo Fernulldes,,,,,,"(Citation: ESET Trickbot Oct 2020),(Citation: NCC Group Chimera January 2021),(Citation: Bitdefender Trickbot March 2020),(Citation: Microsoft Common Conditional Access Policies),(Citation: NIST 800-63-3)","['actor', 'process', 'data store', 'data flow']","[{'mitigation id': 'M1018', 'mitigation name': 'User Account Management', 'mitigation description': 'Manage the creation, modification, use, and permissions associated to user accounts.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1018'}, {'mitigation id': 'M1027', 'mitigation name': 'Password Policies', 'mitigation description': 'Set and enforce secure password policies for accounts.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1027'}, {'mitigation id': 'M1032', 'mitigation name': 'Multi-factor Authentication', 'mitigation description': 'Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1032'}, {'mitigation id': 'M1036', 'mitigation name': 'Account Use Policies', 'mitigation description': 'Configure features related to account use like login attempt lockouts, specific login times, etc.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1036'}]"
T1136,Create Account,"Adversaries may create an account to maintain access to victim systems. With a sufficient level of access, creating such accounts may be used to establish secondary credentialed access that do not require persistent remote access tools to be deployed on the system.

Accounts may be created on the local system or within a domain or cloud tenullt. In cloud environments, adversaries may create accounts that only have access to specific services, which can reduce the chance of detection.",https://attack.mitre.org/techniques/T1136,14 December 2017,12 April 2023,2.3,['Persistence'],"Monitor for processes and command-line parameters associated with account creation, such as <code>net user</code> or <code>useradd</code>. Collect data on account creation within a network. Event ID 4720 is generated when a user account is created on a Windows system and domain controller. (Citation: Microsoft User Creation Event) Perform regular audits of domain and local system accounts to detect suspicious accounts that may have been created by an adversary.

Collect usage logs from cloud administrator accounts to identify unusual activity in the creation of new accounts and assignment of roles to those accounts. Monitor for accounts assigned to admin roles that go over a certain threshold of known admins.","['Azure AD', 'Google Workspace', 'IaaS', 'Linux', 'Network', 'Office 365', 'Windows', 'macOS']","Command: Command Execution, Process: Process Creation, User Account: User Account Creation",False,,[],"Austin Clark, @c2defense; Microsoft Threat Intelligence Center (MSTIC); Praetorian",,,,,,"(Citation: Dragos Crashoverride 2018),(Citation: Symantec WastedLocker June 2020),","['actor', 'process']","[{'mitigation id': 'M1026', 'mitigation name': 'Privileged Account Management', 'mitigation description': 'Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1026'}, {'mitigation id': 'M1028', 'mitigation name': 'Operating System Configuration', 'mitigation description': 'Make configuration changes related to the operating system or a common feature of the operating system that result in system hardening against techniques.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1028'}, {'mitigation id': 'M1030', 'mitigation name': 'Network Segmentation', 'mitigation description': 'Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network. Configure separate virtual private cloud (VPC) instances to isolate critical cloud systems.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1030'}, {'mitigation id': 'M1032', 'mitigation name': 'Multi-factor Authentication', 'mitigation description': 'Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1032'}]"
T1136.003,Create Account: Cloud Account,"Adversaries may create a cloud account to maintain access to victim systems. With a sufficient level of access, such accounts may be used to establish secondary credentialed access that does not require persistent remote access tools to be deployed on the system.(Citation: Microsoft O365 Admin Roles)(Citation: Microsoft Support O365 Add Another Admin, October 2019)(Citation: AWS Create IAM User)(Citation: GCP Create Cloud Identity Users)(Citation: Microsoft Azure AD Users)

Adversaries may create accounts that only have access to specific cloud services, which can reduce the chance of detection.

Once an adversary has created a cloud account, they can then manipulate that account to ensure persistence and allow access to additional resources - for example, by adding [Additional Cloud Credentials](https://attack.mitre.org/techniques/T1098/001) or assigning [Additional Cloud Roles](https://attack.mitre.org/techniques/T1098/003).",https://attack.mitre.org/techniques/T1136/003,29 January 2020,06 March 2023,1.3,['Persistence'],Collect usage logs from cloud user and administrator accounts to identify unusual activity in the creation of new accounts and assignment of roles to those accounts. Monitor for accounts assigned to admin roles that go over a certain threshold of known admins.,"['Azure AD', 'Google Workspace', 'IaaS', 'Office 365', 'SaaS']",User Account: User Account Creation,True,T1136,,Microsoft Threat Intelligence Center (MSTIC); Praetorian,,,,,,"(Citation: MSTIC DEV-0537 Mar 2022),(Citation: MSTIC Nobelium Oct 2021),(Citation: AADInternals Documentation),","['actor', 'process']","[{'mitigation id': 'M1026', 'mitigation name': 'Privileged Account Management', 'mitigation description': 'Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1026'}, {'mitigation id': 'M1030', 'mitigation name': 'Network Segmentation', 'mitigation description': 'Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network. Configure separate virtual private cloud (VPC) instances to isolate critical cloud systems.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1030'}, {'mitigation id': 'M1032', 'mitigation name': 'Multi-factor Authentication', 'mitigation description': 'Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1032'}]"
T1484,Domain Policy Modification,"Adversaries may modify the configuration settings of a domain to evade defenses and/or escalate privileges in domain environments. Domains provide a centralized means of managing how computer resources (ex: computers, user accounts) can act, and interact with each other, on a network. The policy of the domain also includes configuration settings that may apply between domains in a multi-domain/forest environment. Modifications to domain settings may include altering domain Group Policy Objects (GPOs) or changing trust settings for domains, including federation trusts.

With sufficient permissions, adversaries can modify domain policy settings. Since domain configuration settings control many of the interactions within the Active Directory (AD) environment, there are a great number of potential attacks that can stem from this abuse. Examples of such abuse include modifying GPOs to push a malicious [Scheduled Task](https://attack.mitre.org/techniques/T1053/005) to computers throughout the domain environment(Citation: ADSecurity GPO Persistence 2016)(Citation: Wald0 Guide to GPOs)(Citation: Harmj0y Abusing GPO Permissions) or modifying domain trusts to include an adversary controlled domain where they can control access tokens that will subsequently be accepted by victim domain resources.(Citation: Microsoft - Customer Guidance on Recent Nation-State Cyber Attacks) Adversaries can also change configuration settings within the AD environment to implement a [Rogue Domain Controller](https://attack.mitre.org/techniques/T1207).

Adversaries may temporarily modify domain policy, carry out a malicious action(s), and then revert the change to remove suspicious indicators.",https://attack.mitre.org/techniques/T1484,07 March 2019,09 February 2021,2.0,"['Defense Evasion', 'Privilege Escalation']","It may be possible to detect domain policy modifications using Windows event logs. Group policy modifications, for example, may be logged under a variety of Windows event IDs for modifying, creating, undeleting, moving, and deleting directory service objects (Event ID 5136, 5137, 5138, 5139, 5141 respectively). Monitor for modifications to domain trust settings, such as when a user or application modifies the federation settings on the domain or updates domain authentication from Managed to Federated via ActionTypes <code>Set federation settings on domain</code> and <code>Set domain authentication</code>.(Citation: Microsoft - Azure Sentinel ADFSDomainTrustMods)(Citation: Microsoft 365 Defender Solorigate) This may also include monitoring for Event ID 307 which can be correlated to relevant Event ID 510 with the same Instance ID for change details.(Citation: Sygnia Golden SAML)(Citation: CISA SolarWinds Cloud Detection)

Consider monitoring for commands/cmdlets and command-line arguments that may be leveraged to modify domain policy settings.(Citation: Microsoft - Update or Repair Federated domain) Some domain policy modifications, such as changes to federation settings, are likely to be rare.(Citation: Microsoft 365 Defender Solorigate)","['Azure AD', 'Windows']","Active Directory: Active Directory Object Creation, Active Directory: Active Directory Object Deletion, Active Directory: Active Directory Object Modification, Command: Command Execution",False,,[],,"['Administrator', 'User']",,,,,",(Citation: Microsoft GPO Security Filtering),(Citation: Wald0 Guide to GPOs),(Citation: Microsoft WMI Filters),(Citation: GitHub Bloodhound)","['actor', 'process', 'data store']","[{'mitigation id': 'M1018', 'mitigation name': 'User Account Management', 'mitigation description': 'Manage the creation, modification, use, and permissions associated to user accounts.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1018'}, {'mitigation id': 'M1026', 'mitigation name': 'Privileged Account Management', 'mitigation description': 'Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1026'}, {'mitigation id': 'M1047', 'mitigation name': 'Audit', 'mitigation description': 'Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1047'}]"
T1484.002,Domain Policy Modification: Domain Trust Modification,"Adversaries may add new domain trusts or modify the properties of existing domain trusts to evade defenses and/or elevate privileges. Domain trust details, such as whether or not a domain is federated, allow authentication and authorization properties to apply between domains for the purpose of accessing shared resources.(Citation: Microsoft - Azure AD Federation) These trust objects may include accounts, credentials, and other authentication material applied to servers, tokens, and domains.

Manipulating the domain trusts may allow an adversary to escalate privileges and/or evade defenses by modifying settings to add objects which they control. For example, this may be used to forge [SAML Tokens](https://attack.mitre.org/techniques/T1606/002), without the need to compromise the signing certificate to forge new credentials. Instead, an adversary can manipulate domain trusts to add their own signing certificate. An adversary may also convert a domain to a federated domain, which may enable malicious trust modifications such as altering the claim issuance rules to log in any valid set of credentials as a specified user.(Citation: AADInternals zure AD Federated Domain) ",https://attack.mitre.org/techniques/T1484/002,28 December 2020,21 October 2022,1.1,"['Defense Evasion', 'Privilege Escalation']","Monitor for modifications to domain trust settings, such as when a user or application modifies the federation settings on the domain or updates domain authentication from Managed to Federated via ActionTypes <code>Set federation settings on domain</code> and <code>Set domain authentication</code>.(Citation: Microsoft - Azure Sentinel ADFSDomainTrustMods) This may also include monitoring for Event ID 307 which can be correlated to relevant Event ID 510 with the same Instance ID for change details.(Citation: Sygnia Golden SAML)(Citation: CISA SolarWinds Cloud Detection)

Monitor for PowerShell commands such as: <code>Update-MSOLFederatedDomain –DomainName: ""Federated Domain Name""</code>, or <code>Update-MSOLFederatedDomain –DomainName: ""Federated Domain Name"" –supportmultipledomain</code>.(Citation: Microsoft - Update or Repair Federated domain)","['Azure AD', 'Windows']","Active Directory: Active Directory Object Creation, Active Directory: Active Directory Object Modification, Command: Command Execution",True,T1484,,"Blake Strom, Microsoft 365 Defender; Praetorian",['Administrator'],,,,,"(Citation: Microsoft 365 Defender Solorigate),(Citation: Secureworks IRON RITUAL Profile),(Citation: Azure AD Federation Vulnerability),(Citation: AADInternals Documentation),","['actor', 'process', 'data store']","[{'mitigation id': 'M1026', 'mitigation name': 'Privileged Account Management', 'mitigation description': 'Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1026'}]"
T1498,Network Denial of Service,"Adversaries may perform Network Denial of Service (DoS) attacks to degrade or block the availability of targeted resources to users. Network DoS can be performed by exhausting the network bandwidth services rely on. Example resources include specific websites, email services, DNS, and web-based applications. Adversaries have been observed conducting network DoS attacks for political purposes(Citation: FireEye OpPoisonedHandover February 2016) and to support other malicious activities, including distraction(Citation: FSISAC FraudNetDoS September 2012), hacktivism, and extortion.(Citation: Symantec DDoS October 2014)

A Network DoS will occur when the bandwidth capacity of the network connection to a system is exhausted due to the volume of malicious traffic directed at the resource or the network connections and network devices the resource relies on. For example, an adversary may send 10Gbps of traffic to a server that is hosted by a network with a 1Gbps connection to the internet. This traffic can be generated by a single system or multiple systems spread across the internet, which is commonly referred to as a distributed DoS (DDoS).

To perform Network DoS attacks several aspects apply to multiple methods, including IP address spoofing, and botnets.

Adversaries may use the original IP address of an attacking system, or spoof the source IP address to make the attack traffic more difficult to trace back to the attacking system or to enable reflection. This can increase the difficulty defenders have in defending against the attack by reducing or eliminating the effectiveness of filtering by the source address on network defense devices.

For DoS attacks targeting the hosting system directly, see [Endpoint Denial of Service](https://attack.mitre.org/techniques/T1499).",https://attack.mitre.org/techniques/T1498,17 April 2019,25 March 2022,1.1,['Impact'],"Detection of Network DoS can sometimes be achieved before the traffic volume is sufficient to cause impact to the availability of the service, but such response time typically requires very aggressive monitoring and responsiveness or services provided by an upstream network service provider. Typical network throughput monitoring tools such as netflow(Citation: Cisco DoSdetectNetflow), SNMP, and custom scripts can be used to detect sudden increases in network or service utilization. Real-time, automated, and qualitative study of the network traffic can identify a sudden surge in one type of protocol can be used to detect an Network DoS event as it starts. Often, the lead time may be small and the indicator of an event availability of the network or service drops. The analysis tools mentioned can then be used to determine the type of DoS causing the outage and help with remediation.","['Azure AD', 'Containers', 'Google Workspace', 'IaaS', 'Linux', 'Office 365', 'SaaS', 'Windows', 'macOS']","Network Traffic: Network Traffic Flow, Sensor Health: Host Status",False,,[],"Vishwas Manral, McAfee; Yossi Weizman, Azure Defender Research Team",,,,Availability,,"(Citation: Unit 42 Lucifer June 2020),(Citation: US District Court Indictment GRU Oct 2018),(Citation: CERT-EU DDoS March 2017)","['actor', 'process', 'data store']","[{'mitigation id': 'M1037', 'mitigation name': 'Filter Network Traffic', 'mitigation description': 'Use network appliances to filter ingress or egress traffic and perform protocol-based filtering. Configure software on endpoints to filter network traffic.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1037'}]"
T1498.001,Network Denial of Service: Direct Network Flood,"Adversaries may attempt to cause a denial of service (DoS) by directly sending a high-volume of network traffic to a target. This DoS attack may also reduce the availability and functionality of the targeted system(s) and network. [Direct Network Flood](https://attack.mitre.org/techniques/T1498/001)s are when one or more systems are used to send a high-volume of network packets towards the targeted service's network. Almost any network protocol may be used for flooding. Stateless protocols such as UDP or ICMP are commonly used but stateful protocols such as TCP can be used as well.

Botnets are commonly used to conduct network flooding attacks against networks and services. Large botnets can generate a significant amount of traffic from systems spread across the global Internet. Adversaries may have the resources to build out and control their own botnet infrastructure or may rent time on an existing botnet to conduct an attack. In some of the worst cases for distributed DoS (DDoS), so many systems are used to generate the flood that each one only needs to send out a small amount of traffic to produce enough volume to saturate the target network. In such circumstances, distinguishing DDoS traffic from legitimate clients becomes exceedingly difficult. Botnets have been used in some of the most high-profile DDoS flooding attacks, such as the 2012 series of incidents that targeted major US banks.(Citation: USNYAG IranianBotnet March 2016)",https://attack.mitre.org/techniques/T1498/001,02 March 2020,30 March 2023,1.3,['Impact'],"Detection of a network flood can sometimes be achieved before the traffic volume is sufficient to cause impact to the availability of the service, but such response time typically requires very aggressive monitoring and responsiveness or services provided by an upstream network service provider. Typical network throughput monitoring tools such as netflow(Citation: Cisco DoSdetectNetflow), SNMP, and custom scripts can be used to detect sudden increases in network or service utilization. Real-time, automated, and qualitative study of the network traffic can identify a sudden surge in one type of protocol can be used to detect a network flood event as it starts. Often, the lead time may be small and the indicator of an event availability of the network or service drops. The analysis tools mentioned can then be used to determine the type of DoS causing the outage and help with remediation.","['Azure AD', 'Google Workspace', 'IaaS', 'Linux', 'Office 365', 'SaaS', 'Windows', 'macOS']","Network Traffic: Network Traffic Flow, Sensor Health: Host Status",True,T1498,,,,,,Availability,,",(Citation: CERT-EU DDoS March 2017)","['actor', 'process', 'data store']","[{'mitigation id': 'M1037', 'mitigation name': 'Filter Network Traffic', 'mitigation description': 'Use network appliances to filter ingress or egress traffic and perform protocol-based filtering. Configure software on endpoints to filter network traffic.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1037'}]"
T1498.002,Network Denial of Service: Reflection Amplification,"Adversaries may attempt to cause a denial of service (DoS) by reflecting a high-volume of network traffic to a target. This type of Network DoS takes advantage of a third-party server intermediary that hosts and will respond to a given spoofed source IP address. This third-party server is commonly termed a reflector. An adversary accomplishes a reflection attack by sending packets to reflectors with the spoofed address of the victim. Similar to Direct Network Floods, more than one system may be used to conduct the attack, or a botnet may be used. Likewise, one or more reflectors may be used to focus traffic on the target.(Citation: Cloudflare ReflectionDoS May 2017) This Network DoS attack may also reduce the availability and functionality of the targeted system(s) and network.

Reflection attacks often take advantage of protocols with larger responses than requests in order to amplify their traffic, commonly known as a Reflection Amplification attack. Adversaries may be able to generate an increase in volume of attack traffic that is several orders of magnitude greater than the requests sent to the amplifiers. The extent of this increase will depending upon many variables, such as the protocol in question, the technique used, and the amplifying servers that actually produce the amplification in attack volume. Two prominent protocols that have enabled Reflection Amplification Floods are DNS(Citation: Cloudflare DNSamplficationDoS) and NTP(Citation: Cloudflare NTPamplifciationDoS), though the use of several others in the wild have been documented.(Citation: Arbor AnnualDoSreport Jan 2018)  In particular, the memcache protocol showed itself to be a powerful protocol, with amplification sizes up to 51,200 times the requesting packet.(Citation: Cloudflare Memcrashed Feb 2018)",https://attack.mitre.org/techniques/T1498/002,02 March 2020,30 March 2023,1.3,['Impact'],"Detection of reflection amplification can sometimes be achieved before the traffic volume is sufficient to cause impact to the availability of the service, but such response time typically requires very aggressive monitoring and responsiveness or services provided by an upstream network service provider. Typical network throughput monitoring tools such as netflow(Citation: Cisco DoSdetectNetflow), SNMP, and custom scripts can be used to detect sudden increases in network or service utilization. Real-time, automated, and qualitative study of the network traffic can identify a sudden surge in one type of protocol can be used to detect a reflection amplification DoS event as it starts. Often, the lead time may be small and the indicator of an event availability of the network or service drops. The analysis tools mentioned can then be used to determine the type of DoS causing the outage and help with remediation.","['Azure AD', 'Google Workspace', 'IaaS', 'Linux', 'Office 365', 'SaaS', 'Windows', 'macOS']","Network Traffic: Network Traffic Flow, Sensor Health: Host Status",True,T1498,,,,,,Availability,,",(Citation: CERT-EU DDoS March 2017)","['actor', 'process', 'data store']","[{'mitigation id': 'M1037', 'mitigation name': 'Filter Network Traffic', 'mitigation description': 'Use network appliances to filter ingress or egress traffic and perform protocol-based filtering. Configure software on endpoints to filter network traffic.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1037'}]"
T1499,Endpoint Denial of Service,"Adversaries may perform Endpoint Denial of Service (DoS) attacks to degrade or block the availability of services to users. Endpoint DoS can be performed by exhausting the system resources those services are hosted on or exploiting the system to cause a persistent crash condition. Example services include websites, email services, DNS, and web-based applications. Adversaries have been observed conducting DoS attacks for political purposes(Citation: FireEye OpPoisonedHandover February 2016) and to support other malicious activities, including distraction(Citation: FSISAC FraudNetDoS September 2012), hacktivism, and extortion.(Citation: Symantec DDoS October 2014)

ull Endpoint DoS denies the availability of a service without saturating the network used to provide access to the service. Adversaries can target various layers of the application stack that is hosted on the system used to provide the service. These layers include the Operating Systems (OS), server applications such as web servers, DNS servers, databases, and the (typically web-based) applications that sit on top of them. Attacking each layer requires different techniques that take advantage of bottlenecks that are unique to the respective components. A DoS attack may be generated by a single system or multiple systems spread across the internet, which is commonly referred to as a distributed DoS (DDoS).

To perform DoS attacks against endpoint resources, several aspects apply to multiple methods, including IP address spoofing and botnets.

Adversaries may use the original IP address of an attacking system, or spoof the source IP address to make the attack traffic more difficult to trace back to the attacking system or to enable reflection. This can increase the difficulty defenders have in defending against the attack by reducing or eliminating the effectiveness of filtering by the source address on network defense devices.

Botnets are commonly used to conduct DDoS attacks against networks and services. Large botnets can generate a significant amount of traffic from systems spread across the global internet. Adversaries may have the resources to build out and control their own botnet infrastructure or may rent time on an existing botnet to conduct an attack. In some of the worst cases for DDoS, so many systems are used to generate requests that each one only needs to send out a small amount of traffic to produce enough volume to exhaust the target's resources. In such circumstances, distinguishing DDoS traffic from legitimate clients becomes exceedingly difficult. Botnets have been used in some of the most high-profile DDoS attacks, such as the 2012 series of incidents that targeted major US banks.(Citation: USNYAG IranianBotnet March 2016)

In cases where traffic manipulation is used, there may be points in the global network (such as high traffic gateway routers) where packets can be altered and cause legitimate clients to execute code that directs network packets toward a target in high volume. This type of capability was previously used for the purposes of web censorship where client HTTP traffic was modified to include a reference to JavaScript that generated the DDoS code to overwhelm target web servers.(Citation: ArsTechnica Great Firewall of China)

For attacks attempting to saturate the providing network, see [Network Denial of Service](https://attack.mitre.org/techniques/T1498).
",https://attack.mitre.org/techniques/T1499,18 April 2019,30 March 2023,1.1,['Impact'],"Detection of Endpoint DoS can sometimes be achieved before the effect is sufficient to cause significant impact to the availability of the service, but such response time typically requires very aggressive monitoring and responsiveness. Typical network throughput monitoring tools such as netflow, SNMP, and custom scripts can be used to detect sudden increases in circuit utilization.(Citation: Cisco DoSdetectNetflow) Real-time, automated, and qualitative study of the network traffic can identify a sudden surge in one type of protocol can be used to detect an attack as it starts.

In addition to network level detections, endpoint logging and instrumentation can be useful for detection. Attacks targeting web applications may generate logs in the web server, application server, and/or database server that can be used to identify the type of attack, possibly before the impact is felt.

Externally monitor the availability of services that may be targeted by an Endpoint DoS.","['Azure AD', 'Containers', 'Google Workspace', 'IaaS', 'Linux', 'Office 365', 'SaaS', 'Windows', 'macOS']","Application Log: Application Log Content, Network Traffic: Network Traffic Content, Network Traffic: Network Traffic Flow, Sensor Health: Host Status",False,,[],"Alfredo Oliveira, Trend Micro; David Fiser, @anu4is, Trend Micro; Magno Logan, @magnologan, Trend Micro; Vishwas Manral, McAfee; Yossi Weizman, Azure Defender Research Team",,,,Availability,,"(Citation: US District Court Indictment GRU Unit 74455 October 2020),(Citation: ESET Dukes October 2019),(Citation: Talos ZxShell Oct 2014),(Citation: FireEye APT41 Aug 2019),(Citation: CERT-EU DDoS March 2017)","['actor', 'process', 'data store']","[{'mitigation id': 'M1037', 'mitigation name': 'Filter Network Traffic', 'mitigation description': 'Use network appliances to filter ingress or egress traffic and perform protocol-based filtering. Configure software on endpoints to filter network traffic.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1037'}]"
T1499.002,Endpoint Denial of Service: Service Exhaustion Flood,"Adversaries may target the different network services provided by systems to conduct a denial of service (DoS). Adversaries often target the availability of DNS and web services, however others have been targeted as well.(Citation: Arbor AnnualDoSreport Jan 2018) Web server software can be attacked through a variety of means, some of which apply generally while others are specific to the software being used to provide the service.

One example of this type of attack is known as a simple HTTP flood, where an adversary sends a large number of HTTP requests to a web server to overwhelm it and/or an application that runs on top of it. This flood relies on raw volume to accomplish the objective, exhausting any of the various resources required by the victim software to provide the service.(Citation: Cloudflare HTTPflood)

ullother variation, known as a SSL renegotiation attack, takes advantage of a protocol feature in SSL/TLS. The SSL/TLS protocol suite includes mechanisms for the client and server to agree on an encryption algorithm to use for subsequent secure connections. If SSL renegotiation is enabled, a request can be made for renegotiation of the crypto algorithm. In a renegotiation attack, the adversary establishes a SSL/TLS connection and then proceeds to make a series of renegotiation requests. Because the cryptographic renegotiation has a meaningful cost in computation cycles, this can cause an impact to the availability of the service when done in volume.(Citation: Arbor SSLDoS April 2012)",https://attack.mitre.org/techniques/T1499/002,20 February 2020,30 March 2023,1.3,['Impact'],"Detection of Endpoint DoS can sometimes be achieved before the effect is sufficient to cause significant impact to the availability of the service, but such response time typically requires very aggressive monitoring and responsiveness. Typical network throughput monitoring tools such as netflow, SNMP, and custom scripts can be used to detect sudden increases in circuit utilization.(Citation: Cisco DoSdetectNetflow) Real-time, automated, and qualitative study of the network traffic can identify a sudden surge in one type of protocol can be used to detect an attack as it starts.

In addition to network level detections, endpoint logging and instrumentation can be useful for detection. Attacks targeting web applications may generate logs in the web server, application server, and/or database server that can be used to identify the type of attack, possibly before the impact is felt.

Externally monitor the availability of services that may be targeted by an Endpoint DoS.","['Azure AD', 'Google Workspace', 'IaaS', 'Linux', 'Office 365', 'SaaS', 'Windows', 'macOS']","Application Log: Application Log Content, Network Traffic: Network Traffic Content, Network Traffic: Network Traffic Flow, Sensor Health: Host Status",True,T1499,,,,,,Availability,,",(Citation: CERT-EU DDoS March 2017)","['actor', 'process', 'data store']","[{'mitigation id': 'M1037', 'mitigation name': 'Filter Network Traffic', 'mitigation description': 'Use network appliances to filter ingress or egress traffic and perform protocol-based filtering. Configure software on endpoints to filter network traffic.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1037'}]"
T1499.003,Endpoint Denial of Service: Application Exhaustion Flood,"Adversaries may target resource intensive features of applications to cause a denial of service (DoS), denying availability to those applications. For example, specific features in web applications may be highly resource intensive. Repeated requests to those features may be able to exhaust system resources and deny access to the application or the server itself.(Citation: Arbor AnnualDoSreport Jan 2018)",https://attack.mitre.org/techniques/T1499/003,20 February 2020,25 March 2022,1.2,['Impact'],"Detection of Endpoint DoS can sometimes be achieved before the effect is sufficient to cause significant impact to the availability of the service, but such response time typically requires very aggressive monitoring and responsiveness. Typical network throughput monitoring tools such as netflow, SNMP, and custom scripts can be used to detect sudden increases in circuit utilization.(Citation: Cisco DoSdetectNetflow) Real-time, automated, and qualitative study of the network traffic can identify a sudden surge in one type of protocol can be used to detect an attack as it starts.

In addition to network level detections, endpoint logging and instrumentation can be useful for detection. Attacks targeting web applications may generate logs in the web server, application server, and/or database server that can be used to identify the type of attack, possibly before the impact is felt.","['Azure AD', 'Google Workspace', 'IaaS', 'Linux', 'Office 365', 'SaaS', 'Windows', 'macOS']","Application Log: Application Log Content, Network Traffic: Network Traffic Content, Network Traffic: Network Traffic Flow, Sensor Health: Host Status",True,T1499,,,,,,Availability,,",(Citation: CERT-EU DDoS March 2017)","['actor', 'process', 'data store']","[{'mitigation id': 'M1037', 'mitigation name': 'Filter Network Traffic', 'mitigation description': 'Use network appliances to filter ingress or egress traffic and perform protocol-based filtering. Configure software on endpoints to filter network traffic.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1037'}]"
T1499.004,Endpoint Denial of Service: Application or System Exploitation,"Adversaries may exploit software vulnerabilities that can cause an application or system to crash and deny availability to users. (Citation: Sucuri BIND9 August 2015) Some systems may automatically restart critical applications and services when crashes occur, but they can likely be re-exploited to cause a persistent denial of service (DoS) condition.

Adversaries may exploit known or zero-day vulnerabilities to crash applications and/or systems, which may also lead to dependent applications and/or systems to be in a DoS condition. Crashed or restarted applications or systems may also have other effects such as [Data Destruction](https://attack.mitre.org/techniques/T1485), [Firmware Corruption](https://attack.mitre.org/techniques/T1495), [Service Stop](https://attack.mitre.org/techniques/T1489) etc. which may further cause a DoS condition and deny availability to critical information, applications and/or systems. ",https://attack.mitre.org/techniques/T1499/004,20 February 2020,25 March 2022,1.2,['Impact'],"Attacks targeting web applications may generate logs in the web server, application server, and/or database server that can be used to identify the type of attack. Externally monitor the availability of services that may be targeted by an Endpoint DoS.","['Azure AD', 'Google Workspace', 'IaaS', 'Linux', 'Office 365', 'SaaS', 'Windows', 'macOS']","Application Log: Application Log Content, Network Traffic: Network Traffic Content, Network Traffic: Network Traffic Flow, Sensor Health: Host Status",True,T1499,,,,,,Availability,,"(Citation: ESET Industroyer),(Citation: CERT-EU DDoS March 2017)","['actor', 'process', 'data store']","[{'mitigation id': 'M1037', 'mitigation name': 'Filter Network Traffic', 'mitigation description': 'Use network appliances to filter ingress or egress traffic and perform protocol-based filtering. Configure software on endpoints to filter network traffic.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1037'}]"
T1518,Software Discovery,"Adversaries may attempt to get a listing of software and software versions that are installed on a system or in a cloud environment. Adversaries may use the information from [Software Discovery](https://attack.mitre.org/techniques/T1518) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.

Adversaries may attempt to enumerate software for a variety of reasons, such as figuring out what security measures are present or if the compromised system has a version of software that is vulnerable to [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068).",https://attack.mitre.org/techniques/T1518,16 September 2019,30 March 2023,1.3,['Discovery'],"System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as lateral movement, based on the information obtained.

Monitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).","['Azure AD', 'Google Workspace', 'IaaS', 'Linux', 'Office 365', 'SaaS', 'Windows', 'macOS']","Command: Command Execution, Firewall: Firewall Enumeration, Firewall: Firewall Metadata, Process: OS API Execution, Process: Process Creation",False,,[],,"['Administrator', 'User']",,,,,"(Citation: Cybereason Kimsuky November 2020),(Citation: Proofpoint Leviathan Oct 2017),(Citation: Anomali MUSTANG PANDA October 2019),(Citation: Trend Micro Tick November 2019),(Citation: Trend Micro Muddy Water March 2021),(Citation: trendmicro xcsset xcode project 2020),(Citation: Cybereason Bazar July 2020),(Citation: Symantec Inception Framework March 2018),(Citation: ESET InvisiMole June 2020),(Citation: Check Point APT35 CharmPower January 2022),(Citation: MalwareBytes WoodyRAT Aug 2022),(Citation: HP SVCReady Jun 2022),(Citation: ANSSI Sandworm January 2021),(Citation: FoxIT Wocao December 2019),(Citation: TrendMicro Tropic Trooper May 2020),(Citation: ESET ForSSHe December 2018),(Citation: MalwareBytes SideCopy Dec 2021),(Citation: Rewterz Sidewinder APT April 2020),(Citation: ESET InvisiMole June 2018),(Citation: Kaspersky Lyceum October 2021),(Citation: Group IB Ransomware September 2020),(Citation: Mandiant UNC3890 Aug 2022),(Citation: Kaspersky TajMahal April 2019),(Citation: Cylance Dust Storm),(Citation: ATT Sidewinder January 2021),(Citation: ESET Casbaneiro Oct 2019),(Citation: BlackBerry Bahamut),(Citation: Carbon Black HotCroissant April 2020),(Citation: Kaspersky MoleRATs April 2019),(Citation: Kaspersky Ferocious Kitten Jun 2021),(Citation: ESET RTM Feb 2017),(Citation: Checkpoint Dridex Jan 2021),(Citation: Secureworks GOLD KINGSWOOD September 2018),(Citation: Cobalt Strike Manual 4.3 November 2020),(Citation: FireEye Metamorfo Apr 2018),(Citation: FOX-IT May 2016 Mofang),(Citation: Unit 42 Siloscape Jun 2021),(Citation: ESET ComRAT May 2020),(Citation: Malwarebytes Dyreza November 2015),(Citation: MacKeeper Bundlore Apr 2019),","['actor', 'process', 'data store']",
T1518.001,Software Discovery: Security Software Discovery,"Adversaries may attempt to get a listing of security software, configurations, defensive tools, and sensors that are installed on a system or in a cloud environment. This may include things such as firewall rules and anti-virus. Adversaries may use the information from [Security Software Discovery](https://attack.mitre.org/techniques/T1518/001) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.

Example commands that can be used to obtain security software information are [netsh](https://attack.mitre.org/software/S0108), <code>reg query</code> with [Reg](https://attack.mitre.org/software/S0075), <code>dir</code> with [cmd](https://attack.mitre.org/software/S0106), and [Tasklist](https://attack.mitre.org/software/S0057), but other indicators of discovery behavior may be more specific to the type of software or security system the adversary is looking for. It is becoming more common to see macOS malware perform checks for LittleSnitch and KnockKnock software.

Adversaries may also utilize cloud APIs to discover the configurations of firewall rules within an environment.(Citation: Expel IO Evil in AWS) For example, the permitted IP ranges, ports or user accounts for the inbound/outbound rules of security groups, virtual firewalls established within AWS for EC2 and/or VPC instances, can be revealed by the <code>DescribeSecurityGroups</code> action with various request parameters. (Citation: DescribeSecurityGroups - Amazon Elastic Compute Cloud)",https://attack.mitre.org/techniques/T1518/001,21 February 2020,21 April 2023,1.4,['Discovery'],"System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as lateral movement, based on the information obtained.

Monitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).

In cloud environments, additionally monitor logs for the usage of APIs that may be used to gather information about security software configurations within the environment.","['Azure AD', 'Google Workspace', 'IaaS', 'Linux', 'Office 365', 'SaaS', 'Windows', 'macOS']","Command: Command Execution, Firewall: Firewall Enumeration, Firewall: Firewall Metadata, Process: OS API Execution, Process: Process Creation",True,T1518,,"Isif Ibrahima, Mandiant",,,,,,"(Citation: Kaspersky Flame Functionality),(Citation: Cylance Shaheen Nov 2018),(Citation: Kaspersky Adwind Feb 2016),(Citation: ESET Dukes October 2019),(Citation: Kaspersky WIRTE November 2021),(Citation: Zscaler Kasidet),(Citation: KISA Operation Muzabi),(Citation: Trend Micro Skidmap),(Citation: Proofpoint Bumblebee April 2022),(Citation: Microsoft DUBNIUM June 2016),(Citation: MalwareBytes SideCopy Dec 2021),(Citation: FireEye SUNBURST Additional Details Dec 2020),(Citation: Talos Cobalt Group July 2018),(Citation: Kaspersky Turla),(Citation: TrendMicro Netwalker May 2020),(Citation: Morphisec Cobalt Gang Oct 2018),(Citation: ESET Casbaneiro Oct 2019),(Citation: BlackBerry Bahamut),(Citation: BlackBerry Amadey 2020),(Citation: Cisco Talos Intelligence Group),(Citation: Baumgartner Naikon 2015),(Citation: GDATA Zeus Panda June 2017),(Citation: F-Secure CozyDuke),(Citation: Nicolas Falliere, Liam O Murchu, Eric Chien February 2011),(Citation: jRAT Symantec Aug 2018),(Citation: Radware Micropsia July 2018),(Citation: BiZone Lizar May 2021),(Citation: Cybereason Bazar July 2020),(Citation: Prevailion EvilNum May 2020),(Citation: Volexity InkySquid BLUELIGHT August 2021),(Citation: SentinelLabs Metador Technical Appendix Sept 2022),(Citation: Cybereason Molerats Dec 2020),(Citation: trendmicro xcsset xcode project 2020),(Citation: Unit 42 BadPatch Oct 2017),(Citation: Unit 42 WhisperGate January 2022),(Citation: ESET PipeMon May 2020),(Citation: MalwareBytes WoodyRAT Aug 2022),(Citation: Cofense Astaroth Sept 2018),(Citation: Proofpoint Operation Transparent Tribe March 2016),(Citation: TrendMicro TropicTrooper 2015),(Citation: Korean FSI TA505 2020),(Citation: FireEye APT28),(Citation: Prevx Carberp March 2011),(Citation: FoxIT Wocao December 2019),(Citation: ESET Gelsemium June 2021),(Citation: Medium Ali Salem Bumblebee April 2022),(Citation: Unit42 CookieMiner Jan 2019),(Citation: Fortinet Metamorfo Feb 2020),(Citation: Talos Zeus Panda Nov 2017),(Citation: Cybereason Valak May 2020),(Citation: FireEye APT34 Dec 2017),(Citation: ESET GreyEnergy Oct 2018),(Citation: ESET RTM Feb 2017),(Citation: Mcafee Clop Aug 2019),(Citation: ESET Grandoreiro April 2020),(Citation: Securelist MuddyWater Oct 2018),(Citation: Cymmetria Patchwork),(Citation: Forcepoint Felismus Mar 2017),(Citation: Cylance Shell Crew Feb 2017),(Citation: Secureworks DarkTortilla Aug 2022),(Citation: Bitdefender FunnyDream Campaign November 2020),(Citation: ATT QakBot April 2021),(Citation: ESET ComRAT May 2020),(Citation: Kaspersky QakBot September 2021),(Citation: Securelist BlackOasis Oct 2017),(Citation: Palo Alto Comnie),(Citation: FireEye Know Your Enemy FIN8 Aug 2016),(Citation: ESET InvisiMole June 2020),(Citation: Morphisec ShellTea June 2019),(Citation: Microsoft Tasklist),(Citation: Microsoft Analyzing Solorigate Dec 2020),(Citation: ESET Turla Mosquito Jan 2018),(Citation: Kaspersky Flame),(Citation: FinFisher Citation),(Citation: Prevailion DarkWatchman 2021),(Citation: ATT TeamTNT Chimaera September 2020),(Citation: TechNet Netsh),(Citation: DFIR Ryuk's Return October 2020),(Citation: CrowdStrike AQUATIC PANDA December 2021),(Citation: Security Affairs SILENTTRINITY July 2019),(Citation: Kaspersky Ferocious Kitten Jun 2021),(Citation: Unit 42 Tropic Trooper Nov 2016),(Citation: Microsoft SIR Vol 21),(Citation: Talos Frankenstein June 2019),(Citation: Kaspersky StoneDrill 2017),(Citation: Symantec Bumblebee June 2022),(Citation: Talos Rocke August 2018),(Citation: Proofpoint TA505 Mar 2018),(Citation: Cybereason Clop Dec 2020),(Citation: Cyphort EvilBunny Dec 2014),(Citation: Kaspersky ProjectSauron Technical Analysis),(Citation: Talos Promethium June 2020),(Citation: Palo Alto Brute Ratel July 2022),(Citation: Microsoft PLATINUM April 2016),(Citation: Check Point Meteor Aug 2021),(Citation: Unit42 DarkHydrus Jan 2019),(Citation: Palo Alto T9000 Feb 2016),(Citation: wardle evilquest parti),(Citation: Rewterz Sidewinder APT April 2020),(Citation: Trend Micro Waterbear December 2019),(Citation: McAfee Gold Dragon),(Citation: ESET Operation Groundbait),(Citation: Unit 42 DarkHydrus July 2018),(Citation: Kaspersky TajMahal April 2019),(Citation: Cisco Talos Bitter Bangladesh May 2022),(Citation: SentinelLabs Metador Sept 2022),(Citation: US District Court Indictment GRU Unit 74455 October 2020),(Citation: Crowdstrike Qakbot October 2020),(Citation: Checkpoint IndigoZebra July 2021),(Citation: Securelist Darkhotel Aug 2015),(Citation: Github PowerShell Empire),(Citation: CISA AA20-239A BeagleBoyz August 2020),(Citation: Unit 42 VERMIN Jan 2018),(Citation: Secureworks GOLD KINGSWOOD September 2018),(Citation: FireEye MuddyWater Mar 2018),(Citation: Unit 42 Rocke January 2019),(Citation: Kaspersky Transparent Tribe August 2020),(Citation: TechNet Netsh Firewall),(Citation: DustySky),(Citation: Talos Micropsia June 2017),(Citation: Trend Micro Tick November 2019),","['actor', 'process', 'data store']",
T1526,Cloud Service Discovery,"An adversary may attempt to enumerate the cloud services running on a system after gaining access. These methods can differ from platform-as-a-service (PaaS), to infrastructure-as-a-service (IaaS), or software-as-a-service (SaaS). Many services exist throughout the various cloud providers and can include Continuous Integration and Continuous Delivery (CI/CD), Lambda Functions, Azure AD, etc. They may also include security services, such as AWS GuardDuty and Microsoft Defender for Cloud, and logging services, such as AWS CloudTrail and Google Cloud Audit Logs.

Adversaries may attempt to discover information about the services enabled throughout the environment. Azure tools and APIs, such as the Azure AD Graph API and Azure Resource Manager API, can enumerate resources and services, including applications, management groups, resources and policy definitions, and their relationships that are accessible by an identity.(Citation: Azure - Resource Manager API)(Citation: Azure AD Graph API)

For example, Stormspotter is an open source tool for enumerating and constructing a graph for Azure resources and services, and Pacu is an open source AWS exploitation framework that supports several methods for discovering cloud services.(Citation: Azure - Stormspotter)(Citation: GitHub Pacu)

Adversaries may use the information gained to shape follow-on behaviors, such as targeting data or credentials from enumerated services or evading identified defenses through [Disable or Modify Tools](https://attack.mitre.org/techniques/T1562/001) or [Disable Cloud Logs](https://attack.mitre.org/techniques/T1562/008).",https://attack.mitre.org/techniques/T1526,30 August 2019,04 May 2023,1.3,['Discovery'],"Cloud service discovery techniques will likely occur throughout an operation where an adversary is targeting cloud-based systems and services. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities based on the information obtained.

Normal, benign system and network events that look like cloud service discovery may be uncommon, depending on the environment and how they are used. Monitor cloud service usage for anomalous behavior that may indicate adversarial presence within the environment.","['Azure AD', 'Google Workspace', 'IaaS', 'Office 365', 'SaaS']",Cloud Service: Cloud Service Enumeration,False,,[],"Praetorian; Suzy Schapperle - Microsoft Azure Red Team; Thanabodi Phrakhun, I-SECURE",,,,,,"(Citation: Roadtools),(Citation: AADInternals Documentation),","['actor', 'process', 'data store']",
T1528,Steal Application Access Token,"Adversaries can steal application access tokens as a means of acquiring credentials to access remote systems and resources.

Application access tokens are used to make authorized API requests on behalf of a user or service and are commonly used as a way to access resources in cloud and container-based applications and software-as-a-service (SaaS).(Citation: Auth0 - Why You Should Always Use Access Tokens to Secure APIs Sept 2019) OAuth is one commonly implemented framework that issues tokens to users for access to systems. Adversaries who steal account API tokens in cloud and containerized environments may be able to access data and perform actions with the permissions of these accounts, which can lead to privilege escalation and further compromise of the environment.

In Kubernetes environments, processes running inside a container communicate with the Kubernetes API server using service account tokens. If a container is compromised, an attacker may be able to steal the container’s token and thereby gain access to Kubernetes API commands.(Citation: Kubernetes Service Accounts)

Token theft can also occur through social engineering, in which case user action may be required to grant access. An application desiring access to cloud-based services or protected APIs can gain entry using OAuth 2.0 through a variety of authorization protocols. An example commonly-used sequence is Microsoft's Authorization Code Grant flow.(Citation: Microsoft Identity Platform Protocols May 2019)(Citation: Microsoft - OAuth Code Authorization flow - June 2019) An OAuth access token enables a third-party application to interact with resources containing user data in the ways requested by the application without obtaining user credentials. 
 
Adversaries can leverage OAuth authorization by constructing a malicious application designed to be granted access to resources with the target user's OAuth token.(Citation: Amnesty OAuth Phishing Attacks, August 2019)(Citation: Trend Micro Pawn Storm OAuth 2017) The adversary will need to complete registration of their application with the authorization server, for example Microsoft Identity Platform using Azure Portal, the Visual Studio IDE, the command-line interface, PowerShell, or REST API calls.(Citation: Microsoft - Azure AD App Registration - May 2019) Then, they can send a [Spearphishing Link](https://attack.mitre.org/techniques/T1566/002) to the target user to entice them to grant access to the application. Once the OAuth access token is granted, the application can gain potentially long-term access to features of the user account through [Application Access Token](https://attack.mitre.org/techniques/T1550/001).(Citation: Microsoft - Azure AD Identity Tokens - Aug 2019)

Application access tokens may function within a limited lifetime, limiting how long an adversary can utilize the stolen token. However, in some cases, adversaries can also steal application refresh tokens(Citation: Auth0 Understanding Refresh Tokens), allowing them to obtain new access tokens without prompting the user.  

",https://attack.mitre.org/techniques/T1528,04 September 2019,21 April 2022,1.2,['Credential Access'],"Administrators should set up monitoring to trigger automatic alerts when policy criteria are met. For example, using a Cloud Access Security Broker (CASB), admins can create a “High severity app permissions” policy that generates alerts if apps request high severity permissions or send permissions requests for too many users.

Security analysts can hunt for malicious apps using the tools available in their CASB, identity provider, or resource provider (depending on platform.) For example, they can filter for apps that are authorized by a small number of users, apps requesting high risk permissions, permissions incongruous with the app’s purpose, or apps with old “Last authorized” fields. A specific app can be investigated using an activity log displaying activities the app has performed, although some activities may be mis-logged as being performed by the user. App stores can be useful resources to further investigate suspicious apps.

Administrators can set up a variety of logs and leverage audit tools to monitor actions that can be conducted as a result of OAuth 2.0 access. For instance, audit reports enable admins to identify privilege escalation actions such as role creations or policy modifications, which could be actions performed after initial access.","['Azure AD', 'Containers', 'Google Workspace', 'Office 365', 'SaaS']",User Account: User Account Modification,False,,[],"Jeff Sakowicz, Microsoft Identity Developer Platform Services (IDPM Services); Jen Burns, HubSpot; Mark Wee; Ram Pliskin, Microsoft Azure Security Center; Saisha Agrawal, Microsoft Threat Intelligent Center (MSTIC); Shailesh Tiwary (Indian Army); Suzy Schapperle - Microsoft Azure Red Team",,,,,,"(Citation: Trend Micro Pawn Storm OAuth 2017),(Citation: Peirates GitHub),(Citation: AADInternals Documentation),(Citation: Kubernetes Hardening Guide)","['actor', 'process', 'data store', 'data flow']","[{'mitigation id': 'M1017', 'mitigation name': 'User Training', 'mitigation description': 'Train users to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1017'}, {'mitigation id': 'M1018', 'mitigation name': 'User Account Management', 'mitigation description': 'Manage the creation, modification, use, and permissions associated to user accounts.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1018'}, {'mitigation id': 'M1021', 'mitigation name': 'Restrict Web-Based Content', 'mitigation description': 'Restrict use of certain websites, block downloads/attachments, block Javascript, restrict browser extensions, etc.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1021'}, {'mitigation id': 'M1047', 'mitigation name': 'Audit', 'mitigation description': 'Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1047'}]"
T1538,Cloud Service Dashboard,"An adversary may use a cloud service dashboard GUI with stolen credentials to gain useful information from an operational cloud environment, such as specific services, resources, and features. For example, the GCP Command Center can be used to view all assets, findings of potential security risks, and to run additional queries, such as finding public IP addresses and open ports.(Citation: Google Command Center Dashboard)

Depending on the configuration of the environment, an adversary may be able to enumerate more information via the graphical dashboard than an API. This allows the adversary to gain information without making any API requests.",https://attack.mitre.org/techniques/T1538,30 August 2019,16 March 2021,1.1,['Discovery'],"Monitor account activity logs to see actions performed and activity associated with the cloud service management console. Some cloud providers, such as AWS, provide distinct log events for login attempts to the management console.(Citation: AWS Console Sign-in Events)","['Azure AD', 'Google Workspace', 'IaaS', 'Office 365']","Logon Session: Logon Session Creation, User Account: User Account Authentication",False,,[],Praetorian,['User'],,,,,",","['actor', 'process', 'data store']","[{'mitigation id': 'M1018', 'mitigation name': 'User Account Management', 'mitigation description': 'Manage the creation, modification, use, and permissions associated to user accounts.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1018'}]"
T1550.001,Use Alternate Authentication Material: Application Access Token,"Adversaries may use stolen application access tokens to bypass the typical authentication process and access restricted accounts, information, or services on remote systems. These tokens are typically stolen from users or services and used in lieu of login credentials.

Application access tokens are used to make authorized API requests on behalf of a user or service and are commonly used to access resources in cloud, container-based applications, and software-as-a-service (SaaS).(Citation: Auth0 - Why You Should Always Use Access Tokens to Secure APIs Sept 2019) 

OAuth is one commonly implemented framework that issues tokens to users for access to systems. These frameworks are used collaboratively to verify the user and determine what actions the user is allowed to perform. Once identity is established, the token allows actions to be authorized, without passing the actual credentials of the user. Therefore, compromise of the token can grant the adversary access to resources of other sites through a malicious application.(Citation: okta)

For example, with a cloud-based email service, once an OAuth access token is granted to a malicious application, it can potentially gain long-term access to features of the user account if a ""refresh"" token enabling background access is awarded.(Citation: Microsoft Identity Platform Access 2019) With an OAuth access token an adversary can use the user-granted REST API to perform functions such as email searching and contact enumeration.(Citation: Staaldraad Phishing with OAuth 2017)

Compromised access tokens may be used as an initial step in compromising other services. For example, if a token grants access to a victim’s primary email, the adversary may be able to extend access to all other services which the target subscribes by triggering forgotten password routines. In AWS and GCP environments, adversaries can trigger a request for a short-lived access token with the privileges of another user account.(Citation: Google Cloud Service Account Credentials)(Citation: AWS Temporary Security Credentials) The adversary can then use this token to request data or perform actions the original account could not. If permissions for this feature are misconfigured – for example, by allowing all users to request a token for a particular account - an adversary may be able to gain initial access to a Cloud Account or escalate their privileges.(Citation: Rhino Security Labs Enumerating AWS Roles)

Direct API access through a token negates the effectiveness of a second authentication factor and may be immune to intuitive countermeasures like changing passwords.  For example, in AWS environments, an adversary who compromises a user’s AWS API credentials may be able to use the `sts:GetFederationToken` API call to create a federated user session, which will have the same permissions as the original user but may persist even if the original user credentials are deactivated.(Citation: Crowdstrike AWS User Federation Persistence) Additionally, access abuse over an API channel can be difficult to detect even from the service provider end, as the access can still align well with a legitimate workflow.",https://attack.mitre.org/techniques/T1550/001,30 January 2020,04 May 2023,1.5,"['Defense Evasion', 'Lateral Movement']","Monitor access token activity for abnormal use and permissions granted to unusual or suspicious applications and APIs. Additionally, administrators should review logs for calls to the AWS Security Token Service (STS) and usage of GCP service accounts in order to identify anomalous actions.(Citation: AWS Logging IAM Calls)(Citation: GCP Monitoring Service Account Usage)","['Azure AD', 'Containers', 'Google Workspace', 'IaaS', 'Office 365', 'SaaS']",Web Credential: Web Credential Usage,True,T1550,['System Access Controls'],"Dylan Silva, AWS Security; Ian Davila, Tidal Cyber; Jeff Sakowicz, Microsoft Identity Developer Platform Services (IDPM Services); Jen Burns, HubSpot; Mark Wee; Saisha Agrawal, Microsoft Threat Intelligent Center (MSTIC); Shailesh Tiwary (Indian Army)",,,,,,"(Citation: CrowdStrike StellarParticle January 2022),(Citation: Microsoft POLONIUM June 2022),(Citation: Trend Micro Pawn Storm OAuth 2017),(Citation: Peirates GitHub),(Citation: Microsoft Azure AD Admin Consent)","['actor', 'process', 'data store']","[{'mitigation id': 'M1021', 'mitigation name': 'Restrict Web-Based Content', 'mitigation description': 'Restrict use of certain websites, block downloads/attachments, block Javascript, restrict browser extensions, etc.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1021'}, {'mitigation id': 'M1041', 'mitigation name': 'Encrypt Sensitive Information', 'mitigation description': 'Protect sensitive information with strong encryption.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1041'}, {'mitigation id': 'M1047', 'mitigation name': 'Audit', 'mitigation description': 'Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1047'}]"
T1552,Unsecured Credentials,"Adversaries may search compromised systems to find and obtain insecurely stored credentials. These credentials can be stored and/or misplaced in many locations on a system, including plaintext files (e.g. [Bash History](https://attack.mitre.org/techniques/T1552/003)), operating system or application-specific repositories (e.g. [Credentials in Registry](https://attack.mitre.org/techniques/T1552/002)), or other specialized files/artifacts (e.g. [Private Keys](https://attack.mitre.org/techniques/T1552/004)).",https://attack.mitre.org/techniques/T1552,04 February 2020,13 April 2023,1.3,['Credential Access'],"While detecting adversaries accessing credentials may be difficult without knowing they exist in the environment, it may be possible to detect adversary use of credentials they have obtained. Monitor the command-line arguments of executing processes for suspicious words or regular expressions that may indicate searching for a password (for example: password, pwd, login, secure, or credentials). See [Valid Accounts](https://attack.mitre.org/techniques/T1078) for more information.

Monitor for suspicious file access activity, specifically indications that a process is reading multiple files in a short amount of time and/or using command-line arguments  indicative of searching for credential material (ex: regex patterns). These may be indicators of automated/scripted credential access behavior.

Monitoring when the user's <code>.bash_history</code> is read can help alert to suspicious activity. While users do typically rely on their history of commands, they often access this history through other utilities like ""history"" instead of commands like <code>cat ~/.bash_history</code>.

Additionally, monitor processes for applications that can be used to query the Registry, such as [Reg](https://attack.mitre.org/software/S0075), and collect command parameters that may indicate credentials are being searched. Correlate activity with related suspicious behavior that may indicate an active intrusion to reduce false positives.","['Azure AD', 'Containers', 'Google Workspace', 'IaaS', 'Linux', 'Network', 'Office 365', 'SaaS', 'Windows', 'macOS']","Application Log: Application Log Content, Command: Command Execution, File: File Access, Process: Process Creation, User Account: User Account Authentication, Windows Registry: Windows Registry Key Access",False,,[],"Austin Clark, @c2defense",,,,,,"(Citation: Cybereason Astaroth Feb 2019),(Citation: MS14-025),(Citation: ADSecurity Finding Passwords in SYSVOL),(Citation: Microsoft MS14-025),(Citation: RedLock Instance Metadata API 2018)","['actor', 'process', 'data store', 'data flow']","[{'mitigation id': 'M1015', 'mitigation name': 'Active Directory Configuration', 'mitigation description': 'Configure Active Directory to prevent use of certain techniques; use SID Filtering, etc.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1015'}, {'mitigation id': 'M1017', 'mitigation name': 'User Training', 'mitigation description': 'Train users to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1017'}, {'mitigation id': 'M1022', 'mitigation name': 'Restrict File and Directory Permissions', 'mitigation description': 'Restrict access by setting directory and file permissions that are not specific to users or privileged accounts.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1022'}, {'mitigation id': 'M1026', 'mitigation name': 'Privileged Account Management', 'mitigation description': 'Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1026'}, {'mitigation id': 'M1027', 'mitigation name': 'Password Policies', 'mitigation description': 'Set and enforce secure password policies for accounts.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1027'}, {'mitigation id': 'M1028', 'mitigation name': 'Operating System Configuration', 'mitigation description': 'Make configuration changes related to the operating system or a common feature of the operating system that result in system hardening against techniques.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1028'}, {'mitigation id': 'M1035', 'mitigation name': 'Limit Access to Resource Over Network', 'mitigation description': 'Prevent access to file shares, remote access to systems, unnecessary services. Mechanisms to limit access may include use of network concentrators, RDP gateways, etc.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1035'}, {'mitigation id': 'M1037', 'mitigation name': 'Filter Network Traffic', 'mitigation description': 'Use network appliances to filter ingress or egress traffic and perform protocol-based filtering. Configure software on endpoints to filter network traffic.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1037'}, {'mitigation id': 'M1041', 'mitigation name': 'Encrypt Sensitive Information', 'mitigation description': 'Protect sensitive information with strong encryption.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1041'}, {'mitigation id': 'M1047', 'mitigation name': 'Audit', 'mitigation description': 'Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1047'}, {'mitigation id': 'M1051', 'mitigation name': 'Update Software', 'mitigation description': 'Perform regular software updates to mitigate exploitation risk.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1051'}]"
T1556,Modify Authentication Process,"Adversaries may modify authentication mechanisms and processes to access user credentials or enable otherwise unwarranted access to accounts. The authentication process is handled by mechanisms, such as the Local Security Authentication Server (LSASS) process and the Security Accounts Manager (SAM) on Windows, pluggable authentication modules (PAM) on Unix-based systems, and authorization plugins on MacOS systems, responsible for gathering, storing, and validating credentials. By modifying an authentication process, an adversary may be able to authenticate to a service or system without using [Valid Accounts](https://attack.mitre.org/techniques/T1078).

Adversaries may maliciously modify a part of this process to either reveal credentials or bypass authentication mechanisms. Compromised credentials or access may be used to bypass access controls placed on various resources on systems within the network and may even be used for persistent access to remote systems and externally available services, such as VPNs, Outlook Web Access and remote desktop.",https://attack.mitre.org/techniques/T1556,11 February 2020,11 April 2023,2.3,"['Credential Access', 'Defense Evasion', 'Persistence']","Monitor for new, unfamiliar DLL files written to a domain controller and/or local computer. Monitor for changes to Registry entries for password filters (ex: <code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa\Notification Packages</code>) and correlate then investigate the DLL files these files reference. 

Password filters will also show up as an autorun and loaded DLL in lsass.exe.(Citation: Clymb3r Function Hook Passwords Sept 2013)

Monitor for calls to <code>OpenProcess</code> that can be used to manipulate lsass.exe running on a domain controller as well as for malicious modifications to functions exported from authentication-related system DLLs (such as cryptdll.dll and samsrv.dll).(Citation: Dell Skeleton) 

Monitor PAM configuration and module paths (ex: <code>/etc/pam.d/</code>) for changes. Use system-integrity tools such as AIDE and monitoring tools such as auditd to monitor PAM files.

Monitor for suspicious additions to the /Library/Security/SecurityAgentPlugins directory.(Citation: Xorrior Authorization Plugins)

Configure robust, consistent account activity audit policies across the enterprise and with externally accessible services. (Citation: TechNet Audit Policy) Look for suspicious account behavior across systems that share accounts, either user, admin, or service accounts. Examples: one account logged into multiple systems simultaneously; multiple accounts logged into the same machine simultaneously; accounts logged in at odd times or outside of business hours. Activity may be from interactive login sessions or process ownership from accounts being used to execute binaries on a remote system as a particular account. Correlate other security systems with login information (e.g., a user has an active login session but has not entered the building or does not have VPN access).

Monitor property changes in Group Policy that manage authentication mechanisms (i.e. [Group Policy Modification](https://attack.mitre.org/techniques/T1484/001)). The <code>Store passwords using reversible encryption</code> configuration should be set to Disabled. Additionally, monitor and/or block suspicious command/script execution of <code>-AllowReversiblePasswordEncryption $true</code>, <code>Set-ADUser</code> and <code>Set-ADAccountControl</code>. Finally, monitor Fine-Grained Password Policies and regularly audit user accounts and group settings.(Citation: dump_pwd_dcsync)
","['Azure AD', 'Google Workspace', 'IaaS', 'Linux', 'Network', 'Office 365', 'SaaS', 'Windows', 'macOS']","Active Directory: Active Directory Object Modification, Application Log: Application Log Content, File: File Creation, File: File Modification, Logon Session: Logon Session Creation, Module: Module Load, Process: OS API Execution, Process: Process Access, User Account: User Account Authentication, User Account: User Account Modification, Windows Registry: Windows Registry Key Creation, Windows Registry: Windows Registry Key Modification",False,,['Multi-Factor Authentication'],Chris Ross @xorrior,,,,,,"(Citation: ESET Ebury Feb 2014),(Citation: GitHub SILENTTRINITY Modules July 2019),(Citation: ESET ForSSHe December 2018),(Citation: TechNet Least Privilege),(Citation: Mandiant Azure AD Backdoors),(Citation: Microsoft Securing Privileged Access),(Citation: Microsoft LSA),(Citation: TechNet Credential Theft),(Citation: store_pwd_rev_enc),(Citation: MagicWeb),(Citation: EnableMPRNotifications)","['actor', 'process', 'data store', 'data flow']","[{'mitigation id': 'M1018', 'mitigation name': 'User Account Management', 'mitigation description': 'Manage the creation, modification, use, and permissions associated to user accounts.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1018'}, {'mitigation id': 'M1022', 'mitigation name': 'Restrict File and Directory Permissions', 'mitigation description': 'Restrict access by setting directory and file permissions that are not specific to users or privileged accounts.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1022'}, {'mitigation id': 'M1024', 'mitigation name': 'Restrict Registry Permissions', 'mitigation description': 'Restrict the ability to modify certain hives or keys in the Windows Registry.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1024'}, {'mitigation id': 'M1025', 'mitigation name': 'Privileged Process Integrity', 'mitigation description': 'Protect processes with high privileges that can be used to interact with critical system components through use of protected process light, anti-process injection defenses, or other process integrity enforcement measures.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1025'}, {'mitigation id': 'M1026', 'mitigation name': 'Privileged Account Management', 'mitigation description': 'Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1026'}, {'mitigation id': 'M1027', 'mitigation name': 'Password Policies', 'mitigation description': 'Set and enforce secure password policies for accounts.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1027'}, {'mitigation id': 'M1028', 'mitigation name': 'Operating System Configuration', 'mitigation description': 'Make configuration changes related to the operating system or a common feature of the operating system that result in system hardening against techniques.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1028'}, {'mitigation id': 'M1032', 'mitigation name': 'Multi-factor Authentication', 'mitigation description': 'Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1032'}, {'mitigation id': 'M1047', 'mitigation name': 'Audit', 'mitigation description': 'Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1047'}]"
T1556.006,Modify Authentication Process: Multi-Factor Authentication,"Adversaries may disable or modify multi-factor authentication (MFA) mechanisms to enable persistent access to compromised accounts.

Once adversaries have gained access to a network by either compromising an account lacking MFA or by employing an MFA bypass method such as [Multi-Factor Authentication Request Generation](https://attack.mitre.org/techniques/T1621), adversaries may leverage their access to modify or completely disable MFA defenses. This can be accomplished by abusing legitimate features, such as excluding users from Azure AD Conditional Access Policies, registering a new yet vulnerable/adversary-controlled MFA method, or by manually patching MFA programs and configuration files to bypass expected functionality.(Citation: Mandiant APT42)(Citation: Azure AD Conditional Access Exclusions)

For example, modifying the Windows hosts file (`C:\windows\system32\drivers\etc\hosts`) to redirect MFA calls to localhost instead of an MFA server may cause the MFA process to fail. If a ""fail open"" policy is in place, any otherwise successful authentication attempt may be granted access without enforcing MFA. (Citation: Russians Exploit Default MFA Protocol - CISA March 2022) 

Depending on the scope, goals, and privileges of the adversary, MFA defenses may be disabled for individual accounts or for all accounts tied to a larger group, such as all domain accounts in a victim's network environment.(Citation: Russians Exploit Default MFA Protocol - CISA March 2022) ",https://attack.mitre.org/techniques/T1556/006,31 May 2022,09 February 2023,1.0,"['Credential Access', 'Defense Evasion', 'Persistence']",,"['Azure AD', 'Google Workspace', 'IaaS', 'Linux', 'Office 365', 'SaaS', 'Windows', 'macOS']","Active Directory: Active Directory Object Modification, Logon Session: Logon Session Creation, User Account: User Account Authentication, User Account: User Account Modification",True,T1556,['Multi-Factor Authentication'],"Liran Ravich, CardinalOps; Muhammad Moiz Arshad, @5T34L7H",,,,,,",","['actor', 'process', 'data store', 'data flow']","[{'mitigation id': 'M1018', 'mitigation name': 'User Account Management', 'mitigation description': 'Manage the creation, modification, use, and permissions associated to user accounts.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1018'}, {'mitigation id': 'M1032', 'mitigation name': 'Multi-factor Authentication', 'mitigation description': 'Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1032'}, {'mitigation id': 'M1047', 'mitigation name': 'Audit', 'mitigation description': 'Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1047'}]"
T1556.007,Modify Authentication Process: Hybrid Identity,"Adversaries may patch, modify, or otherwise backdoor cloud authentication processes that are tied to on-premises user identities in order to bypass typical authentication mechanisms, access credentials, and enable persistent access to accounts.  

Many organizations maintain hybrid user and device identities that are shared between on-premises and cloud-based environments. These can be maintained in a number of ways. For example, Azure AD includes three options for synchronizing identities between Active Directory and Azure AD(Citation: Azure AD Hybrid Identity):

* Password Hash Synchronization (PHS), in which a privileged on-premises account synchronizes user password hashes between Active Directory and Azure AD, allowing authentication to Azure AD to take place entirely in the cloud 
* Pass Through Authentication (PTA), in which Azure AD authentication attempts are forwarded to an on-premises PTA agent, which validates the credentials against Active Directory 
* Active Directory Federation Services (AD FS), in which a trust relationship is established between Active Directory and Azure AD 

AD FS can also be used with other SaaS and cloud platforms such as AWS and GCP, which will hand off the authentication process to AD FS and receive a token containing the hybrid users’ identity and privileges. 

By modifying authentication processes tied to hybrid identities, an adversary may be able to establish persistent privileged access to cloud resources. For example, adversaries who compromise an on-premises server running a PTA agent may inject a malicious DLL into the `AzureADConnectAuthenticationAgentService` process that authorizes all attempts to authenticate to Azure AD, as well as records user credentials.(Citation: Azure AD Connect for Read Teamers)(Citation: AADInternals Azure AD On-Prem to Cloud) In environments using AD FS, an adversary may edit the `Microsoft.IdentityServer.Servicehost` configuration file to load a malicious DLL that generates authentication tokens for any user with any set of claims, thereby bypassing multi-factor authentication and defined AD FS policies.(Citation: MagicWeb)

In some cases, adversaries may be able to modify the hybrid identity authentication process from the cloud. For example, adversaries who compromise a Global Administrator account in an Azure AD tenullt may be able to register a new PTA agent via the web console, similarly allowing them to harvest credentials and log into the Azure AD environment as any user.(Citation: Mandiant Azure AD Backdoors)",https://attack.mitre.org/techniques/T1556/007,28 September 2022,21 October 2022,1.0,"['Credential Access', 'Defense Evasion', 'Persistence']",,"['Azure AD', 'Google Workspace', 'IaaS', 'Office 365', 'SaaS', 'Windows']","Application Log: Application Log Content, File: File Modification, Logon Session: Logon Session Creation, Module: Module Load",True,T1556,,Praetorian,,,,,,"(Citation: AADInternals Azure AD On-Prem to Cloud),(Citation: MagicWeb),(Citation: MagicWeb),(Citation: Mandiant Azure AD Backdoors)","['actor', 'process', 'data store', 'data flow']","[{'mitigation id': 'M1026', 'mitigation name': 'Privileged Account Management', 'mitigation description': 'Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1026'}, {'mitigation id': 'M1032', 'mitigation name': 'Multi-factor Authentication', 'mitigation description': 'Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1032'}, {'mitigation id': 'M1047', 'mitigation name': 'Audit', 'mitigation description': 'Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1047'}]"
T1562.008,Impair Defenses: Disable Cloud Logs,"An adversary may disable cloud logging capabilities and integrations to limit what data is collected on their activities and avoid detection. Cloud environments allow for collection and analysis of audit and application logs that provide insight into what activities a user does within the environment. If an adversary has sufficient permissions, they can disable logging to avoid detection of their activities.

For example, in AWS an adversary may disable CloudWatch/CloudTrail integrations prior to conducting further malicious activity.(Citation: Following the CloudTrail: Generating strong AWS security signals with Sumo Logic) In Office 365, an adversary may disable logging on mail collection activities for specific users by using the `Set-MailboxAuditBypassAssociation` cmdlet, by disabling M365 Advanced Auditing for the user, or by downgrading the user’s license from an Enterprise E5 to an Enterprise E3 license.(Citation: Dark Reading Microsoft 365 Attacks 2021)",https://attack.mitre.org/techniques/T1562/008,12 October 2020,20 April 2023,1.3,['Defense Evasion'],"Monitor logs for API calls to disable logging. In AWS, monitor for: <code>StopLogging</code> and <code>DeleteTrail</code>.(Citation: Stopping CloudTrail from Sending Events to CloudWatch Logs) In GCP, monitor for: <code>google.logging.v2.ConfigServiceV2.UpdateSink</code>.(Citation: Configuring Data Access audit logs)  In Azure, monitor for <code>az monitor diagnostic-settings delete</code>.(Citation: az monitor diagnostic-settings) Additionally, a sudden loss of a log source may indicate that it has been disabled. ","['Azure AD', 'Google Workspace', 'IaaS', 'Office 365', 'SaaS']","Cloud Service: Cloud Service Disable, Cloud Service: Cloud Service Modification, User Account: User Account Modification",True,T1562,,"Alex Soler, AttackIQ; Ibrahim Ali Khan; Janulltha Marasinghe; Joe Gumke, U.S. Bank; Matt Snyder, VMware; Prasad Somasamudram, McAfee; Sekhar Sarukkai, McAfee; Syed Ummar Farooqh, McAfee",,,,,,",","['actor', 'process', 'data store']","[{'mitigation id': 'M1018', 'mitigation name': 'User Account Management', 'mitigation description': 'Manage the creation, modification, use, and permissions associated to user accounts.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1018'}]"
T1606,Forge Web Credentials,"Adversaries may forge credential materials that can be used to gain access to web applications or Internet services. Web applications and services (hosted in cloud SaaS environments or on-premise servers) often use session cookies, tokens, or other materials to authenticate and authorize user access.

Adversaries may generate these credential materials in order to gain access to web resources. This differs from [Steal Web Session Cookie](https://attack.mitre.org/techniques/T1539), [Steal Application Access Token](https://attack.mitre.org/techniques/T1528), and other similar behaviors in that the credentials are new and forged by the adversary, rather than stolen or intercepted from legitimate users. The generation of web credentials often requires secret values, such as passwords, [Private Keys](https://attack.mitre.org/techniques/T1552/004), or other cryptographic seed values.(Citation: GitHub AWS-ADFS-Credential-Generator) Adversaries may also forge tokens by taking advantage of features such as the `AssumeRole` and `GetFederationToken` APIs in AWS, which allow users to request temporary security credentials.(Citation: AWS Temporary Security Credentials)

Once forged, adversaries may use these web credentials to access resources (ex: [Use Alternate Authentication Material](https://attack.mitre.org/techniques/T1550)), which may bypass multi-factor and other authentication protection mechanisms.(Citation: Pass The Cookie)(Citation: Unit 42 Mac Crypto Cookies January 2019)(Citation: Microsoft SolarWinds Customer Guidance)  ",https://attack.mitre.org/techniques/T1606,17 December 2020,04 May 2023,1.3,['Credential Access'],"Monitor for anomalous authentication activity, such as logons or other user session activity associated with unknown accounts. Monitor for unexpected and abnormal access to resources, including access of websites and cloud-based applications by the same user in different locations or by different systems that do not match expected configurations.","['Azure AD', 'Google Workspace', 'IaaS', 'Linux', 'Office 365', 'SaaS', 'Windows', 'macOS']","Logon Session: Logon Session Creation, Web Credential: Web Credential Creation, Web Credential: Web Credential Usage",False,,[],"Dylan Silva, AWS Security",,,,,,",(Citation: Microsoft SolarWinds Customer Guidance),(Citation: Crowdstrike AWS User Federation Persistence),(Citation: FireEye ADFS)","['actor', 'process', 'data store', 'data flow']","[{'mitigation id': 'M1018', 'mitigation name': 'User Account Management', 'mitigation description': 'Manage the creation, modification, use, and permissions associated to user accounts.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1018'}, {'mitigation id': 'M1026', 'mitigation name': 'Privileged Account Management', 'mitigation description': 'Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1026'}, {'mitigation id': 'M1047', 'mitigation name': 'Audit', 'mitigation description': 'Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1047'}, {'mitigation id': 'M1054', 'mitigation name': 'Software Configuration', 'mitigation description': 'Implement configuration changes to software (other than the operating system) to mitigate security risks associated to how the software operates.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1054'}]"
T1606.002,Forge Web Credentials: SAML Tokens,"An adversary may forge SAML tokens with any permissions claims and lifetimes if they possess a valid SAML token-signing certificate.(Citation: Microsoft SolarWinds Steps) The default lifetime of a SAML token is one hour, but the validity period can be specified in the <code>NotOnOrAfter</code> value of the <code>conditions ...</code> element in a token. This value can be changed using the <code>AccessTokenLifetime</code> in a <code>LifetimeTokenPolicy</code>.(Citation: Microsoft SAML Token Lifetimes) Forged SAML tokens enable adversaries to authenticate across services that use SAML 2.0 as an SSO (single sign-on) mechanism.(Citation: Cyberark Golden SAML)

ull adversary may utilize [Private Keys](https://attack.mitre.org/techniques/T1552/004) to compromise an organization's token-signing certificate to create forged SAML tokens. If the adversary has sufficient permissions to establish a new federation trust with their own Active Directory Federation Services (AD FS) server, they may instead generate their own trusted token-signing certificate.(Citation: Microsoft SolarWinds Customer Guidance) This differs from [Steal Application Access Token](https://attack.mitre.org/techniques/T1528) and other similar behaviors in that the tokens are new and forged by the adversary, rather than stolen or intercepted from legitimate users.

ull adversary may gain administrative Azure AD privileges if a SAML token is forged which claims to represent a highly privileged account. This may lead to [Use Alternate Authentication Material](https://attack.mitre.org/techniques/T1550), which may bypass multi-factor and other authentication protection mechanisms.(Citation: Microsoft SolarWinds Customer Guidance)",https://attack.mitre.org/techniques/T1606/002,17 December 2020,20 September 2021,1.2,['Credential Access'],"This technique may be difficult to detect as SAML tokens are signed by a trusted certificate. The forging process may not be detectable since it is likely to happen outside of a defender's visibility, but subsequent usage of the forged token may be seen. Monitor for anomalous logins using SAML tokens created by a compromised or adversary generated token-signing certificate. These logins may occur on any on-premises resources as well as from any cloud environment that trusts the certificate.(Citation: Microsoft SolarWinds Customer Guidance) Search for logins to service providers using SAML SSO which do not have corresponding 4769, 1200, and 1202 events in the Domain.(Citation: Sygnia Golden SAML)

Consider modifying SAML responses to include custom elements for each service provider. Monitor these custom elements in service provider access logs to detect any anomalous requests.(Citation: Sygnia Golden SAML)","['Azure AD', 'Google Workspace', 'IaaS', 'Office 365', 'SaaS', 'Windows']","Logon Session: Logon Session Creation, Logon Session: Logon Session Metadata, User Account: User Account Authentication, Web Credential: Web Credential Creation, Web Credential: Web Credential Usage",True,T1606,,"Blake Strom, Microsoft 365 Defender; Jen Burns, HubSpot; Oleg Kolesnikov, Securonix",['Administrator'],,,,,"(Citation: Secureworks IRON RITUAL Profile),(Citation: AADInternals Documentation),(Citation: Microsoft - Customer Guidance on Recent Nation-State Cyber Attacks),(Citation: Microsoft SolarWinds Customer Guidance),(Citation: FireEye ADFS),(Citation: Mandiant Defend UNC2452 White Paper)","['actor', 'process', 'data store', 'data flow']","[{'mitigation id': 'M1015', 'mitigation name': 'Active Directory Configuration', 'mitigation description': 'Configure Active Directory to prevent use of certain techniques; use SID Filtering, etc.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1015'}, {'mitigation id': 'M1018', 'mitigation name': 'User Account Management', 'mitigation description': 'Manage the creation, modification, use, and permissions associated to user accounts.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1018'}, {'mitigation id': 'M1026', 'mitigation name': 'Privileged Account Management', 'mitigation description': 'Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1026'}, {'mitigation id': 'M1047', 'mitigation name': 'Audit', 'mitigation description': 'Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1047'}]"
T1621,Multi-Factor Authentication Request Generation,"Adversaries may attempt to bypass multi-factor authentication (MFA) mechanisms and gain access to accounts by generating MFA requests sent to users.

Adversaries in possession of credentials to [Valid Accounts](https://attack.mitre.org/techniques/T1078) may be unable to complete the login process if they lack access to the 2FA or MFA mechanisms required as an additional credential and security control. To circumvent this, adversaries may abuse the automatic generation of push notifications to MFA services such as Duo Push, Microsoft Authenticator, Okta, or similar services to have the user grant access to their account.

In some cases, adversaries may continuously repeat login attempts in order to bombard users with MFA push notifications, SMS messages, and phone calls, potentially resulting in the user finally accepting the authentication request in response to “MFA fatigue.”(Citation: Russian 2FA Push Annoyance - Cimpanu)(Citation: MFA Fatigue Attacks - PortSwigger)(Citation: Suspected Russian Activity Targeting Government and Business Entities Around the Globe)",https://attack.mitre.org/techniques/T1621,01 April 2022,04 April 2023,1.0,['Credential Access'],"Monitor user account logs as well as 2FA/MFA application logs for suspicious events: unusual login attempt source location, mismatch in location of login attempt and smart device receiving 2FA/MFA request prompts, and high volume of repeated login attempts, all of which may indicate user's primary credentials have been compromised minus 2FA/MFA mechanism. ","['Azure AD', 'Google Workspace', 'IaaS', 'Linux', 'Office 365', 'SaaS', 'Windows', 'macOS']","Application Log: Application Log Content, Logon Session: Logon Session Creation, Logon Session: Logon Session Metadata, User Account: User Account Authentication",False,,[],"Jon Sternstein, Stern Security; Pawel Partyka, Microsoft 365 Defender; Shanief Webb",,,,,,"(Citation: MSTIC DEV-0537 Mar 2022),(Citation: Suspected Russian Activity Targeting Government and Business Entities Around the Globe),(Citation: Microsoft Common Conditional Access Policies),(Citation: MFA Fatigue Attacks - PortSwigger)","['actor', 'process', 'data store', 'data flow']","[{'mitigation id': 'M1017', 'mitigation name': 'User Training', 'mitigation description': 'Train users to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1017'}, {'mitigation id': 'M1032', 'mitigation name': 'Multi-factor Authentication', 'mitigation description': 'Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1032'}, {'mitigation id': 'M1036', 'mitigation name': 'Account Use Policies', 'mitigation description': 'Configure features related to account use like login attempt lockouts, specific login times, etc.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1036'}]"
T1649,Steal or Forge Authentication Certificates,"Adversaries may steal or forge certificates used for authentication to access remote systems or resources. Digital certificates are often used to sign and encrypt messages and/or files. Certificates are also used as authentication material. For example, Azure AD device certificates and Active Directory Certificate Services (AD CS) certificates bind to an identity and can be used as credentials for domain accounts.(Citation: O365 Blog Azure AD Device IDs)(Citation: Microsoft AD CS Overview)

Authentication certificates can be both stolen and forged. For example, AD CS certificates can be stolen from encrypted storage (in the Registry or files)(Citation: APT29 Deep Look at Credential Roaming), misplaced certificate files (i.e. [Unsecured Credentials](https://attack.mitre.org/techniques/T1552)), or directly from the Windows certificate store via various crypto APIs.(Citation: SpecterOps Certified Pre Owned)(Citation: GitHub CertStealer)(Citation: GitHub GhostPack Certificates) With appropriate enrollment rights, users and/or machines within a domain can also request and/or manually renew certificates from enterprise certificate authorities (CA). This enrollment process defines various settings and permissions associated with the certificate. Of note, the certificate’s extended key usage (EKU) values define signing, encryption, and authentication use cases, while the certificate’s subject alternative name (SAN) values define the certificate owner’s alternate names.(Citation: Medium Certified Pre Owned)

Abusing certificates for authentication credentials may enable other behaviors such as [Lateral Movement](https://attack.mitre.org/tactics/TA0008). Certificate-related misconfigurations may also enable opportunities for [Privilege Escalation](https://attack.mitre.org/tactics/TA0004), by way of allowing users to impersonate or assume privileged accounts or permissions via the identities (SANs) associated with a certificate. These abuses may also enable [Persistence](https://attack.mitre.org/tactics/TA0003) via stealing or forging certificates that can be used as [Valid Accounts](https://attack.mitre.org/techniques/T1078) for the duration of the certificate's validity, despite user password resets. Authentication certificates can also be stolen and forged for machine accounts.

Adversaries who have access to root (or subordinate) CA certificate private keys (or mechanisms protecting/managing these keys) may also establish [Persistence](https://attack.mitre.org/tactics/TA0003) by forging arbitrary authentication certificates for the victim domain (known as “golden” certificates).(Citation: Medium Certified Pre Owned) Adversaries may also target certificates and related services in order to access other forms of credentials, such as [Golden Ticket](https://attack.mitre.org/techniques/T1558/001) ticket-granting tickets (TGT) or NTLM plaintext.(Citation: Medium Certified Pre Owned)",https://attack.mitre.org/techniques/T1649,03 August 2022,02 March 2023,1.1,['Credential Access'],,"['Azure AD', 'Linux', 'Windows', 'macOS']","Active Directory: Active Directory Credential Request, Active Directory: Active Directory Object Modification, Application Log: Application Log Content, Command: Command Execution, File: File Access, Logon Session: Logon Session Creation, Windows Registry: Windows Registry Key Access",False,,[],"Lee Christensen, SpecterOps; Thirumalai Natarajan, Mandiant; Tristan Bennett, Seamless Intelligence",,,,,,"(Citation: Adsecurity Mimikatz Guide),(Citation: Mandiant APT29 Trello),(Citation: AADInternals Documentation),(Citation: SpecterOps Certified Pre Owned),(Citation: GitHub PSPKIAudit),(Citation: GitHub Certify)","['actor', 'process', 'data store', 'data flow']","[{'mitigation id': 'M1015', 'mitigation name': 'Active Directory Configuration', 'mitigation description': 'Configure Active Directory to prevent use of certain techniques; use SID Filtering, etc.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1015'}, {'mitigation id': 'M1041', 'mitigation name': 'Encrypt Sensitive Information', 'mitigation description': 'Protect sensitive information with strong encryption.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1041'}, {'mitigation id': 'M1042', 'mitigation name': 'Disable or Remove Feature or Program', 'mitigation description': 'Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1042'}, {'mitigation id': 'M1047', 'mitigation name': 'Audit', 'mitigation description': 'Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1047'}]"
T1651,Cloud Administration Command,"Adversaries may abuse cloud management services to execute commands within virtual machines or hybrid-joined devices. Resources such as AWS Systems Manager, Azure RunCommand, and Runbooks allow users to remotely run scripts in virtual machines by leveraging installed virtual machine agents. Similarly, in Azure AD environments, Microsoft Endpoint Manager allows Global or Intune Administrators to run scripts as SYSTEM on on-premises devices joined to the Azure AD.(Citation: AWS Systems Manager Run Command)(Citation: Microsoft Run Command)(Citation: SpecterOps Lateral Movement from Azure to On-Prem AD 2020)

If an adversary gains administrative access to a cloud environment, they may be able to abuse cloud management services to execute commands in the environment’s virtual machines or on-premises hybrid-joined devices. Additionally, an adversary that compromises a service provider or delegated administrator account may similarly be able to leverage a [Trusted Relationship](https://attack.mitre.org/techniques/T1199) to execute commands in connected virtual machines.(Citation: MSTIC Nobelium Oct 2021)",https://attack.mitre.org/techniques/T1651,13 March 2023,14 April 2023,1.0,['Execution'],,"['Azure AD', 'IaaS']","Command: Command Execution, Process: Process Creation, Script: Script Execution",False,,[],Adrien Bataille; Anders Vejlby; Caio Silva; Cisco; Jared Wilson; Nader Zaveri; Nichols Jasper,,False,,,,"(Citation: AADInternals Root Access to Azure VMs),(Citation: MSTIC Nobelium Oct 2021),(Citation: AWS Setting Up Run Command),(Citation: Mandiant Azure Run Command 2021)",['process'],"[{'mitigation id': 'M1026', 'mitigation name': 'Privileged Account Management', 'mitigation description': 'Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.', 'mitigation url': 'https://attack.mitre.org/mitigations/M1026'}]"
